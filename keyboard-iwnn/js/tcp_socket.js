var tcpSocket=function(){function b(){a&&(a.close(),a=null)}var a=null,f=[],d=0,g=0,n=function(h,c){debug("***** tcp_socket: URL:"+window.location.href);try{a&&"open"===a.readyState?(debug("TCP socket is already open:"),e(),c&&c(ERR_TCP_NOT_CLOSE_SOCKET)):(a=navigator.mozTCPSocket.open("127.0.0.1",4095,{binaryType:"string"}),l(c),a.onopen=function(p){debug("::: _imeSocket onOpen ::::127.0.0.1 4095");k();try{debug("::: Message Send :::: "+h+" :::\n"),a.send(h),m(c)}catch(b){debug("::: Message Sending failed: "+
b.name+" :::\n")}},a.ondata=function(a){e();debug("::: msg.data : "+a.data+" :::\n");try{f=JSON.parse(a.data),debug("::: _j_out_data : "+f+" :::\n")}catch(h){f=ERR_TCP_JSON_PARSE,debug("::: error message.name : "+h+" :::\n")}finally{b(),c&&c(f)}},a.onerror=function(a){k();e();debug("::: _imeSocket error :::\n");debug("::: error message : "+a.data+" :::\n");a.data.name&&debug("::: error message.name : "+a.data.name+" :::\n");b();c&&c(a.data.name)})}catch(d){debug("Could not create a TCP socket: "+
d.name),k(),e(),b()}},l=function(a){d=window.setTimeout(function(){k();b();a&&a(ERR_TCP_PROCESS_TIMEOUT)},TCP_CONNECTION_TIMEOUT_TIMER)},k=function(){d&&(window.clearTimeout(d),d=0)},m=function(a){g=window.setTimeout(function(){e();b();a&&a(ERR_TCP_PROCESS_TIMEOUT)},TCP_PROCESS_TIMEOUT_TIMER)},e=function(){g&&(window.clearTimeout(g),g=0)};return{send:function(a,c){try{n(a,c)}catch(b){debug("Could not create a TCP socket: "+b.name)}},getState:function(){return a?a.readyState:""},close:b}}();
