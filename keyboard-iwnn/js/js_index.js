(function(p,w){function k(a,d,c){this.name="L10nError";this.message=a;this.id=d;this.loc=c}function z(){}function H(a){function d(b,a){return-1!==a.indexOf(b)}function c(b,a,d){return typeof b===typeof a&&a<=b&&b<=d}var e={0:function(){return"other"},1:function(b){return c(b%100,3,10)?"few":0===b?"zero":c(b%100,11,99)?"many":2===b?"two":1===b?"one":"other"},2:function(b){return 0!==b&&0===b%10?"many":2===b?"two":1===b?"one":"other"},3:function(b){return 1===b?"one":"other"},4:function(b){return c(b,
0,1)?"one":"other"},5:function(b){return c(b,0,2)&&2!==b?"one":"other"},6:function(b){return 0===b?"zero":1===b%10&&11!==b%100?"one":"other"},7:function(b){return 2===b?"two":1===b?"one":"other"},8:function(b){return c(b,3,6)?"few":c(b,7,10)?"many":2===b?"two":1===b?"one":"other"},9:function(b){return 0===b||1!==b&&c(b%100,1,19)?"few":1===b?"one":"other"},10:function(b){return c(b%10,2,9)&&!c(b%100,11,19)?"few":1!==b%10||c(b%100,11,19)?"other":"one"},11:function(b){return c(b%10,2,4)&&!c(b%100,12,
14)?"few":0===b%10||c(b%10,5,9)||c(b%100,11,14)?"many":1===b%10&&11!==b%100?"one":"other"},12:function(b){return c(b,2,4)?"few":1===b?"one":"other"},13:function(b){return c(b%10,2,4)&&!c(b%100,12,14)?"few":1!==b&&c(b%10,0,1)||c(b%10,5,9)||c(b%100,12,14)?"many":1===b?"one":"other"},14:function(b){return c(b%100,3,4)?"few":2===b%100?"two":1===b%100?"one":"other"},15:function(b){return 0===b||c(b%100,2,10)?"few":c(b%100,11,19)?"many":1===b?"one":"other"},16:function(b){return 1===b%10&&11!==b?"one":
"other"},17:function(b){return 3===b?"few":0===b?"zero":6===b?"many":2===b?"two":1===b?"one":"other"},18:function(b){return 0===b?"zero":c(b,0,2)&&0!==b&&2!==b?"one":"other"},19:function(b){return c(b,2,10)?"few":c(b,0,1)?"one":"other"},20:function(b){return!c(b%10,3,4)&&9!==b%10||c(b%100,10,19)||c(b%100,70,79)||c(b%100,90,99)?0===b%1E6&&0!==b?"many":2!==b%10||d(b%100,[12,72,92])?1!==b%10||d(b%100,[11,71,91])?"other":"one":"two":"few"},21:function(b){return 0===b?"zero":1===b?"one":"other"},22:function(b){return c(b,
0,1)||c(b,11,99)?"one":"other"},23:function(b){return c(b%10,1,2)||0===b%20?"one":"other"},24:function(b){return c(b,3,10)||c(b,13,19)?"few":d(b,[2,12])?"two":d(b,[1,11])?"one":"other"}};a={af:3,ak:4,am:4,ar:1,asa:3,az:0,be:11,bem:3,bez:3,bg:3,bh:4,bm:0,bn:3,bo:0,br:20,brx:3,bs:11,ca:3,cgg:3,chr:3,cs:12,cy:17,da:3,de:3,dv:3,dz:0,ee:3,el:3,en:3,eo:3,es:3,et:3,eu:3,fa:0,ff:5,fi:3,fil:4,fo:3,fr:5,fur:3,fy:3,ga:8,gd:24,gl:3,gsw:3,gu:3,guw:4,gv:23,ha:3,haw:3,he:2,hi:4,hr:11,hu:0,id:0,ig:0,ii:0,is:3,it:3,
iu:7,ja:0,jmc:3,jv:0,ka:0,kab:5,kaj:3,kcg:3,kde:0,kea:0,kk:3,kl:3,km:0,kn:0,ko:0,ksb:3,ksh:21,ku:3,kw:7,lag:18,lb:3,lg:3,ln:4,lo:0,lt:10,lv:6,mas:3,mg:4,mk:16,ml:3,mn:3,mo:9,mr:3,ms:0,mt:15,my:0,nah:3,naq:7,nb:3,nd:3,ne:3,nl:3,nn:3,no:3,nr:3,nso:4,ny:3,nyn:3,om:3,or:3,pa:3,pap:3,pl:13,ps:3,pt:3,rm:3,ro:9,rof:3,ru:11,rwk:3,sah:0,saq:3,se:7,seh:3,ses:0,sg:0,sh:11,shi:19,sk:12,sl:14,sma:7,smi:7,smj:7,smn:7,sms:7,sn:3,so:3,sq:3,sr:11,ss:3,ssy:3,st:3,sv:3,sw:3,syr:3,ta:3,te:3,teo:3,th:0,ti:4,tig:3,tk:3,
tl:4,tn:3,to:0,tr:0,ts:3,tzm:22,uk:11,ur:3,ve:3,vi:0,vun:3,wa:4,wae:3,wo:0,xh:3,xog:3,yo:0,zh:0,zu:3}[a.replace(/-.*$/,"")];return a in e?e[a]:function(){return"other"}}function I(a,d){var c={};q||(q={comment:/^\s*#|^\s*$/,entity:/^([^=\s]+)\s*=\s*(.+)$/,multiline:/[^\\]\\$/,macro:/\{\[\s*(\w+)\(([^\)]*)\)\s*\]\}/i,unicode:/\\u([0-9a-fA-F]{1,4})/g,entries:/[\r\n]+/,controlChars:/\\([\\\n\r\t\b\f\{\}\"\'])/g});for(var e=d.split(q.entries),b=0;b<e.length;b++){var f=e[b];if(!q.comment.test(f)){for(;q.multiline.test(f)&&
b<e.length;)f=f.slice(0,-1)+e[++b].trim();if(f=f.match(q.entity))try{var g=f[1],l=f[2],f=c,s=void 0,h=void 0,B=g.indexOf("[");-1!==B?(s=g.substr(0,B),h=g.substring(B+1,g.length-1)):(s=g,h=null);var u=s.split("."),v=void 0;if(1<u.length){var t=[];t.push(u.pop());1<u.length&&-1!==V.indexOf(u[u.length-1])&&t.push(u.pop());s=u.join(".");v=t.reverse().join(".")}else v=null;var m=h,p,h=l;-1!==h.lastIndexOf("\\")&&(h=h.replace(q.controlChars,"$1"));p=W(h);h=s;t=v;s=m;v=p;m=h;t&&(h in f||(f[h]={}),"string"===
typeof f[h]&&(f[h]={_:f[h]}),f=f[h],m=t);if(s){if(!(m in f))f[m]={_:{}};else if("string"===typeof f[m]){var h=f,t=m,n=f[m].match(q.macro);if(!n)throw new k("Malformed macro");h[t]={_index:[n[1],n[2]],_:{}}}f[m]._[s]=v}else f[m]=v}catch(r){if(a)a._emitter.emit("error",r);else throw r;}}}return c}function W(a){return a.replace(q.unicode,function(a,c){return unescape("%u"+"0000".slice(c.length)+c)})}function l(a,d,c){this.id=a;this.env=c;this.dirty=!1;if("string"===typeof d)this.value=d;else{for(var e in d)d.hasOwnProperty(e)&&
"_"!==e[0]&&(this.attributes||(this.attributes={}),this.attributes[e]=new l(this.id+"."+e,d[e],c));this.value=d._||null;this.index=d._index}}function X(a,d,c){var e=0;c=c.replace(J,function(b,c){if(e++>=K)throw new k("Too many placeables ("+e+", max allowed is "+K+")");var g;a:if(a&&a.hasOwnProperty(c)&&("string"===typeof a[c]||"number"===typeof a[c]&&!isNaN(a[c])))g=a[c];else{if(d.hasOwnProperty(c)&&(d[c]instanceof l||(d[c]=new l(c,d[c],d)),g=d[c].resolve(a),"string"===typeof g)){if(g.length>=L)throw new k("Too many characters in placeable ("+
g.length+", max allowed is "+L+")");break a}g=b}return g});e=0;return c}function n(a,d,c,e){if("string"===typeof c)return X(a,d,c);if("boolean"===typeof c||"number"===typeof c||!c)return c;if(e&&a&&a.hasOwnProperty(e[1])){e=a[e[1]];if(0===e&&"zero"in c)return n(a,d,c.zero);if(1===e&&"one"in c)return n(a,d,c.one);if(2===e&&"two"in c)return n(a,d,c.two);e=d.__plural(e);if(c.hasOwnProperty(e))return n(a,d,c[e])}return"other"in c?n(a,d,c.other):w}function Y(a,d){a=a||{};for(var c in d)d.hasOwnProperty(c)&&
(a[c]=new l(c,d[c],a));return a}function r(a,d){this.id=a;this.ctx=d;this.isReady=!1;this.entries={__plural:H(a)}}function M(a){function d(a){if(!this.isReady)throw new k("Context not ready");for(var b=0,c,d;c=this.supportedLocales[b];)if(d=this.getLocale(c),d.isReady||d.build(null),d=d.getEntry(a),d===w)b++,c=new k(a+" not found in "+c,a,c),this._emitter.emit("warning",c);else return d;a=new k(a+" not found",a);this._emitter.emit("error",a);return null}function c(a){this.supportedLocales=a;this.isReady=
!0;this._emitter.emit("ready")}this.id=a;this.isLoading=this.isReady=!1;this.supportedLocales=[];this.resLinks=[];this.locales={};this._emitter=new z;this.get=function(a,b){var c=d.call(this,a);return null===c?"":c.toString(b)||""};this.getEntity=function(a,b){var c=d.call(this,a);return null===c?null:c.valueOf(b)};this.getLocale=function(a){var b=this.locales;return b[a]?b[a]:b[a]=new r(a,this)};this.requestLocales=function(){if(this.isLoading&&!this.isReady)throw new k("Context not ready");this.isLoading=
!0;var a=Array.prototype.slice.call(arguments),b;b=a.concat("en-US");b=-1===b.indexOf(a[0])||"en-US"===a[0]?["en-US"]:[a[0],"en-US"];a=this.getLocale(b[0]);a.isReady?c.call(this,b):a.build(c.bind(this,b))};this.addEventListener=function(a,b){this._emitter.addEventListener(a,b)};this.removeEventListener=function(a,b){this._emitter.removeEventListener(a,b)};this.ready=function(a){this.isReady&&setTimeout(a);this.addEventListener("ready",a)};this.once=function(a){if(this.isReady)setTimeout(a);else{var b=
function(){this.removeEventListener("ready",b);a()}.bind(this);this.addEventListener("ready",b)}}}function C(a,d){a=D[a];D[document.readyState]>=a?d():document.addEventListener("readystatechange",function e(){D[document.readyState]>=a&&(document.removeEventListener("readystatechange",e),d())})}function N(){Z.call(this)?C("interactive",function(){p.setTimeout(A.bind(this))}.bind(this)):A.call(this)}function Z(){var a=document.documentElement.querySelector('script[type="application/l10n"][lang="'+navigator.language+
'"]');if(!a)return!1;var d=this.ctx.getLocale(navigator.language);d.addAST(JSON.parse(a.innerHTML));a={ctx:d,language:{code:d.id,direction:0<=O.indexOf(d.id)?"rtl":"ltr"}};P.call(a);return x=!0}function A(){function a(a){a&&this.ctx._emitter.emit("error",a);0===--f&&Q.call(this)}var d=document.head.querySelectorAll('link[type="application/l10n"]'),c=[],e;for(e=0;e<d.length;e++){var b=d[e].getAttribute("href");"ini"===b.substr(b.lastIndexOf(".")+1)&&c.push(b);this.ctx.resLinks.push(b)}var f=c.length;
if(0===f)Q.call(this);else for(e=0;e<c.length;e++)R.call(this,c[e],a.bind(this))}function Q(){this.ctx.requestLocales(navigator.language);p.addEventListener("languagechange",function(){navigator.mozL10n.language.code=navigator.language})}function S(){var a=new CustomEvent("localized",{bubbles:!1,cancelable:!1,detail:{language:this.ctx.supportedLocales[0]}});p.dispatchEvent(a)}function R(a,d){var c=this.ctx;E.load(a,function(e,b){var f=c.resLinks.indexOf(a);if(e)return c.resLinks.splice(f,1),d(e);
if(!b)return c.resLinks.splice(f,1),d(Error("Empty file: "+a));var g=$(b,a).resources.map(function(a){return a.replace("en-US","{{locale}}")});c.resLinks.splice.apply(c.resLinks,[f,1].concat(g));d()})}function aa(a,d){return"/"===d[0]?d:a.split("/").slice(0,-1).concat(d.split("/")).filter(function(a){return"."!==a}).join("/")}function $(a,d){for(var c=a.split(y.entry),e=["en-US"],b=!0,f=[],g,k=0;k<c.length;k++)g=c[k],b&&y["import"].test(g)?(g=y["import"].exec(g),g=aa(d,g[1]),f.push(g)):y.section.test(g)&&
(b=!1,g=y.section.exec(g),e.push(g[1]));return{locales:e,resources:f}}function P(a){a||(a=document.documentElement,document.documentElement.lang=this.language.code,document.documentElement.dir=this.language.direction);F.call(this,a);a=T(a);for(var d=0;d<a.length;d++)F.call(this,a[d])}function T(a){return a?a.querySelectorAll("*[data-l10n-id]"):[]}function ba(a,d,c){a&&(d?(a.setAttribute("data-l10n-id",d),c&&"object"===typeof c?a.setAttribute("data-l10n-args",JSON.stringify(c)):a.removeAttribute("data-l10n-args"),
this.ctx.isReady&&F.call(this,a)):(a.removeAttribute("data-l10n-id"),a.removeAttribute("data-l10n-args"),G(a,"")))}function U(a){if(!a)return{};var d=a.getAttribute("data-l10n-id");a=(a=a.getAttribute("data-l10n-args"))?JSON.parse(a):null;return{id:d,args:a}}function F(a){var d=U(a);if(d.id&&(d=this.ctx.getEntity(d.id,d.args))){if("string"===typeof d)return G(a,d),!0;d.value&&G(a,d.value);for(var c in d.attributes)if(d.attributes.hasOwnProperty(c)){var e=d.attributes[c],b=c.indexOf(".");-1!==b?a[c.substr(0,
b)][c.substr(b+1)]=e:"ariaLabel"===c?a.setAttribute("aria-label",e):a[c]=e}return!0}}function G(a,d){if(a.firstElementChild){for(var c=!1,e=/\S/,b=a.firstChild;b;b=b.nextSibling)b.nodeType===Node.TEXT_NODE&&e.test(b.nodeValue)&&(c?b.nodeValue="":(b.nodeValue=d,c=!0));c||a.insertBefore(document.createTextNode(d),a.firstChild)}else a.textContent=d}k.prototype=Object.create(Error.prototype);k.prototype.constructor=k;var E={load:function(a,d,c){var e=new XMLHttpRequest;e.overrideMimeType&&e.overrideMimeType("text/plain");
e.open("GET",a,!c);e.addEventListener("load",function(b){200===b.target.status||0===b.target.status?d(null,b.target.responseText):d(new k("Not found: "+a))});e.addEventListener("error",d);e.addEventListener("timeout",d);try{e.send(null)}catch(b){d(new k("Not found: "+a))}},loadJSON:function(a,d){var c=new XMLHttpRequest;c.overrideMimeType&&c.overrideMimeType("application/json");c.open("GET",a);c.responseType="json";c.addEventListener("load",function(b){200===b.target.status||0===b.target.status?d(null,
b.target.response):d(new k("Not found: "+a))});c.addEventListener("error",d);c.addEventListener("timeout",d);try{c.send(null)}catch(e){d(new k("Not found: "+a))}}};z.prototype.emit=function(){if(this._listeners){var a=Array.prototype.slice.call(arguments),d=a.shift();if(this._listeners[d])for(var d=this._listeners[d].slice(),c=0;c<d.length;c++)d[c].apply(this,a)}};z.prototype.addEventListener=function(a,d){this._listeners||(this._listeners={});a in this._listeners||(this._listeners[a]=[]);this._listeners[a].push(d)};
z.prototype.removeEventListener=function(a,d){if(this._listeners){var c=this._listeners[a],e=c.indexOf(d);-1!==e&&c.splice(e,1)}};var V=["style","dataset"],q,L=2500,K=100,J=/\{\{\s*(.+?)\s*\}\}/g;l.prototype.resolve=function(a){if(this.dirty)return w;this.dirty=!0;var d;try{d=n(a,this.env,this.value,this.index)}finally{this.dirty=!1}return d};l.prototype.toString=function(a){try{return this.resolve(a)}catch(d){return w}};l.prototype.valueOf=function(a){if(!this.attributes)return this.toString(a);
var d={value:this.toString(a),attributes:{}},c;for(c in this.attributes)this.attributes.hasOwnProperty(c)&&(d.attributes[c]=this.attributes[c].toString(a));return d};r.prototype.getEntry=function(a){var d=this.entries;return d.hasOwnProperty(a)?d[a]instanceof l?d[a]:d[a]=new l(a,d[a],d):w};r.prototype.build=function(a){function d(b){b&&f._emitter.emit("error",b);0>=--k&&(g.isReady=!0,a&&a())}function c(a,b){!a&&b&&g.addAST(b);d(a)}function e(a,b){if(!a&&b){var c=I(f,b);g.addAST(c)}d(a)}var b=!a,f=
this.ctx,g=this,k=f.resLinks.length;if(0===k)d();else for(var l=0;l<f.resLinks.length;l++){var h=f.resLinks[l].replace("{{locale}}",this.id);switch(h.substr(h.lastIndexOf(".")+1)){case "json":E.loadJSON(h,c,b);break;case "properties":E.load(h,e,b)}}};r.prototype.addAST=function(a){for(var d in a)a.hasOwnProperty(d)&&(this.entries[d]=a[d])};r.prototype.getEntity=function(a,d){var c=this.getEntry(a);return c?c.valueOf(d):null};var x=!1,O="ar he fa ps qps-plocm ur".split(" ");navigator.mozL10n={ctx:new M,
get:function(a,d){return navigator.mozL10n.ctx.get(a,d)},localize:function(a,d,c){return ba.call(navigator.mozL10n,a,d,c)},translate:function(a){return P.call(navigator.mozL10n,a)},ready:function(a){return navigator.mozL10n.ctx.ready(a)},once:function(a){return navigator.mozL10n.ctx.once(a)},get readyState(){return navigator.mozL10n.ctx.isReady?"complete":"loading"},language:{set code(a){navigator.mozL10n.ctx.requestLocales(a)},get code(){return navigator.mozL10n.ctx.supportedLocales[0]},get direction(){return 0<=
O.indexOf(navigator.mozL10n.ctx.supportedLocales[0])?"rtl":"ltr"}},_getInternalAPI:function(){return{Error:k,Context:M,Locale:r,Entity:l,getPluralRule:H,rePlaceables:J,getTranslatableChildren:T,getL10nAttributes:U,loadINI:R,fireLocalizedEvent:S,parse:I,compile:Y}}};navigator.mozL10n.ctx.ready(function(){x||this.translate();x=!1;S.call(this)}.bind(navigator.mozL10n));var D={loading:0,interactive:1,complete:2};if(p.document){x=document.documentElement.lang===navigator.language;if(document.documentElement.dataset.noCompleteBug){N.call(navigator.mozL10n);
return}x?C("interactive",function(){p.setTimeout(A.bind(navigator.mozL10n))}):"complete"===document.readyState?p.setTimeout(A.bind(navigator.mozL10n)):C("interactive",N.bind(navigator.mozL10n))}var y={section:/^\s*\[(.*)\]\s*$/,"import":/^\s*@import\s+url\((.*)\)\s*$/i,entry:/[\r\n]+/}})(this);
var CONV_MODE_ANALYZE=1,CONV_MODE_MULTI_CONV=5,CONV_MODE_CONNECTION_ANALYZE=2,CONST_MAX_INPUT_LEN=50,TOAST_TIMER=3E3,HIDE_IME_TIMER_TRIAL_PERIOD_END=3E3,MAX_UNIT_NUM_PORTRAIT=8,MAX_UNIT_NUM_LANDSCAPE=16,MAX_MORE_CANDIDATE_ROW_NUM=12,MAX_MORE_SYMBOL_CANDIDATE_EMOJI_ROW_NUM=6,TCP_CONNECTION_TIMEOUT_TIMER=700,TCP_PROCESS_TIMEOUT_TIMER=1E3,TCP_MAX_RETRY_COUNT=3,ERR_TCP_PROCESS_TIMEOUT=-1,ERR_TCP_JSON_PARSE=-20001,ERR_TCP_NOT_EXIST_QUEUE=-20002,ERR_TCP_NOT_CLOSE_SOCKET=-20003,CONST_STATUS_TIME={MORNING:32,
NOON:64,NIGHT:128},CONST_MONING_START=300,CONST_MONING_END=630,CONST_NOON_START=600,CONST_NOON_END=1050,CONST_NIGHT_START=1020,CONST_NIGHT_END=330,CONST_STATUS_MONTH={1:4096,2:8192,3:16384,4:32768,5:65536,6:131072,7:262144,8:524288,9:1048576,10:2097152,11:4194304,12:8388608},MAX_CATEGORY_HISTORY=50,DOM_KEYCODE_HARF_YEN=165,TEXT_LAYER0=0,TEXT_LAYER1=1,TEXT_LAYER2=2,TEXT_MAX_LAYER=3,TEXT_MAX_CONVERT_LENGTH=4,USER_DIC_MODE={ADD:0,MOD:1},INPUT_MODE={DIGIT:"digit",NUMERIC:"numeric",PHONETIC:"phonetic",
MOZ_SMS:"-moz-sms",USR_DIC:"iwnn-user-dictionary"},INPUT_TYPE={TEXT:"text",TEXTAREA:"textarea",URL:"url",TEL:"tel",EMAIL:"email",PASSWORD:"password",SEARCH:"search",NUMBER:"number",RANGE:"range"},IME_LAYOUTS={EN:"jp-kanji-en",JP:"jp-kanji",NUM:"jp-kanji-number",NUM_EM:"jp-kanji-number-em",ROMA:"jp-kanji-romaji",EN_FULL:"jp-kanji-en-full",NUM_FULL:"jp-kanji-number-full",NUM_FULL_CAP:"jp-kanji-number-full-cap",NUM_FULL_EM:"jp-kanji-number-full-em",NUM_FULL_CAP_EM:"jp-kanji-number-full-cap-em",TEL:"tel",
NUMBER:"number",DIGIT:"digit"},IME_TYPE={JP:0,EN:1,NUM:2,TEL:3,NUMBER:4,DIGIT:5},IME_MODE={FULL_HIRAGANA:0,FULL_KATAKANA:1,FULL_ALPHABET:2,FULL_NUMBER:3,HALF_NUMBER:4,HALF_ALPHABET:5,HALF_KATAKANA:6},LAYOUT_TYPE={TEN_KEY:0,FULL_KEY:1,FULL_KEY_CAP:2,TEN_KEY_EM:3,FULL_KEY_EM:4,FULL_KEY_CAP_EM:5},IME_SPECIAL_KEY={SPACE:32,BACK:-10,PREVIOUS:-11,NEXT:-12,MARK:-13,TRANSFORM:-14,CASE_CHANGE:-16,FULL:-17,H2K:-18,CAPSLOCK:-19,EN_LAYOUT:-20,NUM_LAYOUT:-21,BASIC_LAYOUT:-22,H2Z:-23,Z2H:-24,SWITCH_KEYBOARD:-3,
TOGGLE_CANDIDATE_PANEL:-4,HIDE_SYMBOL_LIST:-31},KEY_MODE={NORMAL:0,TRANSFORM:1,SELECT:2,H2K:3},CLAUSE_ATTR_MAP={RAW_INPUT:"raw-input",SELECTED_RAW_TEXT:"selected-raw-text",CONVERTED_TEXT:"converted-text",SELECTED_CONVERTED_TEXT:"selected-converted-text"},MIN_FLICK_MOVE_DISTANCE=5,FLICK_DIVISION_NUM=3,LAYOUT_SWITCH=!0,SETTING={VIBRATION:"keyboard.vibration",CLICK_SOUND:"keyboard.clicksound",AUTO_CORRECT:"keyboard.autocorrect",WORD_SUGGESTION:"keyboard.wordsuggestion",INPUT_FLICK:"keyboard.inputflick",
SENSITIVITY_FLICK:"keyboard.sensitivityflick",INPUT_TOGGLE:"keyboard.inputtoggle",INPUT_KEYPOPUP:"keyboard.inputkeypopup",CURSOR_AUTO_MOVE:"keyboard.cursorautomove",LAYOUT_BASIC:{PORTRAIT:"keyboard.layoutjpkanji.portrait",LANDSCAPE:"keyboard.layoutjpkanji.landscape"},LAYOUT_EN:{PORTRAIT:"keyboard.layoutjpkanjien.portrait",LANDSCAPE:"keyboard.layoutjpkanjien.landscape"},LAYOUT_NUM:{PORTRAIT:"keyboard.layoutjpkanjinum.portrait",LANDSCAPE:"keyboard.layoutjpkanjinum.landscape"},CONVERT_ANALYZE:"keyboard.convertanalyze",
CONVERT_LEARN:"keyboard.convertlearn"},IMEKeyMap={"\u3042":0,"\u304b":1,"\u3055":2,"\u305f":3,"\u306a":4,"\u306f":5,"\u307e":6,"\u3084":7,"\u3089":8,"\u308f":9,"\u3001":10,"\u30a2":0,"\u30ab":1,"\u30b5":2,"\u30bf":3,"\u30ca":4,"\u30cf":5,"\u30de":6,"\u30e4":7,"\u30e9":8,"\u30ef":9,"\uff71":0,"\uff76":1,"\uff7b":2,"\uff80":3,"\uff85":4,"\uff8a":5,"\uff8f":6,"\uff94":7,"\uff97":8,"\uff9c":9,"\uff64":10},IMEKeyEnMap={".":0,a:1,d:2,g:3,j:4,m:5,p:6,t:7,w:8,"-":9,",":10},IMENumberTable={1:"\uff11",2:"\uff12",
3:"\uff13",4:"\uff14",5:"\uff15",6:"\uff16",7:"\uff17",8:"\uff18",9:"\uff19",0:"\uff10"},IME_HIRAGANA_CYCLE_TABLE=["\u3042\u3044\u3046\u3048\u304a\u3041\u3043\u3045\u3047\u3049".split(""),["\u304b","\u304d","\u304f","\u3051","\u3053"],["\u3055","\u3057","\u3059","\u305b","\u305d"],"\u305f\u3061\u3064\u3066\u3068\u3063".split(""),["\u306a","\u306b","\u306c","\u306d","\u306e"],["\u306f","\u3072","\u3075","\u3078","\u307b"],["\u307e","\u307f","\u3080","\u3081","\u3082"],"\u3084\u3086\u3088\u3083\u3085\u3087\uff08\uff09".split(""),
["\u3089","\u308a","\u308b","\u308c","\u308d"],["\u308f","\u3092","\u3093","\u308e","\u30fc"],"\u3001\u3002\uff1f\uff01\u30fb\u3000".split("")],IME_HALF_ALPHABET_CYCLE_TABLE=[".@-_/:~1".split(""),"abcABC2".split(""),"defDEF3".split(""),"ghiGHI4".split(""),"jklJKL5".split(""),"mnoMNO6".split(""),"pqrsPQRS7".split(""),"tuvTUV8".split(""),"wxyzWXYZ9".split(""),["-","0"],",.?!; ".split("")],IME_HIRAGANA_CASE_TABLE={"\u3042":"\u3041","\u3044":"\u3043","\u3046":"\u3045","\u3048":"\u3047","\u304a":"\u3049",
"\u3041":"\u3042","\u3043":"\u3044","\u3045":"\u30f4","\u3047":"\u3048","\u3049":"\u304a","\u304b":"\u304c","\u304d":"\u304e","\u304f":"\u3050","\u3051":"\u3052","\u3053":"\u3054","\u304c":"\u304b","\u304e":"\u304d","\u3050":"\u304f","\u3052":"\u3051","\u3054":"\u3053","\u3055":"\u3056","\u3057":"\u3058","\u3059":"\u305a","\u305b":"\u305c","\u305d":"\u305e","\u3056":"\u3055","\u3058":"\u3057","\u305a":"\u3059","\u305c":"\u305b","\u305e":"\u305d","\u305f":"\u3060","\u3061":"\u3062","\u3064":"\u3063",
"\u3066":"\u3067","\u3068":"\u3069","\u3060":"\u305f","\u3062":"\u3061","\u3063":"\u3065","\u3067":"\u3066","\u3069":"\u3068","\u3065":"\u3064","\u30f4":"\u3046","\u306f":"\u3070","\u3072":"\u3073","\u3075":"\u3076","\u3078":"\u3079","\u307b":"\u307c","\u3070":"\u3071","\u3073":"\u3074","\u3076":"\u3077","\u3079":"\u307a","\u307c":"\u307d","\u3071":"\u306f","\u3074":"\u3072","\u3077":"\u3075","\u307a":"\u3078","\u307d":"\u307b","\u3084":"\u3083","\u3086":"\u3085","\u3088":"\u3087","\u3083":"\u3084",
"\u3085":"\u3086","\u3087":"\u3088","\u308f":"\u308e","\u308e":"\u308f","\u309b":"\u309c","\u309c":"\u309b"},IME_FULL_KATAKANA_CASE_TABLE={"\u30a2":"\u30a1","\u30a4":"\u30a3","\u30a6":"\u30a5","\u30a8":"\u30a7","\u30aa":"\u30a9","\u30a1":"\u30a2","\u30a3":"\u30a4","\u30a5":"\u30f4","\u30a7":"\u30a8","\u30a9":"\u30aa","\u30ab":"\u30ac","\u30ad":"\u30ae","\u30af":"\u30b0","\u30b1":"\u30b2","\u30b3":"\u30b4","\u30ac":"\u30ab","\u30ae":"\u30ad","\u30b0":"\u30af","\u30b2":"\u30b1","\u30b4":"\u30b3","\u30b5":"\u30b6",
"\u30b7":"\u30b8","\u30b9":"\u30ba","\u30bb":"\u30bc","\u30bd":"\u30be","\u30b6":"\u30b5","\u30b8":"\u30b7","\u30ba":"\u30b9","\u30bc":"\u30bb","\u30be":"\u30bd","\u30bf":"\u30c0","\u30c1":"\u30c2","\u30c4":"\u30c3","\u30c6":"\u30c7","\u30c8":"\u30c9","\u30c0":"\u30bf","\u30c2":"\u30c1","\u30c3":"\u30c5","\u30c7":"\u30c6","\u30c9":"\u30c8","\u30c5":"\u30c4","\u30f4":"\u30a6","\u30cf":"\u30d0","\u30d2":"\u30d3","\u30d5":"\u30d6","\u30d8":"\u30d9","\u30db":"\u30dc","\u30d0":"\u30d1","\u30d3":"\u30d4",
"\u30d6":"\u30d7","\u30d9":"\u30da","\u30dc":"\u30dd","\u30d1":"\u30cf","\u30d4":"\u30d2","\u30d7":"\u30d5","\u30da":"\u30d8","\u30dd":"\u30db","\u30e4":"\u30e3","\u30e6":"\u30e5","\u30e8":"\u30e7","\u30e3":"\u30e4","\u30e5":"\u30e6","\u30e7":"\u30e8","\u30ef":"\u30ee","\u30ee":"\u30ef"},IME_HALF_KATAKANA_CASE_TABLE={"\uff71":"\uff67","\uff72":"\uff68","\uff73":"\uff69","\uff74":"\uff6a","\uff75":"\uff6b","\uff67":"\uff71","\uff68":"\uff72","\uff69":"\uff73\uff9e","\uff6a":"\uff74","\uff6b":"\uff75",
"\uff76":"\uff76\uff9e","\uff77":"\uff77\uff9e","\uff78":"\uff78\uff9e","\uff79":"\uff79\uff9e","\uff7a":"\uff7a\uff9e","\uff76\uff9e":"\uff76","\uff77\uff9e":"\uff77","\uff78\uff9e":"\uff78","\uff79\uff9e":"\uff79","\uff7a\uff9e":"\uff7a","\uff7b":"\uff7b\uff9e","\uff7c":"\uff7c\uff9e","\uff7d":"\uff7d\uff9e","\uff7e":"\uff7e\uff9e","\uff7f":"\uff7f\uff9e","\uff7b\uff9e":"\uff7b","\uff7c\uff9e":"\uff7c","\uff7d\uff9e":"\uff7d","\uff7e\uff9e":"\uff7e","\uff7f\uff9e":"\uff7f","\uff80":"\uff80\uff9e",
"\uff81":"\uff81\uff9e","\uff82":"\uff6f","\uff83":"\uff83\uff9e","\uff84":"\uff84\uff9e","\uff80\uff9e":"\uff80","\uff81\uff9e":"\uff81","\uff6f":"\uff82\uff9e","\uff83\uff9e":"\uff83","\uff84\uff9e":"\uff84","\uff82\uff9e":"\uff82","\uff8a":"\uff8a\uff9e","\uff8b":"\uff8b\uff9e","\uff8c":"\uff8c\uff9e","\uff8d":"\uff8d\uff9e","\uff8e":"\uff8e\uff9e","\uff8a\uff9e":"\uff8a\uff9f","\uff8b\uff9e":"\uff8b\uff9f","\uff8c\uff9e":"\uff8c\uff9f","\uff8d\uff9e":"\uff8d\uff9f","\uff8e\uff9e":"\uff8e\uff9f",
"\uff8a\uff9f":"\uff8a","\uff8b\uff9f":"\uff8b","\uff8c\uff9f":"\uff8c","\uff8d\uff9f":"\uff8d","\uff8e\uff9f":"\uff8e","\uff94":"\uff6c","\uff95":"\uff6d","\uff96":"\uff6e","\uff6c":"\uff94","\uff6d":"\uff95","\uff6e":"\uff96","\uff9c":"\uff9c","\uff73\uff9e":"\uff73"},MAP_INPUT_FLICK_KEY={12354:["\u3042","\u3044","\u3046","\u3048","\u304a"],12363:["\u304b","\u304d","\u304f","\u3051","\u3053"],12373:["\u3055","\u3057","\u3059","\u305b","\u305d"],12383:["\u305f","\u3061","\u3064","\u3066","\u3068"],
12394:["\u306a","\u306b","\u306c","\u306d","\u306e"],12399:["\u306f","\u3072","\u3075","\u3078","\u307b"],12414:["\u307e","\u307f","\u3080","\u3081","\u3082"],12420:["\u3084","\uff08","\u3086","\uff09","\u3088"],12425:["\u3089","\u308a","\u308b","\u308c","\u308d"],12431:["\u308f","\u3092","\u3093","\u30fc",""],12289:["\u3001","\u3002","\uff1f","\uff01",""],46:[".","@","-","_","1"],97:["a","b","c","","2"],100:["d","e","f","","3"],103:["g","h","i","","4"],106:["j","k","l","","5"],109:["m","n","o","",
"6"],112:["p","q","r","s","7"],116:["t","u","v"," ","8"],119:["w","x","y","z","9"],45:["-","","0","",""],44:[",",".","?","!",""],49:["1",".","@","-",""],50:["2","/",":","_",""],51:["3","~","%","^",""],52:["4","[","`","]","'"],53:["5","<","$",">",String.fromCharCode(DOM_KEYCODE_HARF_YEN)],54:["6","{","&","}",'"'],55:["7","\\","","|",""],56:["8","(","",")",""],57:["9","=","",";",""],42:["*","!","","?",""],48:["0","","+","",""],35:["#",",","",".",""],65297:["\uff11","\uff0e","\uff20","\u30fc",""],65298:["\uff12",
"\uff0f","\uff1a","\uff3f",""],65299:["\uff13","\uff5e","\uff05","\uff3e",""],65300:["\uff14","\uff3b","\u2018","\uff3d","\u2019"],65301:["\uff15","\uff1c","\uff04","\uff1e","\uffe5"],65302:["\uff16","\uff5b","\uff06","\uff5d","\u201d"],65303:["\uff17","\uff3c","","\uff5c",""],65304:["\uff18","\uff08","","\uff09",""],65305:["\uff19","\uff1d","","\uff1b",""],65290:["\uff0a","\uff01","","\uff1f",""],65296:["\uff10","","\uff0b","",""],65283:["\uff03","\u3001","","\u3002",""]},mapRoma={hira:{la:"\u3041",
xa:"\u3041",a:"\u3042",li:"\u3043",lyi:"\u3043",xi:"\u3043",xyi:"\u3043",i:"\u3044",yi:"\u3044",ye:"\u3044\u3047",lu:"\u3045",xu:"\u3045",u:"\u3046",whu:"\u3046",wu:"\u3046",wha:"\u3046\u3041",whi:"\u3046\u3043",wi:"\u3046\u3043",we:"\u3046\u3047",whe:"\u3046\u3047",who:"\u3046\u3049",le:"\u3047",lye:"\u3047",xe:"\u3047",xye:"\u3047",e:"\u3048",lo:"\u3049",xo:"\u3049",o:"\u304a",ca:"\u304b",ka:"\u304b",ga:"\u304c",ki:"\u304d",kyi:"\u304d\u3043",kye:"\u304d\u3047",kya:"\u304d\u3083",kyu:"\u304d\u3085",
kyo:"\u304d\u3087",gi:"\u304e",gyi:"\u304e\u3043",gye:"\u304e\u3047",gya:"\u304e\u3083",gyu:"\u304e\u3085",gyo:"\u304e\u3087",cu:"\u304f",ku:"\u304f",qu:"\u304f",kwa:"\u304f\u3041",qa:"\u304f\u3041",qwa:"\u304f\u3041",qi:"\u304f\u3043",qwi:"\u304f\u3043",qyi:"\u304f\u3043",qwu:"\u304f\u3045",qe:"\u304f\u3047",qwe:"\u304f\u3047",qye:"\u304f\u3047",qo:"\u304f\u3049",qwo:"\u304f\u3049",qya:"\u304f\u3083",qyu:"\u304f\u3085",qyo:"\u304f\u3087",gu:"\u3050",gwa:"\u3050\u3041",gwi:"\u3050\u3043",gwu:"\u3050\u3045",
gwe:"\u3050\u3047",gwo:"\u3050\u3049",ke:"\u3051",ge:"\u3052",co:"\u3053",ko:"\u3053",go:"\u3054",sa:"\u3055",za:"\u3056",ci:"\u3057",shi:"\u3057",si:"\u3057",syi:"\u3057\u3043",she:"\u3057\u3047",sye:"\u3057\u3047",sha:"\u3057\u3083",sya:"\u3057\u3083",shu:"\u3057\u3085",syu:"\u3057\u3085",sho:"\u3057\u3087",syo:"\u3057\u3087",ji:"\u3058",zi:"\u3058",jyi:"\u3058\u3043",zyi:"\u3058\u3043",je:"\u3058\u3047",jye:"\u3058\u3047",zye:"\u3058\u3047",ja:"\u3058\u3083",jya:"\u3058\u3083",zya:"\u3058\u3083",
ju:"\u3058\u3085",jyu:"\u3058\u3085",zyu:"\u3058\u3085",jo:"\u3058\u3087",jyo:"\u3058\u3087",zyo:"\u3058\u3087",su:"\u3059",swa:"\u3059\u3041",swi:"\u3059\u3043",swu:"\u3059\u3045",swe:"\u3059\u3047",swo:"\u3059\u3049",zu:"\u305a",ce:"\u305b",se:"\u305b",ze:"\u305c",so:"\u305d",zo:"\u305e",ta:"\u305f",da:"\u3060",chi:"\u3061",ti:"\u3061",cyi:"\u3061\u3043",tyi:"\u3061\u3043",che:"\u3061\u3047",cye:"\u3061\u3047",tye:"\u3061\u3047",cha:"\u3061\u3083",cya:"\u3061\u3083",tya:"\u3061\u3083",chu:"\u3061\u3085",
cyu:"\u3061\u3085",tyu:"\u3061\u3085",cho:"\u3061\u3087",cyo:"\u3061\u3087",tyo:"\u3061\u3087",di:"\u3062",dyi:"\u3062\u3043",dye:"\u3062\u3047",dya:"\u3062\u3083",dyu:"\u3062\u3085",dyo:"\u3062\u3087",ltsu:"\u3063",ltu:"\u3063",xtu:"\u3063",tsu:"\u3064",tu:"\u3064",tsa:"\u3064\u3041",tsi:"\u3064\u3043",tse:"\u3064\u3047",tso:"\u3064\u3049",du:"\u3065",te:"\u3066",thi:"\u3066\u3043",the:"\u3066\u3047",tha:"\u3066\u3083",thu:"\u3066\u3085",tho:"\u3066\u3087",de:"\u3067",dhi:"\u3067\u3043",dhe:"\u3067\u3047",
dha:"\u3067\u3083",dhu:"\u3067\u3085",dho:"\u3067\u3087",to:"\u3068",twa:"\u3068\u3041",twi:"\u3068\u3043",twu:"\u3068\u3045",twe:"\u3068\u3047",two:"\u3068\u3049","do":"\u3069",dwa:"\u3069\u3041",dwi:"\u3069\u3043",dwu:"\u3069\u3045",dwe:"\u3069\u3047",dwo:"\u3069\u3049",na:"\u306a",ni:"\u306b",nyi:"\u306b\u3043",nye:"\u306b\u3047",nya:"\u306b\u3083",nyu:"\u306b\u3085",nyo:"\u306b\u3087",nu:"\u306c",ne:"\u306d",no:"\u306e",ha:"\u306f",ba:"\u3070",pa:"\u3071",hi:"\u3072",hyi:"\u3072\u3043",hye:"\u3072\u3047",
hya:"\u3072\u3083",hyu:"\u3072\u3085",hyo:"\u3072\u3087",bi:"\u3073",byi:"\u3073\u3043",bye:"\u3073\u3047",bya:"\u3073\u3083",byu:"\u3073\u3085",byo:"\u3073\u3087",pi:"\u3074",pyi:"\u3074\u3043",pye:"\u3074\u3047",pya:"\u3074\u3083",pyu:"\u3074\u3085",pyo:"\u3074\u3087",fu:"\u3075",hu:"\u3075",fa:"\u3075\u3041",fwa:"\u3075\u3041",fi:"\u3075\u3043",fwi:"\u3075\u3043",fyi:"\u3075\u3043",fwu:"\u3075\u3045",fe:"\u3075\u3047",fwe:"\u3075\u3047",fye:"\u3075\u3047",fo:"\u3075\u3049",fwo:"\u3075\u3049",fya:"\u3075\u3083",
fyu:"\u3075\u3085",fyo:"\u3075\u3087",bu:"\u3076",pu:"\u3077",he:"\u3078",be:"\u3079",pe:"\u307a",ho:"\u307b",bo:"\u307c",po:"\u307d",ma:"\u307e",mi:"\u307f",myi:"\u307f\u3043",mye:"\u307f\u3047",mya:"\u307f\u3083",myu:"\u307f\u3085",myo:"\u307f\u3087",mu:"\u3080",me:"\u3081",mo:"\u3082",lya:"\u3083",xya:"\u3083",ya:"\u3084",lyu:"\u3085",xyu:"\u3085",yu:"\u3086",lyo:"\u3087",xyo:"\u3087",yo:"\u3088",ra:"\u3089",ri:"\u308a",ryi:"\u308a\u3043",rye:"\u308a\u3047",rya:"\u308a\u3083",ryu:"\u308a\u3085",
ryo:"\u308a\u3087",ru:"\u308b",re:"\u308c",ro:"\u308d",lwa:"\u308e",xwa:"\u308e",wa:"\u308f",wo:"\u3092",nn:"\u3093",xn:"\u3093",vu:"\u30f4",va:"\u30f4\u3041",vi:"\u30f4\u3043",vyi:"\u30f4\u3043",ve:"\u30f4\u3047",vye:"\u30f4\u3047",vo:"\u30f4\u3049",vya:"\u30f4\u3083",vyu:"\u30f4\u3085",vyo:"\u30f4\u3087",bb:"\u3063b",cc:"\u3063c",dd:"\u3063d",ff:"\u3063f",gg:"\u3063g",hh:"\u3063h",jj:"\u3063j",kk:"\u3063k",ll:"\u3063l",mm:"\u3063m",pp:"\u3063p",qq:"\u3063q",rr:"\u3063r",ss:"\u3063s",tt:"\u3063t",
vv:"\u3063v",ww:"\u3063w",xx:"\u3063x",yy:"\u3063y",zz:"\u3063z","-":"\u30fc",".":"\u3002",", ":"\u3001",nb:"\u3093b",nc:"\u3093c",nd:"\u3093d",nf:"\u3093f",ng:"\u3093g",nh:"\u3093h",nj:"\u3093j",nk:"\u3093k",nl:"\u3093l",nm:"\u3093m",np:"\u3093p",nq:"\u3093q",nr:"\u3093r",ns:"\u3093s",nt:"\u3093t",nv:"\u3093v",nw:"\u3093w",nx:"\u3093x",ny:"\u3093y",nz:"\u3093z"},kana:{la:"\u30a1",xa:"\u30a1",a:"\u30a2",li:"\u30a3",lyi:"\u30a3",xi:"\u30a3",xyi:"\u30a3",i:"\u30a4",yi:"\u30a4",ye:"\u30a4\u30a7",lu:"\u30a5",
xu:"\u30a5",u:"\u30a6",whu:"\u30a6",wu:"\u30a6",wha:"\u30a6\u30a1",whi:"\u30a6\u30a3",wi:"\u30a6\u30a3",we:"\u30a6\u30a7",whe:"\u30a6\u30a7",who:"\u30a6\u30a9",le:"\u30a7",lye:"\u30a7",xe:"\u30a7",xye:"\u30a7",e:"\u30a8",lo:"\u30a9",xo:"\u30a9",o:"\u30aa",ca:"\u30ab",ka:"\u30ab",ga:"\u30ac",ki:"\u30ad",kyi:"\u30ad\u30a3",kye:"\u30ad\u30a7",kya:"\u30ad\u30e3",kyu:"\u30ad\u30e5",kyo:"\u30ad\u30e7",gi:"\u30ae",gyi:"\u30ae\u30a3",gye:"\u30ae\u30a7",gya:"\u30ae\u30e3",gyu:"\u30ae\u30e5",gyo:"\u30ae\u30e7",
cu:"\u30af",ku:"\u30af",qu:"\u30af",kwa:"\u30af\u30a1",qa:"\u30af\u30a1",qwa:"\u30af\u30a1",qi:"\u30af\u30a3",qwi:"\u30af\u30a3",qyi:"\u30af\u30a3",qwu:"\u30af\u30a5",qe:"\u30af\u30a7",qwe:"\u30af\u30a7",qye:"\u30af\u30a7",qo:"\u30af\u30a9",qwo:"\u30af\u30a9",qya:"\u30af\u30e3",qyu:"\u30af\u30e5",qyo:"\u30af\u30e7",gu:"\u30b0",gwa:"\u30b0\u30a1",gwi:"\u30b0\u30a3",gwu:"\u30b0\u30a5",gwe:"\u30b0\u30a7",gwo:"\u30b0\u30a9",ke:"\u30b1",ge:"\u30b2",co:"\u30b3",ko:"\u30b3",go:"\u30b4",sa:"\u30b5",za:"\u30b6",
ci:"\u30b7",shi:"\u30b7",si:"\u30b7",syi:"\u30b7\u30a3",she:"\u30b7\u30a7",sye:"\u30b7\u30a7",sha:"\u30b7\u30e3",sya:"\u30b7\u30e3",shu:"\u30b7\u30e5",syu:"\u30b7\u30e5",sho:"\u30b7\u30e7",syo:"\u30b7\u30e7",ji:"\u30b8",zi:"\u30b8",jyi:"\u30b8\u30a3",zyi:"\u30b8\u30a3",je:"\u30b8\u30a7",jye:"\u30b8\u30a7",zye:"\u30b8\u30a7",ja:"\u30b8\u30e3",jya:"\u30b8\u30e3",zya:"\u30b8\u30e3",ju:"\u30b8\u30e5",jyu:"\u30b8\u30e5",zyu:"\u30b8\u30e5",jo:"\u30b8\u30e7",jyo:"\u30b8\u30e7",zyo:"\u30b8\u30e7",su:"\u30b9",
swa:"\u30b9\u30a1",swi:"\u30b9\u30a3",swu:"\u30b9\u30a5",swe:"\u30b9\u30a7",swo:"\u30b9\u30a9",zu:"\u30ba",ce:"\u30bb",se:"\u30bb",ze:"\u30bc",so:"\u30bd",zo:"\u30be",ta:"\u30bf",da:"\u30c0",chi:"\u30c1",ti:"\u30c1",cyi:"\u30c1\u30a3",tyi:"\u30c1\u30a3",che:"\u30c1\u30a7",cye:"\u30c1\u30a7",tye:"\u30c1\u30a7",cha:"\u30c1\u30e3",cya:"\u30c1\u30e3",tya:"\u30c1\u30e3",chu:"\u30c1\u30e5",cyu:"\u30c1\u30e5",tyu:"\u30c1\u30e5",cho:"\u30c1\u30e7",cyo:"\u30c1\u30e7",tyo:"\u30c1\u30e7",di:"\u30c2",dyi:"\u30c2\u30a3",
dye:"\u30c2\u30a7",dya:"\u30c2\u30e3",dyu:"\u30c2\u30e5",dyo:"\u30c2\u30e7",ltsu:"\u30c3",ltu:"\u30c3",xtu:"\u30c3",tsu:"\u30c4",tu:"\u30c4",tsa:"\u30c4\u30a1",tsi:"\u30c4\u30a3",tse:"\u30c4\u30a7",tso:"\u30c4\u30a9",du:"\u30c5",te:"\u30c6",thi:"\u30c6\u30a3",the:"\u30c6\u30a7",tha:"\u30c6\u30e3",thu:"\u30c6\u30e5",tho:"\u30c6\u30e7",de:"\u30c7",dhi:"\u30c7\u30a3",dhe:"\u30c7\u30a7",dha:"\u30c7\u30e3",dhu:"\u30c7\u30e5",dho:"\u30c7\u30e7",to:"\u30c8",twa:"\u30c8\u30a1",twi:"\u30c8\u30a3",twu:"\u30c8\u30a5",
twe:"\u30c8\u30a7",two:"\u30c8\u30a9","do":"\u30c9",dwa:"\u30c9\u30a1",dwi:"\u30c9\u30a3",dwu:"\u30c9\u30a5",dwe:"\u30c9\u30a7",dwo:"\u30c9\u30a9",na:"\u30ca",ni:"\u30cb",nyi:"\u30cb\u30a3",nye:"\u30cb\u30a7",nya:"\u30cb\u30e3",nyu:"\u30cb\u30e5",nyo:"\u30cb\u30e7",nu:"\u30cc",ne:"\u30cd",no:"\u30ce",ha:"\u30cf",ba:"\u30d0",pa:"\u30d1",hi:"\u30d2",hyi:"\u30d2\u30a3",hye:"\u30d2\u30a7",hya:"\u30d2\u30e3",hyu:"\u30d2\u30e5",hyo:"\u30d2\u30e7",bi:"\u30d3",byi:"\u30d3\u30a3",bye:"\u30d3\u30a7",bya:"\u30d3\u30e3",
byu:"\u30d3\u30e5",byo:"\u30d3\u30e7",pi:"\u30d4",pyi:"\u30d4\u30a3",pye:"\u30d4\u30a7",pya:"\u30d4\u30e3",pyu:"\u30d4\u30e5",pyo:"\u30d4\u30e7",fu:"\u30d5",hu:"\u30d5",fa:"\u30d5\u30a1",fwa:"\u30d5\u30a1",fi:"\u30d5\u30a3",fwi:"\u30d5\u30a3",fyi:"\u30d5\u30a3",fwu:"\u30d5\u30a5",fe:"\u30d5\u30a7",fwe:"\u30d5\u30a7",fye:"\u30d5\u30a7",fo:"\u30d5\u30a9",fwo:"\u30d5\u30a9",fya:"\u30d5\u30e3",fyu:"\u30d5\u30e5",fyo:"\u30d5\u30e7",bu:"\u30d6",pu:"\u30d7",he:"\u30d8",be:"\u30d9",pe:"\u30da",ho:"\u30db",
bo:"\u30dc",po:"\u30dd",ma:"\u30de",mi:"\u30df",myi:"\u30df\u30a3",mye:"\u30df\u30a7",mya:"\u30df\u30e3",myu:"\u30df\u30e5",myo:"\u30df\u30e7",mu:"\u30e0",me:"\u30e1",mo:"\u30e2",lya:"\u30e3",xya:"\u30e3",ya:"\u30e4",lyu:"\u30e5",xyu:"\u30e5",yu:"\u30e6",lyo:"\u30e7",xyo:"\u30e7",yo:"\u30e8",ra:"\u30e9",ri:"\u30ea",ryi:"\u30ea\u30a3",rye:"\u30ea\u30a7",rya:"\u30ea\u30e3",ryu:"\u30ea\u30e5",ryo:"\u30ea\u30e7",ru:"\u30eb",re:"\u30ec",ro:"\u30ed",lwa:"\u30ee",xwa:"\u30ee",wa:"\u30ef",wo:"\u30f2",nn:"\u30f3",
xn:"\u30f3",vu:"\u30f4",va:"\u30f4\u30a1",vi:"\u30f4\u30a3",vyi:"\u30f4\u30a3",ve:"\u30f4\u30a7",vye:"\u30f4\u30a7",vo:"\u30f4\u30a9",vya:"\u30f4\u30e3",vyu:"\u30f4\u30e5",vyo:"\u30f4\u30e7",lka:"\u30f5",xka:"\u30f5",lke:"\u30f6",xke:"\u30f6",bb:"\u30c3b",cc:"\u30c3c",dd:"\u30c3d",ff:"\u30c3f",gg:"\u30c3g",hh:"\u30c3h",jj:"\u30c3j",kk:"\u30c3k",ll:"\u30c3l",mm:"\u30c3m",pp:"\u30c3p",qq:"\u30c3q",rr:"\u30c3r",ss:"\u30c3s",tt:"\u30c3t",vv:"\u30c3v",ww:"\u30c3w",xx:"\u30c3x",yy:"\u30c3y",zz:"\u30c3z",
"-":"\u30fc",".":"\u3002",", ":"\u3001",nb:"\u30f3b",nc:"\u30f3c",nd:"\u30f3d",nf:"\u30f3f",ng:"\u30f3g",nh:"\u30f3h",nj:"\u30f3j",nk:"\u30f3k",nl:"\u30f3l",nm:"\u30f3m",np:"\u30f3p",nq:"\u30f3q",nr:"\u30f3r",ns:"\u30f3s",nt:"\u30f3t",nv:"\u30f3v",nw:"\u30f3w",nx:"\u30f3x",ny:"\u30f3y",nz:"\u30f3z"}},IME_SYMBOL_TAB_NAMES={SYMBOL:"symbol",KAO_MOJI:"kao_moji",EMOJI:"emoji"},IME_SYMBOL_TAB_ORDER=[IME_SYMBOL_TAB_NAMES.SYMBOL,IME_SYMBOL_TAB_NAMES.KAO_MOJI,IME_SYMBOL_TAB_NAMES.EMOJI],OS_MAJOR_VERSION={ONE_THREE:"1.3"},
SETTING_CONTROL_DISABLED={"cb-inputFlick":{on:{"cb-sensitivityFlick":{disabled:!1},sensitivityFlick:{"class":{remove:"setting-disable"}},"cb-inputToggle":{disabled:!1},inputToggle:{"class":{remove:"setting-disable"}}},off:{"cb-sensitivityFlick":{disabled:!0},sensitivityFlick:{"class":{add:"setting-disable"}},"cb-inputToggle":{checked:!0,disabled:!0},inputToggle:{"class":{add:"setting-disable"}}}},"cb-inputToggle":{on:{"sel-cursorAutoMove":{disabled:!1},cursorAutoMove:{"class":{remove:"setting-disable"}}},
off:{"sel-cursorAutoMove":{disabled:!0},cursorAutoMove:{"class":{add:"setting-disable"}}}}},CONV_ENGINE_MAP={INITIALIZE:"11",TERMINATE:"12",LANG_SETTINGS_SPECIFIED:"13",LANG_SETTINGS_SAVED:"14",SETTINGS_FILTERING:"15",ADD_DICTIONARY:"16",KYEBORAD_MODE_SETTINGS:"17",ANALYZE:"31",CONVERSION_MULTIPLE:"32",CONVERSION_EISUKANA:"33",LEARN:"34",DELETE_WORD:"35",DIC_SEARCH:"51",ADD_WORD:"52",CLEAR_DICTIONARY:"53",SAVE_DICTIONARY:"54",GET_DICTIONARY_MODE:"55"},CONV_KEYBOARD_MODE={TEN:"0",FULL:"1"},CONV_DIC_LOAD_FLG=
{OFF:"0",ON:"1"},CONV_ANALYZE_OPTION_DEF={NO:0,NO_RENBUN:1,NO_TANBUN:2,NO_CLEAR_LEARN_CACHE:4,NO_LEARN:5,NO_YOSOKU:16,NO_ZEN:32,HEAD_CONV_ON:1024,HEAD_CONV2_ON:2048,YOMINASI_ON:256,RELATION_ON:512},CONV_ENGINE_LANG_MODE_JAPANESE="0",CONV_DIC_MODE={PREDICTION:"0",EISUKANA:"1",FACE_TEXT:"2",PERSON_NAME:"3",PLACE_NAME:"4",MAIL_ADDRESS:"5",USER:"6",LEARNING:"7",PERSON_NAME_USER:"8",MAIL_ADDRESS_USER:"9",TEL_USER:"10"},CONV_DIC_TYPE={NONE_SPECIFIED:"0",USER:"1",LEARNING:"2",ALL:"3"},CONV_NO_CONV_LEARNING=
"-1",CONV_SEARCH_ORDER={FREQUENCY:"0",READING:"1",REGISTRATION:"2"},CONV_REGISTRY_DIC_CLASS={USER:"0",LEARNING:"1",RESEMBLES:"2"},CONV_RELATION_LEARNING={OFF:"0",ON:"1"},CONV_LEARNING={OFF:"0",ON:"1"},SETTING_CURSOR_AUTO_MOVE_TIME={OFF:0,FAST:700,NORMAL:1200,SLOW:1700},FUNC_PARTS={KEYBOARD:{REPEAT_KEY:"keyboard.repeat_key",SWITCH_LAYOUT_KEY:"keyboard.switch_layout_key",OTHER_KEY:"keyboard.other_key",MINI_KEYBOARD:"keyboard.mini_keyboard"},CANDIDATE:{CANDIDATE_MENU:"candidate.candidate_menu",CANDIDATE:"candidate.candidate",
TOGGLE_BUTTON:"candidate.toggle_button"},SYMBOL_LIST:{CATEGORY:"symbol_list.category",TAB:"symbol_list.tab",CANDIDATE:"symbol_list.candidate"}},CANDIDATE_TYPE={PREDICT:"predict",SYMBOL:"symbol"};
function parseLabel(a){var b="";65536<a?(a-=65536,b=Math.floor(a/1024),a=a%1024+56320,b=String.fromCharCode(b+55296,a)):b=String.fromCharCode(a);return b}
function getMonthTimeCategory(){var a=new Date,b=0,c=60*a.getHours()+(a.getMinutes()-0),a=a.getMonth()+1;c<CONST_NIGHT_END&&(b+=CONST_STATUS_TIME.NIGHT);c>=CONST_MONING_START&&c<=CONST_MONING_END&&(b+=CONST_STATUS_TIME.MORNING);c>=CONST_NOON_START&&c<=CONST_NOON_END&&(b+=CONST_STATUS_TIME.NOON);c>=CONST_NIGHT_START&&(b+=CONST_STATUS_TIME.NIGHT);b+=CONST_STATUS_MONTH[a];return b.toString(16)}
var debugging=!1,debug=function(a){debugging&&(window.dump&&window.dump("JP: "+a+"\n"),console&&console.log&&(console.log("JP: "+a),1<arguments.length&&console.log.apply(this,arguments)))},isClass=function(a,b){var c=Object.prototype.toString.call(b).slice(8,-1);return void 0!==b&&null!==b&&c===a},isUnicode=function(a){return 0===a.indexOf("U+")||0===a.indexOf("\\u")},strWidthLength=function(a){var b=0,c=0;a=escape(a);for(var d=0;d<a.length;d++)if("%"==a.charAt(d)){if("u"==a.charAt(++d)){var f=a.substr(d+
1,4),e=a.substr(d+7,4),f=parseInt(f,16),e=parseInt(e,16);isSurrogatePairCode(f,e)?(d+=6,c++):65377<=f&&65440>=f?b++:c++;d+=3}else e=a.substr(d,2),e=parseInt(e,16),33<=e&&47>=e||58<=e&&64>=e||91<=e&&96>=e||123<=e&&126>=e?b++:c++;d++}else b++;return c+Math.ceil(1.6*b/2)},isSurrogatePairCode=function(a,b){return 55296<=a&&56319>=a&&56320<=b&&57343>=b},isSurrogatePair=function(a){a=escape(a);if("%u"==a.slice(0,2)){var b=a.substr(2,4);a=a.substr(8,4);b=parseInt(b,16);a=parseInt(a,16);return isSurrogatePairCode(b,
a)}return!1},Toast=function(){var a=navigator.mozL10n.get,b=null,c=document.getElementsByTagName("body").item(0),d=document.createElement("div");d.setAttribute("id","toast-out");d.setAttribute("hidden","true");var f=document.createElement("span");f.setAttribute("id","toast");d.appendChild(f);c.appendChild(d);return{show:function(e,c,g){c=g?a(c,g):a(c);f.innerHTML="<p>"+c+"</p>";d.hidden=!1;b&&(window.clearTimeout(b),b=null);b=window.setTimeout(function(){window.clearTimeout(b);b=null;d.hidden=!0},
e)}}}(),Timer=function(){return{start:function(a){},end:function(a,b){}}}();
var DB_NAME="imeKeyboard-db",DB_VERSION=1,imeDB,DB_TABLES={history:{keyPath:{name:"data",autoIncrement:!1},Indexes:{name:"tabName",keys:["tabName"],params:{}}},setting:{keyPath:{name:"setKey",autoIncrement:!1},Indexes:{name:"",keys:[],params:{}},defaultData:[{setKey:SETTING.VIBRATION,value:!1},{setKey:SETTING.CLICK_SOUND,value:!1},{setKey:SETTING.AUTO_CORRECT,value:!0},{setKey:SETTING.WORD_SUGGESTION,value:!0},{setKey:SETTING.INPUT_FLICK,value:!0},{setKey:SETTING.SENSITIVITY_FLICK,value:50},{setKey:SETTING.INPUT_TOGGLE,
value:!0},{setKey:SETTING.INPUT_KEYPOPUP,value:!0},{setKey:SETTING.CURSOR_AUTO_MOVE,value:SETTING_CURSOR_AUTO_MOVE_TIME.NORMAL},{setKey:SETTING.LAYOUT_BASIC.PORTRAIT,value:0},{setKey:SETTING.LAYOUT_BASIC.LANDSCAPE,value:0},{setKey:SETTING.LAYOUT_EN.PORTRAIT,value:0},{setKey:SETTING.LAYOUT_EN.LANDSCAPE,value:0},{setKey:SETTING.LAYOUT_NUM.PORTRAIT,value:0},{setKey:SETTING.LAYOUT_NUM.LANDSCAPE,value:0},{setKey:SETTING.CONVERT_ANALYZE,value:!0},{setKey:SETTING.CONVERT_LEARN,value:!0}]}},IndexedDB={indexedDB:window.indexedDB||
window.webkitIndexedDB||window.mozIndexedDB||window.msIndexedDB,IDBDatabase:window.IDBDatabase||window.webkitIDBDatabase||window.msIDBDatabase,IDBIndex:window.IDBIndex||window.webkitIDBIndex||window.msIDBIndex,isReady:function(){return!this.indexedDB||this.IDBDatabase.prototype.setVersion||"file:"===window.location.protocol?(debug("IndexedDB is not available on this platform."),!1):!0}};
function deleteDB(){debug("::: deleteDB db start :::");var a=IndexedDB.indexedDB.deleteDatabase(DB_NAME);a.onsuccess=function(b){debug("::: delete DB onsuccess :::")};a.onerror=function(b){debug("::: delete DB onerror :::")}}
function db_onCreate(a){function b(b,c){if(!b)return!1;debug("create: "+c);b.objectStoreNames.contains(c)&&b.deleteObjectStore(c);var a=DB_TABLES[c],f=b.createObjectStore(c,{keyPath:a.keyPath.name},a.keyPath.autoIncrement),g=a.Indexes;null!=g&&g.name&&g.keys&&0<g.keys.length&&f.createIndex(a.Indexes.name,a.Indexes.keys,a.Indexes.params);return!0}debug("::: onCreate db start :::");b(a.target.result,"history");b(a.target.result,"setting");debug("::: created objectStore :::")}
var openDB=function(a){debug("::: openDB");if(imeDB)a&&a(imeDB);else{var b=!1,d=IndexedDB.indexedDB.open(DB_NAME,DB_VERSION);d.onupgradeneeded=function(c){b=!0;db_onCreate(c)};d.onerror=function(b){console.log("open error:"+b)};d.onsuccess=function(c){debug("::: openDB onsuccess:"+c);imeDB=c.target.result;b?setDBDefaultData(function(){a&&a(imeDB)}):a&&a(imeDB)}}},setDBDefaultData=function(a){function b(){c++;a&&c==Object.keys(DB_TABLES).length&&a()}function d(a){var c=a;a=0;for(var d=c;a<d;a++)setDBData(e,
f.defaultData[a],function(){0===--c&&b()})}var c=0,e;for(e in DB_TABLES){var f=DB_TABLES[e];null!=f.defaultData?d(f.defaultData.length):b()}},setDBData=function(a,b,d){debug("::: insertUpdateDBData :tblName["+a+"]");debug(":::                    :data "+(b?b.toSource():null));openDB(function(c){c=c.transaction([a],"readwrite").objectStore(a).put(b);c.onsuccess=function(a){debug("set data onsuccess");d&&d(!0)};c.onerror=function(a){debug("set data onerror")}})},selectDBData=function(a,b,d){debug(":::::: selectDBData :tblName["+
a+"]");openDB(function(c){var e=DB_TABLES[a];c=c.transaction([a],"readonly").objectStore(a);var f=b&&b.data?b.data:null,g=b&&b.index?b.index:null,h=b&&b.sort?b.sort:IDBCursor.NEXT,e=f?isClass("String",f)?c.openCursor(f,h):g&&e.Indexes&&e.Indexes.name?c.index(g).openCursor(f,h):c.openCursor(null,h):c.openCursor(null,h),k=[];e.onerror=function(a){debug("search data onerror")};e.onsuccess=function(a){(a=a.target.result)?(k.push(a.value),a.continue()):d&&d(k)}})},deleteDBData=function(a,b,d){debug(":::::: deleteDBData :tblName["+
a+"]");openDB(function(c){c=c.transaction([a],"readwrite").objectStore(a);c=b?c.delete(b):c.clear();c.onsuccess=function(a){debug("delete data onsuccess");d&&d(!0)};c.onerror=function(a){debug("delete data onerror")}})},resetIndexedDBSettings=function(a){debug(":::::: resetIndexedDBSettings ::::::");deleteDBData("setting",null,function(b){if(b&&(debug(":::::: set default setting data"),b=DB_TABLES.setting,null!=b.defaultData)){var d=b.defaultData.length;[].forEach.call(b.defaultData,function(b,e){setDBData("setting",
b,function(b){0===--d&&a&&a()})})}})},getDBRecordCount=function(a,b,d){debug(":::::: getRecordCount :tblName["+a+"]");openDB(function(c){var e=DB_TABLES[a];c=c.transaction([a],"readonly").objectStore(a);var f=b&&b.data?b.data:null,g=b&&b.index?b.index:null,e=f?isClass("String",f)?c.count(f):g&&e.Indexes&&e.Indexes.name?c.index(g).count(f):c.count(null):c.count(null);e.onerror=function(a){debug("search data onerror")};e.onsuccess=function(a){d&&d(a.target.result)}})};
var webSocket=function(){function f(a){return a="wnn_message="+a.replace(/%20/g,"+")}var a=null,d=[],b=0,g=function(c){b=window.setTimeout(function(){b&&(window.clearTimeout(b),b=0);a&&(a.abort(),a=null);c&&c(ERR_TCP_PROCESS_TIMEOUT)},TCP_PROCESS_TIMEOUT_TIMER)};return{send:function(c,e){try{a||(a=new XMLHttpRequest({mozSystem:!0}),g(e),a.open("POST","http://127.0.0.1:4095",!0),a.onreadystatechange=function(){4==a.readyState&&(debug("***** WebSocket: onreadystatechange completed"),b&&(window.clearTimeout(b),
b=0),200==a.status?(d=JSON.parse(a.responseText),debug("***** WebSocket: status OK   data:"+d)):(d=ERR_TCP_PROCESS_TIMEOUT,debug("***** WebSocket: HTTP Status Error: status:"+a.status+", data:"+a.responseText)),a&&(a.abort(),a=null),e&&e(d))},a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.send(f(c)),debug("***** WebSocket: send data:"+f(c)))}catch(h){debug("Could not create a web socket: "+h.name)}}}}();
var convWrapper=function(){var q,r,s;function G(){[].forEach.call(e,function(b,c){debug(" *************************** q["+c+"] processId: "+b.processId+", groupId: "+b.groupId)})}function f(){return 0<e.length?e[e.length-1].groupId+1:1}function x(){s=r=q=""}function H(b){switch(b.processId){case CONV_ENGINE_MAP.ANALYZE:case CONV_ENGINE_MAP.CONVERSION_MULTIPLE:case CONV_ENGINE_MAP.CONVERSION_EISUKANA:case CONV_ENGINE_MAP.DIC_SEARCH:break;default:return}var c=[];[].forEach.call(e,function(a,m){b.processId==
a.processId&&(debug("*************************************** del process: "+b.processId+", index:"+m),c.push(m))});for(var a=c.length-1;0<=a;a--)e.splice(c[a],1)}function l(b,c){H(b);isClass("Number",c)&&0<=c&&c<=e.length?e.splice(c,0,b):e.push(b)}function A(){for(var b=[],c=0,a=e.length;c<a;c++)if(e[c].groupId===t)b[b.length]=index;else break;debug(" ---------------------------- remove groupId: "+t);for(c=b.length-1;0<=c;c--)debug(" ---------------------------- remove queue["+c+"]: "+e[b[c]].processId),
debug(" ---------------------------- remove queue["+c+"]: "+e[b[c]].groupId),delete e[b[c]]}function h(b){G();!v&&0<e.length?(v=!0,(g=e.shift())?(t=e.groupId,g.method()):k(ERR_TCP_NOT_EXIST_QUEUE)):b?(g=e.shift(),g.method(),debug(" ----------------- continuity process true id:"+(g?g.processId:null))):debug(" ---------------------------- process true id:"+(g?g.processId:null))}function k(b,c){if(b&&"-19999"==b[0]&&g.processId!=CONV_ENGINE_MAP.SAVE_DICTIONARY){Toast.show(TOAST_TIMER,"trial_period_passed");
var a=null,a=window.setTimeout(function(){window.clearTimeout(a);KeyboardEventHandler.dispatch("hideIME")},HIDE_IME_TIMER_TRIAL_PERIOD_END);e=[]}"string"===typeof b?(debug(" ---------------------------- process error exception: "+(g?g.processId:null)),A()):b===ERR_TCP_PROCESS_TIMEOUT||b===ERR_TCP_JSON_PARSE||b===ERR_TCP_NOT_CLOSE_SOCKET?(debug(" ---------------------------- process timeout cnt:"+u+", id:"+(g?g.processId:null)),u<TCP_MAX_RETRY_COUNT?(g.processId===CONV_ENGINE_MAP.LANG_SETTINGS_SPECIFIED&&
x(),l(g,0),u++):(A(),u=0)):b!==ERR_TCP_NOT_EXIST_QUEUE&&(debug(" ---------------------------- process no error: "+(g?g.processId:null)),u=0,c&&c(b));if(0<e.length){var d=e[0];!g||0>d.groupId||d.groupId!=g.groupId?(v=!1,t=-1,h()):h(!0)}else v=!1,t=-1}function y(b,c,a,d){a=new n(CONV_ENGINE_MAP.INITIALIZE,a,function(){var a=[CONV_ENGINE_MAP.INITIALIZE,getMonthTimeCategory(),b.toString(16)],a=JSON.stringify(a);webSocket.send(a,function(a){"-10001"==a[0]&&(x(),B(CONV_DIC_LOAD_FLG.ON,c,null,0));k(a,c)})});
l(a,d)}function w(b,c,a,d,m,e){if(q!==b||r!==c||s!==a)m=new n(CONV_ENGINE_MAP.LANG_SETTINGS_SPECIFIED,m,function(){if(q!==b||r!==c||s!==a){var m=JSON.stringify([CONV_ENGINE_MAP.LANG_SETTINGS_SPECIFIED,CONV_ENGINE_LANG_MODE_JAPANESE,b,c,a]);webSocket.send(m,function(m){q=b;r=c;s=a;k(m,d)})}else k()}),l(m,e)}function I(b,c,a,d){d=new n(CONV_ENGINE_MAP.ANALYZE,d,function(){var d=[CONV_ENGINE_MAP.ANALYZE,encodeURIComponent(b),""+c,""+c],d=JSON.stringify(d);webSocket.send(d,function(b){k(b,a)})});l(d)}
function J(b,c,a,d){d=new n(CONV_ENGINE_MAP.CONVERSION_MULTIPLE,d,function(){var d=[CONV_ENGINE_MAP.CONVERSION_MULTIPLE,"0",c+"",[encodeURIComponent(b)]],d=JSON.stringify(d);webSocket.send(d,function(b){k(b,a)})});l(d)}function C(b,c,a){a=new n(CONV_ENGINE_MAP.CONVERSION_EISUKANA,a,function(){var a=[CONV_ENGINE_MAP.CONVERSION_EISUKANA,encodeURIComponent(b)],a=JSON.stringify(a);webSocket.send(a,function(a){k(a,c)})});l(a)}function K(b,c,a,d,m,e,f){f=new n(CONV_ENGINE_MAP.LEARN,f,function(){var f=[CONV_ENGINE_MAP.LEARN,
b,c,a,encodeURIComponent(d),encodeURIComponent(m)],f=JSON.stringify(f);webSocket.send(f,function(a){k(a,e)})});l(f)}function L(b,c,a,d){d=new n(CONV_ENGINE_MAP.DELETE_WORD,d,function(){var d=JSON.stringify([CONV_ENGINE_MAP.DELETE_WORD,b,c]);webSocket.send(d,function(b){k(b,a)})});l(d)}function D(b,c,a,d){d=new n(CONV_ENGINE_MAP.DIC_SEARCH,d,function(){var d=JSON.stringify([CONV_ENGINE_MAP.DIC_SEARCH,b,CONV_DIC_MODE.USER,c]);webSocket.send(d,function(b){k(b,a)})});l(d)}function M(b,c,a,d){d=new n(CONV_ENGINE_MAP.ADD_WORD,
d,function(){var d=JSON.stringify([CONV_ENGINE_MAP.ADD_WORD,b,c,"",CONV_REGISTRY_DIC_CLASS.USER,CONV_RELATION_LEARNING.OFF]);webSocket.send(d,function(b){k(b,a)})});l(d)}function E(b,c,a){a=new n(CONV_ENGINE_MAP.CLEAR_DICTIONARY,a,function(){var a=JSON.stringify([CONV_ENGINE_MAP.CLEAR_DICTIONARY,b]);webSocket.send(a,function(a){k(a,c)})});l(a)}function F(b,c,a){a=new n(CONV_ENGINE_MAP.SAVE_DICTIONARY,a,function(){var a=JSON.stringify([CONV_ENGINE_MAP.SAVE_DICTIONARY,CONV_ENGINE_LANG_MODE_JAPANESE,
b]);webSocket.send(a,function(a){k(a,c)})});l(a)}function N(b,c){var a=new n(CONV_ENGINE_MAP.GET_DICTIONARY_MODE,c,function(){var a=JSON.stringify([CONV_ENGINE_MAP.GET_DICTIONARY_MODE]);webSocket.send(a,function(a){k(a,b)})});l(a)}function B(b,c,a,d){a=a?a:f();p(b,c,a,d);b=CONV_ANALYZE_OPTION_DEF.NO_TANBUN;b+=CONV_ANALYZE_OPTION_DEF.HEAD_CONV_ON;y(b,null,a,isClass("Number",d)?d+1:"undefined");h()}function p(b,c,a,d){a=a?a:f();var e=CONV_KEYBOARD_MODE.TEN;"undefined"!==typeof statusManager&&statusManager.isQwerty()&&
(e=CONV_KEYBOARD_MODE.FULL);var g=CONV_DIC_MODE.PREDICTION;"undefined"!==typeof statusManager&&statusManager.isMailDic()&&(g=CONV_DIC_MODE.MAIL_ADDRESS);w(g,e,b,c,a?a:f(),d);h()}function z(b,c,a){a=a?a:f();w(CONV_DIC_MODE.USER,CONV_KEYBOARD_MODE.FULL,b,null,a);y(CONV_ANALYZE_OPTION_DEF.NO,c,a);h()}var v=!1,g=null,t=-1,e=[],u=0;s=r=q="";var n=function(b,c,a){var d=-1;"undefined"!==typeof c&&(d=c);return{processId:b,groupId:d,method:a}};return{clearParam:x,analyze:function(b,c,a){var d=f();p(CONV_DIC_LOAD_FLG.OFF,
null,d);I(b,c,a,d);h()},conversionMultiple:function(b,c,a){var d=f();p(CONV_DIC_LOAD_FLG.OFF,null,d);J(b,c,a,d);h()},conversionEisukana:function(b,c){var a=f();p(CONV_DIC_LOAD_FLG.OFF,null,a);C(b,c,a);h()},learn:function(b,c,a,d,e,g){var k=f();p(CONV_DIC_LOAD_FLG.OFF,null,k);K(b,c,a,d,e,g,k);h()},deleteWord:function(b,c,a){var d=f();L(b,c,a,d);h()},saveDictionary:function(b,c){var a=f();F(b,c,a);h()},jpConvertEngineInit:B,jpConvertEngineModeInit:p,tracEngKana:function(b,c,a){a=a?a:f();C(b,c,a);h()},
tracEngKanaInit:function(b,c,a){a=a?a:f();var d=CONV_KEYBOARD_MODE.TEN;statusManager&&statusManager.isQwerty()&&(d=CONV_KEYBOARD_MODE.FULL);w(b,d,CONV_DIC_LOAD_FLG.OFF,c,a?a:f());h()},tracEngLearnDicAllDel:function(){var b=f();w(CONV_DIC_MODE.LEARNING,CONV_KEYBOARD_MODE.TEN,CONV_DIC_LOAD_FLG.OFF,null,b);y(CONV_ANALYZE_OPTION_DEF.NO,null,b);E(CONV_DIC_TYPE.LEARNING,null,b);F(CONV_DIC_TYPE.LEARNING,null,b);h()},initUserDic:z,addUserDic:function(b,c,a){var d=f();M(b,c,a,d);h()},searchUserDic:function(b,
c){var a=f();z(CONV_DIC_LOAD_FLG.OFF,null,a);D(b,CONV_SEARCH_ORDER.FREQUENCY,c,a);h()},getListUserDic:function(b,c){var a=f();b!=CONV_DIC_MODE.USER&&z(CONV_DIC_LOAD_FLG.ON,null,a);D("",CONV_SEARCH_ORDER.READING,c,a);h()},clearUserDic:function(b){var c=f();E(CONV_DIC_TYPE.USER,b,c);h()},getDicMode:function(b){var c=f();N(b,c);h()}}}();
var settingManager=function(){var b={};return{loadKeyboardSetting:function(a){selectDBData("setting",null,function(c){c.forEach(function(a){b[a.setKey]=a.value});a&&a()})},getSetting:function(a){return a in b?b[a]:null},setSetting:function(a,c){b[a]=c;setDBData("setting",{setKey:a,value:c})}}}();
var StatusManager=function(){var k=IME_TYPE.JP,f=LAYOUT_TYPE.TEN_KEY,m=KEY_MODE.NORMAL,b=new composingText,h="",l="",n=!1,p=!1;this.setImeType=function(a){k=a};this.getImeType=function(){return k};this.setLayoutType=function(a){f=a};this.getLayoutType=function(){return f};this.setKeyMode=function(a){m=a};this.getKeyMode=function(){return m};this.setInputType=function(a){l=a};this.getInputType=function(){return l};this.setInputMode=function(a){h=a};this.getInputMode=function(){return h};this.setCandidateUpdating=
function(a){n=a};this.getCandidateUpdating=function(){return n};this.setConnectionLearning=function(a){p=a};this.getConnectionLearning=function(){return p};this.getImeLayout=function(){var a="";switch(k){case IME_TYPE.DIGIT:a=IME_LAYOUTS.DIGIT;break;case IME_TYPE.NUMBER:a=IME_LAYOUTS.NUMBER;break;case IME_TYPE.TEL:a=IME_LAYOUTS.TEL;break;case IME_TYPE.JP:a=f==LAYOUT_TYPE.TEN_KEY?IME_LAYOUTS.JP:IME_LAYOUTS.ROMA;break;case IME_TYPE.EN:a=f==LAYOUT_TYPE.TEN_KEY?IME_LAYOUTS.EN:IME_LAYOUTS.EN_FULL;break;
case IME_TYPE.NUM:switch(f){case LAYOUT_TYPE.TEN_KEY:a=IME_LAYOUTS.NUM;break;case LAYOUT_TYPE.FULL_KEY:a=IME_LAYOUTS.NUM_FULL;break;case LAYOUT_TYPE.FULL_KEY_CAP:a=IME_LAYOUTS.NUM_FULL_CAP;break;case LAYOUT_TYPE.TEN_KEY_EM:a=IME_LAYOUTS.NUM_EM;break;case LAYOUT_TYPE.FULL_KEY_EM:a=IME_LAYOUTS.NUM_FULL_EM;break;case LAYOUT_TYPE.FULL_KEY_CAP_EM:a=IME_LAYOUTS.NUM_FULL_CAP_EM}break;default:debug("Error: Keyboard layout is undefined.")}return a};this.insertText=function(a){b.insertStrSegment(a,TEXT_LAYER0,
TEXT_LAYER1)};this.convertText=function(a){var c=b.getCursor(TEXT_LAYER1);if(0>=c)return!1;for(var e=Array(TEXT_MAX_CONVERT_LENGTH),g=TEXT_MAX_CONVERT_LENGTH,f=Math.min(c,TEXT_MAX_CONVERT_LENGTH),d=1;d<=f;d++)e[TEXT_MAX_CONVERT_LENGTH-d]=b.getStrSegment(TEXT_LAYER1,c-d),g--;for(;g<TEXT_MAX_CONVERT_LENGTH;){c="";for(d=g;d<TEXT_MAX_CONVERT_LENGTH;d++)c+=e[d].string;c=c.toLowerCase();d=null;if(mapRoma[a].hasOwnProperty(c))return d=mapRoma[a][c],a=[],1==d.length?a[0]=new StrSegment(d,e[g].from,e[TEXT_MAX_CONVERT_LENGTH-
1].to):(a[0]=new StrSegment(d.substring(0,d.length-1),e[g].from,e[TEXT_MAX_CONVERT_LENGTH-1].to-1),a[1]=new StrSegment(d.substring(d.length-1),e[TEXT_MAX_CONVERT_LENGTH-1].to,e[TEXT_MAX_CONVERT_LENGTH-1].to)),b.replaceStrSegment(TEXT_LAYER1,a,TEXT_MAX_CONVERT_LENGTH-g),!0;g++}return!1};this.replaceCursorForward=function(a){var c=b.getStrSegment(TEXT_LAYER0,b.getCursor(TEXT_LAYER0)-1);c.string=a;b.replaceStrSegment(TEXT_LAYER0,[c])};this.replaceTextTransform=function(a){var c=[],e=0;a.forEach(function(a){a=
new StrSegment(a[0],e,e+a[1].length-1);e=a.to+1;c.push(a)});b.setCursor(TEXT_LAYER2,b.size(TEXT_LAYER2));b.replaceStrSegment(TEXT_LAYER2,c,b.size(TEXT_LAYER2));b.setCursor(TEXT_LAYER2,1)};this.deleteCurrentText=function(){b.deleteCurrent(TEXT_LAYER1,!1)};this.deleteForwardText=function(){b.deleteForward(TEXT_LAYER1)};this.commitText=function(){var a=b.getCursor(TEXT_LAYER0);0<a&&b.deleteStrSegment(TEXT_LAYER0,0,a-1);0<b.size(TEXT_LAYER1)?b.setCursor(TEXT_LAYER2,1):b.setCursor(TEXT_LAYER2,0)};this.getText=
function(a){return b.getString(a)};this.getTextCursor=function(a){return b.getString(a,0,b.getCursor(a)-1)};this.clearText=function(){b.clear()};this.getCursor=function(a){return b.getCursor(a)};this.setCursor=function(a,c){b.setCursor(a,c)};this.cursorPrev=function(){b.moveCursor(TEXT_LAYER1,-1)};this.cursorNext=function(){b.moveCursor(TEXT_LAYER1,1)};this.cursorMoveEnd=function(){b.setCursor(TEXT_LAYER1,b.size(TEXT_LAYER1))};this.getDividePos=function(){var a=0;return a=k==IME_TYPE.JP?b.getCursor(TEXT_LAYER1):
b.getCursor(TEXT_LAYER0)};this.isInputTypePassword=function(){return l===INPUT_TYPE.PASSWORD};this.needInputMode=function(){switch(l){case INPUT_TYPE.TEXT:case INPUT_TYPE.PASSWORD:case INPUT_TYPE.NUMBER:return!0;default:return!1}};this.isInputModePhonetic=function(){return-1!=h.indexOf(INPUT_MODE.PHONETIC)};this.isInputModeUserDic=function(){return-1!=h.indexOf(INPUT_MODE.USR_DIC)};this.isInputModeDigit=function(){return-1!=h.indexOf(INPUT_MODE.DIGIT)};this.isInputModeNumeric=function(){return-1!=
h.indexOf(INPUT_MODE.NUMERIC)};this.isQwerty=function(){var a=!1;switch(f){case LAYOUT_TYPE.FULL_KEY:case LAYOUT_TYPE.FULL_KEY_CAP:case LAYOUT_TYPE.FULL_KEY_EM:case LAYOUT_TYPE.FULL_KEY_CAP_EM:a=!0}return a};this.isMailDic=function(){var a=!1;switch(l){case INPUT_TYPE.URL:case INPUT_TYPE.EMAIL:k===IME_TYPE.EN&&(a=!0)}return a};this.debugout=function(){b.debugout()}};
var composingText=function(){function q(a,b,c){var d="";if(a in h&&("undefined"===typeof b&&(b=0),"undefined"===typeof c&&(c=h[a].length-1),a=h[a],a.length>c))for(;0<=b&&b<=c;b++)d+=a[b].string;return d}function p(a,b,c,d){if(!(a>=TEXT_MAX_LAYER-1||0>a)){var e=a+1,f=h[e];if(0>=f.length)f.push(new StrSegment(q(a),0,h[a].length-1)),p(e,0,1,0);else{var g=b+(0==c?0:c-1),v=b+(0==d?0:d-1),k=f[f.length-1];if(k.to<b)k.to=g,k.string=q(a,k.from,k.to),p(e,f.length-1,1,1);else{for(var l=k=-1,n=0;n<f.length;n++){var m=
f[n];if(m.from>b)if(m.to<=v)0>k&&(k=n),l=n;else{l=n;break}else if(0==d&&m.from==b){k=n-1;l=n-1;break}else if(l=k=n,m.to>=v)break}0>k&&(l=k=0);b=c-d;m=f[k];c=m.to;for(n=d=k+1;n<=l;n++)m=f[d],c>m.to&&(c=m.to),f.splice(d,1);m.to=c<g?g:c+b;m.string=q(a,m.from,m.to);for(n=d;n<f.length;n++)m=f[n],m.from+=b,m.to+=b;p(e,k,1,l-k+1)}}}}function u(a,b,c,d){var e=h[a];if(0>c||c>e.length)c=e.length;if(0>d||d>e.length)d=e.length;for(var f=c;f<=d;f++)e.splice(c,1);for(f=b.length-1;0<=f;f--)e.splice(c,0,b[f]);p(a,
c,b.length,d-c+1)}function r(a,b,c,d){a=h[a];if(0!==d)for(var e=c+1;e<a.length;e++){var f=a[e];f.from-=d;f.to-=d}for(e=b;e<=c;e++)a.splice(b,1)}function s(a,b,c){var d=[-1,-1,-1],e=[-1,-1,-1],f=h[TEXT_LAYER1],g=h[TEXT_LAYER2];a==TEXT_LAYER2?(d[TEXT_LAYER2]=b,e[TEXT_LAYER2]=c,d[TEXT_LAYER1]=g[b].from,e[TEXT_LAYER1]=g[c].to,d[TEXT_LAYER0]=f[d[TEXT_LAYER1]].from,e[TEXT_LAYER0]=f[e[TEXT_LAYER1]].to):a==TEXT_LAYER1?(d[TEXT_LAYER1]=b,e[TEXT_LAYER1]=c,d[TEXT_LAYER0]=f[b].from,e[TEXT_LAYER0]=f[c].to):(d[TEXT_LAYER0]=
b,e[TEXT_LAYER0]=c);b=c-b+1;for(a=0;a<TEXT_MAX_LAYER;a++){if(0<=d[a])r(a,d[a],e[a],b);else{for(var f=c=-1,g=h[a],l=0;l<g.length;l++){var k=g[l];if(k.from>=d[a-1]&&k.from<=e[a-1]||k.to>=d[a-1]&&k.to<=e[a-1])0>d[a]&&(d[a]=l,c=k.from),e[a]=l,f=k.to;else if(k.from<=d[a-1]&&k.to>=e[a-1]){c=k.from;f=k.to;d[a]=l;e[a]=l;break}else if(k.from>e[a-1])break}if(c!=d[a-1]||f!=e[a-1]){r(a,d[a]+1,e[a],b);f-=b;e=[new StrSegment(q(a-1),c,f)];u(a,e,d[a],d[a]);break}else r(a,d[a],e[a],b)}b=e[a]-d[a]+1}}function t(a,
b){if(0==b)return 0;for(var c=0,d=h[a+1];c<d.length;c++){var e=d[c];if(e.from<=b&&b<=e.to)break}return c}function l(a,b){b>h[a].length&&(b=h[a].length);0>b&&(b=0);a==TEXT_LAYER0?(g[TEXT_LAYER0]=b,g[TEXT_LAYER1]=t(TEXT_LAYER0,b),g[TEXT_LAYER2]=t(TEXT_LAYER1,g[TEXT_LAYER1])):a==TEXT_LAYER1?(g[TEXT_LAYER2]=t(TEXT_LAYER1,b),g[TEXT_LAYER1]=b,g[TEXT_LAYER0]=0<b?h[TEXT_LAYER1][b-1].to+1:0):(g[TEXT_LAYER2]=b,g[TEXT_LAYER1]=0<b&&h[TEXT_LAYER2].length>=b?h[TEXT_LAYER2][b-1].to+1:0,g[TEXT_LAYER0]=0<g[TEXT_LAYER1]&&
h[TEXT_LAYER1].length>=g[TEXT_LAYER1]?h[TEXT_LAYER1][g[TEXT_LAYER1]-1].to+1:0);return b}function w(){for(var a=0;a<TEXT_MAX_LAYER;a++)h[a]=[],g[a]=0}var h=Array(TEXT_MAX_LAYER),g=Array(TEXT_MAX_LAYER);w();return{debugout:function(){for(var a=0;a<TEXT_MAX_LAYER;a++){debug("::: composingText["+a+"]");debug("       cur: "+g[a]);var b="";h[a].forEach(function(a){b+="("+a.string+","+a.from+","+a.to+")"});debug("       str: "+b)}},getStrSegment:function(a,b){if(a in h){var c=h[a];0>b&&(b=c.length-1);return b>=
c.length||0>b?null:c[b]}return null},getString:q,modifyUpper:p,insertStrSegment:function(a,b,c){if("undefined"!==typeof b)if(a=new StrSegment(a),"undefined"===typeof c){var d=g[b];h[b].splice(d,0,a);p(b,d,1,0);l(b,d+1)}else{h[b].splice(g[b],0,a);g[b]++;for(b+=1;b<=c;b++){var d=g[b-1]-1,e=new StrSegment(a.string,d,d),d=h[b];d.splice(g[b],0,e);g[b]++;for(e=g[b];e<d.length;e++){var f=d[e];f.from++;f.to++}}d=g[c];p(c,d-1,1,0);l(c,d)}},replaceStrSegment:function(a,b,c){"undefined"===typeof c&&(c=1);var d=
g[a];u(a,b,d-c,d-1);l(a,d+b.length-c)},deleteStrSegment:s,deleteCurrent:function(a,b){var c=g[a],d=h[a];!b&&0<c?(s(a,c-1,c-1),l(a,c-1)):b&&c<d.length&&(s(a,c,c),l(a,c));return d.length},deleteForward:function(a){var b=g[a],c=h[a];c.length>b&&(s(a,b,b),l(a,b));return c.length},getStringLayer:function(a){return a in h?h[a]:null},included:t,setCursor:l,moveCursor:function(a,b){return l(a,g[a]+b)},getCursor:function(a){return g[a]},size:function(a){return h[a].length},clear:w}},StrSegment=function(q,
p,u){var r=null,s=-1,t=-1;isClass("String",q)?r=q:isClass("Array")&&(r=q.join(""));"undefined"!==typeof p&&(s=p);"undefined"!==typeof u&&(t=u);return{string:r,from:s,to:t}};
var symbolsUtility=function(){return{loadUnicode6Emoji:function(c,a){var b=new XMLHttpRequest;b.open("GET","./js/data/"+c+".json",!0);try{b.responseType="json"}catch(e){}b.overrideMimeType("application/json; charset=utf-8");b.onreadystatechange=function(){if(4!==b.readyState)a&&a(c,null);else{var d="";if("json"==b.responseType)try{d=b.response}catch(e){}"object"!==typeof d?a&&a(c,null):a&&a(c,d)}};b.send(null)},convertUnicode6:function(c){var a="";c.split(",").forEach(function(b){a+=b.toString(16)});
return parseLabel(parseInt(a,16))}}};
var Keyboards={"jp-kanji":{label:"Japanese - Kanji",menuLabel:"Japanese - Kanji",imEngine:"jskanji",needsCandidatePanel:!0,disableAlternateLayout:!0,types:[INPUT_TYPE.TEXT],hidesSwitchKey:!0,width:5,keys:[[{value:"\u21ba",keyCode:IME_SPECIAL_KEY.BACK},{value:"\u3042",fontSize:"big",flick:"\u3042"},{value:"\u304b",fontSize:"big",flick:"\u304b"},{value:"\u3055",fontSize:"big",flick:"\u3055"},{value:"\u232b",keyCode:KeyEvent.DOM_VK_BACK_SPACE}],[{value:"\u2190",keyCode:IME_SPECIAL_KEY.PREVIOUS},{value:"\u305f",
fontSize:"big",flick:"\u305f"},{value:"\u306a",fontSize:"big",flick:"\u306a"},{value:"\u306f",fontSize:"big",flick:"\u306f"},{value:"\u2192",keyCode:IME_SPECIAL_KEY.NEXT}],[{value:"\u8a18\u53f7",keyCode:IME_SPECIAL_KEY.MARK},{value:"\u307e",fontSize:"big",flick:"\u307e"},{value:"\u3084",fontSize:"big",flick:"\u3084"},{value:"\u3089",fontSize:"big",flick:"\u3089"},{value:"&nbsp;",keyCode:IME_SPECIAL_KEY.SPACE,keyStyle:"special"}],[{value:"",keyCode:IME_SPECIAL_KEY.EN_LAYOUT,svg:"moji_ten_jp"},{value:"\u5927",
keyCode:IME_SPECIAL_KEY.CASE_CHANGE,fontSize:"big",flick:"\u5927"},{value:"\u308f",fontSize:"big",flick:"\u308f"},{value:"\u3001",fontSize:"big",flick:"\u3001"},{value:"\u21b5",keyCode:KeyEvent.DOM_VK_RETURN}]]},"jp-kanji-en":{label:"Japanese - Kanji - Alphabet",menuLabel:"Japanese - Kanji - Alphabet",imEngine:"jskanji",needsCandidatePanel:!0,disableAlternateLayout:!0,types:[INPUT_TYPE.TEXT,INPUT_TYPE.PASSWORD],hidesSwitchKey:!0,width:5,keys:[[{value:"\u21ba",keyCode:IME_SPECIAL_KEY.BACK},{value:".",
keyCode:46,fontSize:"big",flick:"."},{value:"a",keyCode:97,fontSize:"big",flick:"a"},{value:"d",keyCode:100,fontSize:"big",flick:"d"},{value:"\u232b",keyCode:KeyEvent.DOM_VK_BACK_SPACE}],[{value:"\u2190",keyCode:IME_SPECIAL_KEY.PREVIOUS},{value:"g",keyCode:103,fontSize:"big",flick:"g"},{value:"j",keyCode:106,fontSize:"big",flick:"j"},{value:"m",keyCode:109,fontSize:"big",flick:"m"},{value:"\u2192",keyCode:IME_SPECIAL_KEY.NEXT}],[{value:"\u8a18\u53f7",keyCode:IME_SPECIAL_KEY.MARK},{value:"p",keyCode:112,
fontSize:"big",flick:"p"},{value:"t",keyCode:116,fontSize:"big",flick:"t"},{value:"w",keyCode:119,fontSize:"big",flick:"w"},{value:"&nbsp;",keyCode:IME_SPECIAL_KEY.SPACE,keyStyle:"special"}],[{value:"",keyCode:IME_SPECIAL_KEY.NUM_LAYOUT,svg:"moji_ten_en"},{value:"A\u21d4a",keyCode:IME_SPECIAL_KEY.CASE_CHANGE},{value:"-",keyCode:45,fontSize:"big",flick:"-"},{value:",",keyCode:44,fontSize:"big",flick:","},{value:"\u21b5",keyCode:KeyEvent.DOM_VK_RETURN}]]},"jp-kanji-number":{label:"Japanese - Kanji - Number",
menuLabel:"Japanese - Kanji - Number",imEngine:"jskanji",needsCandidatePanel:!1,types:[INPUT_TYPE.TEXT,INPUT_TYPE.PASSWORD],disableAlternateLayout:!0,hidesSwitchKey:!0,width:5,keys:[[{value:"\u534a\u5168",keyCode:IME_SPECIAL_KEY.H2Z},{value:"1",flick:"1",fontSize:"big"},{value:"2",flick:"2",fontSize:"big"},{value:"3",flick:"3",fontSize:"big"},{value:"\u232b",keyCode:KeyEvent.DOM_VK_BACK_SPACE}],[{value:"\u2190",keyCode:IME_SPECIAL_KEY.PREVIOUS},{value:"4",flick:"4",fontSize:"big"},{value:"5",flick:"5",
fontSize:"big"},{value:"6",flick:"6",fontSize:"big"},{value:"\u2192",keyCode:IME_SPECIAL_KEY.NEXT}],[{value:"\u8a18\u53f7",keyCode:IME_SPECIAL_KEY.MARK},{value:"7",flick:"7",fontSize:"big"},{value:"8",flick:"8",fontSize:"big"},{value:"9",flick:"9",fontSize:"big"},{value:"&nbsp;",keyCode:IME_SPECIAL_KEY.SPACE,keyStyle:"special"}],[{value:"",keyCode:IME_SPECIAL_KEY.BASIC_LAYOUT,svg:"moji_ten_num"},{value:"*",flick:"*",fontSize:"big"},{value:"0",flick:"0",fontSize:"big"},{value:"#",flick:"#",fontSize:"big"},
{value:"\u21b5",keyCode:KeyEvent.DOM_VK_RETURN}]]},"jp-kanji-number-em":{label:"Japanese - Kanji - Number - Em",menuLabel:"Japanese - Kanji - Number - Em",imEngine:"jskanji",needsCandidatePanel:!1,types:[INPUT_TYPE.TEXT,INPUT_TYPE.PASSWORD],disableAlternateLayout:!0,hidesSwitchKey:!0,width:5,keys:[[{value:"\u534a\u5168",keyCode:IME_SPECIAL_KEY.Z2H},{value:"\uff11",flick:"\uff11",fontSize:"big"},{value:"\uff12",flick:"\uff12",fontSize:"big"},{value:"\uff13",flick:"\uff13",fontSize:"big"},{value:"\u232b",
keyCode:KeyEvent.DOM_VK_BACK_SPACE}],[{value:"\u2190",keyCode:IME_SPECIAL_KEY.PREVIOUS},{value:"\uff14",flick:"\uff14",fontSize:"big"},{value:"\uff15",flick:"\uff15",fontSize:"big"},{value:"\uff16",flick:"\uff16",fontSize:"big"},{value:"\u2192",keyCode:IME_SPECIAL_KEY.NEXT}],[{value:"\u8a18\u53f7",keyCode:IME_SPECIAL_KEY.MARK},{value:"\uff17",flick:"\uff17",fontSize:"big"},{value:"\uff18",flick:"\uff18",fontSize:"big"},{value:"\uff19",flick:"\uff19",fontSize:"big"},{value:"&nbsp;",keyCode:IME_SPECIAL_KEY.SPACE,
keyStyle:"special"}],[{value:"",keyCode:IME_SPECIAL_KEY.BASIC_LAYOUT,svg:"moji_ten_num"},{value:"\uff0a",flick:"\uff0a",fontSize:"big"},{value:"\uff10",flick:"\uff10",fontSize:"big"},{value:"\uff03",flick:"\uff03",fontSize:"big"},{value:"\u21b5",keyCode:KeyEvent.DOM_VK_RETURN}]]},"jp-kanji-romaji":{label:"Japanese - Kanji",menuLabel:"Japanese - Kanji",imEngine:"jskanji",needsCandidatePanel:!0,disableAlternateLayout:!0,types:[INPUT_TYPE.TEXT],hidesSwitchKey:!0,width:10,typeInsensitive:!0,keys:[[{value:"q",
altNote:"1"},{value:"w",altNote:"2"},{value:"e",altNote:"3"},{value:"r",altNote:"4"},{value:"t",altNote:"5"},{value:"y",altNote:"6"},{value:"u",altNote:"7"},{value:"i",altNote:"8"},{value:"o",altNote:"9"},{value:"p",altNote:"0"}],[{value:"a"},{value:"s"},{value:"d"},{value:"f"},{value:"g"},{value:"h"},{value:"j"},{value:"k"},{value:"l"},{value:"\u30fc",altNote:"\u00a8"}],[{value:"\u8a18\u53f7",keyCode:IME_SPECIAL_KEY.MARK,ratio:1.5},{value:"z"},{value:"x"},{value:"c"},{value:"v"},{value:"b"},{value:"n"},
{value:"m"},{value:"\u232b",ratio:1.5,keyCode:KeyEvent.DOM_VK_BACK_SPACE}],[{value:"",keyCode:IME_SPECIAL_KEY.EN_LAYOUT,ratio:1.5,svg:"moji_full_jp"},{value:"\u3001",altNote:"!"},{value:"&nbsp;",ratio:3,keyCode:KeyboardEvent.DOM_VK_SPACE},{value:"\u3002",altNote:"?"},{value:"\u2190",keyCode:IME_SPECIAL_KEY.PREVIOUS},{value:"\u2192",keyCode:IME_SPECIAL_KEY.NEXT},{value:"\u21b5",ratio:1.5,keyCode:KeyEvent.DOM_VK_RETURN}]],alt:{q:"\uff11",w:"\uff12",e:"\uff13",r:"\uff14",t:"\uff15",y:"\uff16",u:"\uff17",
i:"\uff18",o:"\uff19",p:"\uff10","\u30fc":"\uff0f\uff06\uff0b\uff1b\u201d\u2019\u2212\uff1a\uff08\uff09\uff20","\u3001":"\uff01","\u3002":"\uff1f"}},"jp-kanji-en-full":{label:"Japanese - Kanji - Alphabet",menuLabel:"Japanese - Kanji - Alphabet",imEngine:"jskanji",needsCandidatePanel:!0,disableAlternateLayout:!0,types:[INPUT_TYPE.TEXT,INPUT_TYPE.PASSWORD],hidesSwitchKey:!0,width:10,typeInsensitive:!0,keys:[[{value:"q",altNote:"1"},{value:"w",altNote:"2"},{value:"e",altNote:"3"},{value:"r",altNote:"4"},
{value:"t",altNote:"5"},{value:"y",altNote:"6"},{value:"u",altNote:"7"},{value:"i",altNote:"8"},{value:"o",altNote:"9"},{value:"p",altNote:"0"}],[{value:"a",altNote:"\u00a8"},{value:"s",altNote:"\u00df"},{value:"d"},{value:"f"},{value:"g"},{value:"h"},{value:"j"},{value:"k"},{value:"l"},{value:"@",altNote:"\u00a8"}],[{value:"\u21ea",ratio:1.5,keyCode:KeyEvent.DOM_VK_CAPS_LOCK},{value:"z"},{value:"x"},{value:"c",altNote:"\u00e7"},{value:"v"},{value:"b"},{value:"n",altNote:"\u00f1"},{value:"m"},{value:"\u232b",
ratio:1.5,keyCode:KeyEvent.DOM_VK_BACK_SPACE}],[{value:"",keyCode:IME_SPECIAL_KEY.NUM_LAYOUT,ratio:1.5,svg:"moji_full_en"},{value:",",altNote:"!"},{value:"&nbsp;",keyCode:KeyboardEvent.DOM_VK_SPACE,ratio:3},{value:".",altNote:"?"},{value:"\u2190",keyCode:IME_SPECIAL_KEY.PREVIOUS},{value:"\u2192",keyCode:IME_SPECIAL_KEY.NEXT},{value:"\u21b5",ratio:1.5,keyCode:KeyEvent.DOM_VK_RETURN}]],alt:{q:"1",w:"2",e:"3\u00e8\u00e9\u00ea\u00eb\u0113",r:"4",t:"5",y:"6",u:"7\u00fb\u00fc\u00f9\u00fa\u016b",i:"8\u00ee\u00ef\u00ed\u012b\u00ec",
o:"9\u00f4\u00f6\u00f2\u00f3\u0153\u00f8\u014d\u00f5",p:"0",a:"\u00e0\u00e1\u00e2\u00e4\u00e6\u00e3\u00e5\u0101",s:"\u00df","@":"/&+;\"'-:()",c:"\u00e7",n:"\u00f1",",":"!",".":"?"}},"jp-kanji-number-full":{label:"Japanese - Kanji - Number",menuLabel:"Japanese - Kanji - Number",imEngine:"jskanji",needsCandidatePanel:!1,disableAlternateLayout:!0,types:[INPUT_TYPE.TEXT,INPUT_TYPE.PASSWORD],hidesSwitchKey:!0,width:10,typeInsensitive:!0,keys:[[{value:"1"},{value:"2"},{value:"3"},{value:"4"},{value:"5"},
{value:"6"},{value:"7"},{value:"8"},{value:"9"},{value:"0"}],[{value:"@"},{value:"#"},{value:"%"},{value:"&"},{value:"*"},{value:"+"},{value:"-"},{value:"="},{value:"["},{value:"]"}],[{value:"\u21ea",ratio:1.5,keyCode:IME_SPECIAL_KEY.CAPSLOCK},{value:"/"},{value:"("},{value:")"},{value:":"},{value:";"},{value:"!"},{value:"?"},{value:"\u232b",ratio:1.5,keyCode:KeyEvent.DOM_VK_BACK_SPACE}],[{value:"",keyCode:IME_SPECIAL_KEY.BASIC_LAYOUT,ratio:1.5,svg:"moji_full_num"},{value:"\u534a\u5168",keyCode:IME_SPECIAL_KEY.H2Z,
ratio:1.5},{value:"&nbsp;",ratio:3.5,keyCode:KeyboardEvent.DOM_VK_SPACE},{value:"\u2190",keyCode:IME_SPECIAL_KEY.PREVIOUS},{value:"\u2192",keyCode:IME_SPECIAL_KEY.NEXT},{value:"\u21b5",ratio:1.5,keyCode:KeyEvent.DOM_VK_RETURN}]]},"jp-kanji-number-full-cap":{label:"Japanese - Kanji - Number - Cap",menuLabel:"Japanese - Kanji - Number - Cap",imEngine:"jskanji",needsCandidatePanel:!1,disableAlternateLayout:!0,types:[INPUT_TYPE.TEXT,INPUT_TYPE.PASSWORD],hidesSwitchKey:!0,width:10,typeInsensitive:!0,keys:[[{value:"1"},
{value:"2"},{value:"3"},{value:"4"},{value:"5"},{value:"6"},{value:"7"},{value:"8"},{value:"9"},{value:"0"}],[{value:"~"},{value:"^"},{value:"&#165;",keyCode:DOM_KEYCODE_HARF_YEN},{value:"$"},{value:'"'},{value:"+"},{value:"_"},{value:"\\"},{value:"{"},{value:"}"}],[{value:"\u21ea",ratio:1.5,keyCode:IME_SPECIAL_KEY.CAPSLOCK},{value:"|"},{value:"<"},{value:">"},{value:"`"},{value:"'"},{value:","},{value:"."},{value:"\u232b",ratio:1.5,keyCode:KeyEvent.DOM_VK_BACK_SPACE}],[{value:"",keyCode:IME_SPECIAL_KEY.BASIC_LAYOUT,
ratio:1.5,svg:"moji_full_num"},{value:"\u534a\u5168",keyCode:IME_SPECIAL_KEY.H2Z,ratio:1.5},{value:"&nbsp;",ratio:3.5,keyCode:KeyboardEvent.DOM_VK_SPACE},{value:"\u2190",keyCode:IME_SPECIAL_KEY.PREVIOUS},{value:"\u2192",keyCode:IME_SPECIAL_KEY.NEXT},{value:"\u21b5",ratio:1.5,keyCode:KeyEvent.DOM_VK_RETURN}]]},"jp-kanji-number-full-em":{label:"Japanese - Kanji - Number - Em",menuLabel:"Japanese - Kanji - Number - Em",imEngine:"jskanji",needsCandidatePanel:!1,disableAlternateLayout:!0,types:[INPUT_TYPE.TEXT,
INPUT_TYPE.PASSWORD],hidesSwitchKey:!0,width:10,typeInsensitive:!0,keys:[[{value:"\uff11"},{value:"\uff12"},{value:"\uff13"},{value:"\uff14"},{value:"\uff15"},{value:"\uff16"},{value:"\uff17"},{value:"\uff18"},{value:"\uff19"},{value:"\uff10"}],[{value:"\uff20"},{value:"\uff03"},{value:"\uff05"},{value:"\uff06"},{value:"\uff0a"},{value:"\uff0b"},{value:"\u30fc"},{value:"\uff1d"},{value:"\u300c"},{value:"\u300d"}],[{value:"\u21ea",ratio:1.5,keyCode:IME_SPECIAL_KEY.CAPSLOCK},{value:"\uff0f"},{value:"\uff08"},
{value:"\uff09"},{value:"\uff1a"},{value:"\uff1b"},{value:"\uff01"},{value:"\uff1f"},{value:"\u232b",ratio:1.5,keyCode:KeyEvent.DOM_VK_BACK_SPACE}],[{value:"",keyCode:IME_SPECIAL_KEY.BASIC_LAYOUT,ratio:1.5,svg:"moji_full_num"},{value:"\u534a\u5168",keyCode:IME_SPECIAL_KEY.Z2H,ratio:1.5},{value:"&nbsp;",ratio:3.5,keyCode:KeyboardEvent.DOM_VK_SPACE},{value:"\u2190",keyCode:IME_SPECIAL_KEY.PREVIOUS},{value:"\u2192",keyCode:IME_SPECIAL_KEY.NEXT},{value:"\u21b5",ratio:1.5,keyCode:KeyEvent.DOM_VK_RETURN}]]},
"jp-kanji-number-full-cap-em":{label:"Japanese - Kanji - Number - Cap - Em",menuLabel:"Japanese - Kanji - Number - Cap - Em",imEngine:"jskanji",needsCandidatePanel:!1,disableAlternateLayout:!0,types:[INPUT_TYPE.TEXT,INPUT_TYPE.PASSWORD],hidesSwitchKey:!0,width:10,typeInsensitive:!0,keys:[[{value:"\uff11"},{value:"\uff12"},{value:"\uff13"},{value:"\uff14"},{value:"\uff15"},{value:"\uff16"},{value:"\uff17"},{value:"\uff18"},{value:"\uff19"},{value:"\uff10"}],[{value:"\uff5e"},{value:"\uff3e"},{value:"\uffe5"},
{value:"\uff04"},{value:"\u201d"},{value:"\u00b1"},{value:"\uff3f"},{value:"\uff3c"},{value:"\uff5b"},{value:"\uff5d"}],[{value:"\u21ea",ratio:1.5,keyCode:IME_SPECIAL_KEY.CAPSLOCK},{value:"\uff5c"},{value:"\uff1c"},{value:"\uff1e"},{value:"\u2018"},{value:"\u2019"},{value:"\uff0c"},{value:"\uff0e"},{value:"\u232b",ratio:1.5,keyCode:KeyEvent.DOM_VK_BACK_SPACE}],[{value:"",keyCode:IME_SPECIAL_KEY.BASIC_LAYOUT,ratio:1.5,svg:"moji_full_num"},{value:"\u534a\u5168",keyCode:IME_SPECIAL_KEY.Z2H,ratio:1.5},
{value:"&nbsp;",ratio:3.5,keyCode:KeyboardEvent.DOM_VK_SPACE},{value:"\u2190",keyCode:IME_SPECIAL_KEY.PREVIOUS},{value:"\u2192",keyCode:IME_SPECIAL_KEY.NEXT},{value:"\u21b5",ratio:1.5,keyCode:KeyEvent.DOM_VK_RETURN}]]}};
var IMERender=function(){function N(a,c){L();for(var b=document.getElementById("keyboard-symbol-candidate-tabs").getElementsByClassName("swipe-slide"),d=0,e=b.length;d<e;d++)if(a){var k=b[d].getAttribute("name"),h=document.getElementById(k);k==a?(h.style.display="block",h.style.visibility="visible",b[d].classList.add("swipe-active"),h.childNodes[0].scrollLeft=0):(h.style.display="none",h.style.visibility="hidden",b[d].classList.remove("swipe-active"))}a?(b=document.getElementById(a).getElementsByTagName("li"),
document.getElementById(b[0].getAttribute("name")),c?O(b[0].getAttribute("name")):O(b[1].getAttribute("name"))):(b=b[0].getAttribute("name"),N(b,c))}function O(a){debug("::: categoryJumpTabs :::"+a);for(var c=document.getElementById(a).parentNode.id,c=document.getElementById(c),b=c.getElementsByTagName("li"),d=!1,e=0,k=D.length;e<k;e++)if(D[e].boxID===a){D[e].scroll||(d=!0);D[e].scroll=!0;break}if(a)for(e=0,k=b.length;e<k;e++){var h=b[e].getAttribute("name"),g=document.getElementById(h);h==a?(g.style.display=
"block",g.style.visibility="visible",b[e].classList.add("swipe-active"),c.childNodes[0].scrollLeft+=b[e].getBoundingClientRect().left-window.innerWidth/2+b[e].offsetWidth/2,d&&(g.scrollTop=0)):(g.style.display="none",g.style.visibility="hidden",b[e].classList.remove("swipe-active"))}}function P(a,c,b,d){if(a=document.getElementById(a+"_history")){for(var e=F(a,-1,c,!1,CANDIDATE_TYPE.SYMBOL);a.firstChild;)a.removeChild(a.firstChild);a.appendChild(e);b&&0==c.length&&(a.textContent=t("none_history"))}d&&
d()}function U(a){var c=document.getElementById("keyboard-candidate-panel"),b=null;c&&(c=c.getElementsByTagName("span"),0==a?c[c.length-1].classList.remove("candidateSelected"):c[a-1].classList.remove("candidateSelected"),b=c[a],b.classList.add("candidateSelected"));return b}function Q(a){a?-1!==KeyboardEventHandler.getOrientation().indexOf("landscape")?IMERender.ime.classList.add("symbolLandscape"):IMERender.ime.classList.add("symbolPortrait"):(IMERender.ime.classList.remove("symbolLandscape"),IMERender.ime.classList.remove("symbolPortrait"))}
function M(a){var c=MAX_MORE_CANDIDATE_ROW_NUM;a&&IME_SYMBOL_TAB_NAMES.EMOJI in a&&(c=MAX_MORE_SYMBOL_CANDIDATE_EMOJI_ROW_NUM);-1!==KeyboardEventHandler.getOrientation().indexOf("landscape")&&(c=Math.ceil(c*MAX_UNIT_NUM_PORTRAIT/MAX_UNIT_NUM_LANDSCAPE));return c}function R(a,c,b){a.dataset.truncated&&(H&&(clearTimeout(H),H=null),a.addEventListener("scroll",function(){aa(this,b)}))}function aa(a,c){if(!H&&0!=a.scrollTop&&a.clientHeight+a.scrollTop>a.scrollHeight-1.5*a.clientHeight){var b=parseInt(a.dataset.candidateIndicator);
b<c.length&&(H=setTimeout(function(){var d={};-1!=a.id.indexOf(IME_SYMBOL_TAB_NAMES.EMOJI)&&(d[IME_SYMBOL_TAB_NAMES.EMOJI]=!0);var e=M(d),d=c.slice(b,b+(e+1)*B+1);e||(e=-1);d&&a.appendChild(F(a,e,d,!1,CANDIDATE_TYPE.SYMBOL));clearTimeout(H);H=null},0))}}var S,V,W,x,G=10,B=MAX_UNIT_NUM_PORTRAIT,C,I,D,t,ba=new symbolsUtility,H=null,X=[],ca=function(a,c,b){b=b||{};G=c.width||10;var d=document.getElementById("keyboard").clientWidth,e=Math.floor(d/G),k=d-e*G,h=b.inputFlick,g=b.imeType,l=!1,l=-1!=c.types.indexOf("number")||
-1!=c.types.indexOf("tel")||-1!=c.types.indexOf("digit");c.upperCase=c.upperCase||{};var f=document.createDocumentFragment();c.keys.forEach(function(a,d){var q=document.createElement("div"),m=0;q.classList.add("keyboard-row");q.classList.add("row"+d);d===c.keys.length-1&&q.classList.add("keyboard-last-row");a.forEach(function(f,y){var z=f.value,r=f.altNote;if(!f.hidden||-1===f.hidden.indexOf(b.inputType))if(!f.visible||-1!==f.visible.indexOf(b.inputType)){b.uppercase&&(z=S(f),r&&(r={keyCode:r.charCodeAt(0),
value:r},r=S(r)));var t=f.keyCode||z.charCodeAt(0),s="";!V(f)&&"special"!==f.keyStyle||l?c.keyClassName&&(s=c.keyClassName):s="special-key";f.className&&(s+=" "+f.className);var A=f.ratio||1;m+=A;A=Math.floor(e*A);if(0===y||y===a.length-1)A+=Math.floor(k/2);var u=[{key:"row",value:d}];u.push({key:"column",value:y});u.push({key:"keycode",value:t});u.push({key:"label",value:z});f.compositeKey&&u.push({key:"compositekey",value:f.compositeKey});f.flick&&(h||g!=IME_TYPE.NUM)&&(u.push({key:"flick",value:f.flick.charCodeAt(0)}),
s+=" flickOnFont");t=[];f.disabled&&t.push({key:"disabled",value:"true"});f.noUpper&&(s+=" noUpper");f.fontSize&&"big"===f.fontSize&&(g!=IME_TYPE.NUM||h)&&(s+=" fontSize-big");f.svg&&(s+=" "+f.svg);q.appendChild(Y(z,s,A+"px",u,r,t))}});q.dataset.layoutWidth=m;f.appendChild(q)});a.innerHTML="";a.appendChild(f)},T=function(a){var c=document.getElementById("keyboard-candidate-panel");if(c){var b="2";-1!==KeyboardEventHandler.getOrientation().indexOf("landscape")&&(b="1");IMERender.ime.setAttribute("number-lines",
b);if(a){IMERender.ime.classList.remove("candidate-panel");IMERender.ime.classList.add("full-candidate-panel");a=parseInt(c.dataset.scroll);var d=parseInt(c.dataset.rowHeight);c.scrollTop=a+d>c.clientHeight?a+d*parseInt(b)-c.clientHeight:0}else IMERender.ime.classList.remove("full-candidate-panel"),""!=c.innerHTML?IMERender.ime.classList.add("candidate-panel"):IMERender.ime.classList.remove("candidate-panel"),c.scrollTop=c.dataset.scroll;c.scrollLeft=0}},Z=function(a,c){var b=document.getElementById("keyboard-candidate-panel"),
d=document.getElementById("keyboard-candidate-panel-toggle-panel");if(b){b.dataset.candidateIndicator=0;var e="2",k=b.offsetHeight;-1!==KeyboardEventHandler.getOrientation().indexOf("landscape")&&(e="1",k=b.clientHeight);b.dataset.rowHeight=(k+1)/e;b.innerHTML="";b.scrollLeft=0;b.scrollTop=b.dataset.scroll=0;k=document.createDocumentFragment();d.style.display="none";k=F(b,e-1,a,!0,CANDIDATE_TYPE.PREDICT);b.appendChild(k);T(!1);d=0;0<b.childNodes.length&&(d=b.childNodes[0].clientHeight,b.dataset.rowHeight=
d);b.scrollTop=d*parseInt(b.dataset.scroll)}c&&c()},F=function(a,c,b,d,e){var k=document.getElementById("keyboard"),h=document.getElementById("keyboard-candidate-panel-toggle-panel"),g=document.createDocumentFragment();if(0==b.length)return a.dataset.rowCount=0,g;var l=document.createElement("div");l.classList.add("candidate-row");d?(l.classList.add("candidate-row-first"),l.dataset.maxUnit=B-1):l.dataset.maxUnit=B;var f=document.createElement("span");f.classList.add("keyboard-candidate-width-check");
f.style.visibility="hidden";document.body.appendChild(f);var n=document.defaultView.getComputedStyle(f,""),n=parseInt(n.paddingLeft,10)+parseInt(n.paddingRight,10);f.style.minWidth=C-n+"px";n=document.createElement("span");n.classList.add("tmp-candidate");document.body.appendChild(n);var p=document.defaultView.getComputedStyle(n,""),q=parseInt(p.paddingLeft,10)+parseInt(p.paddingRight,10),m=p=0,w=-1,y=a.dataset.scroll?parseInt(a.dataset.scroll):0;0>c&&(c=Number.Infinity);var t=2;-1!==KeyboardEventHandler.getOrientation().indexOf("landscape")&&
(t=1);"selected"in b&&(w=b.selected);for(var r=0,J=b.length;r<J;r++){var s,A,u=-1,x=-1,D=-1,E;if(!b[r])break;"string"===typeof b[r]?A=s=b[r]:(s=b[r][0],A=b[r][1],b[r][2]&&(CANDIDATE_TYPE.SYMBOL!=e?u=b[r][2]:E=b[r][2]),b[r][3]&&(x=b[r][3]),b[r][4]&&(D=b[r][4]));f.textContent=s;var v=document.createElement("span");v.textContent=s;1===s.length&&(32===s.charCodeAt(0)||160===s.charCodeAt(0)?(v.innerHTML="&nbsp;",v.classList.add("half_space")):"\u3000"===s&&v.classList.add("full_space"));v.dataset.selection=
!0;v.dataset.data=A;v.dataset.index=u;v.dataset.learnflg=x;v.dataset.convlen=D;E&&(v.dataset.tab=E);E===IME_SYMBOL_TAB_NAMES.EMOJI&&v.classList.add(E);s=Math.ceil(f.offsetWidth/C);u=s*C;A=B;x=window.innerWidth;d&&0==m&&0==r&&(A=B-1,x=A*C);s>A&&(s=A);u=u>x?x-2:u-q;v.style.minWidth=C-q+"px";v.style.width=u+"px";v.dataset.unit=s;p+=s;u=!1;0==m&&d&&p==A&&r!=J-1&&(u=!0);if(p>A||u){if(0==r&&0==m&&d){l.appendChild(v);continue}if(m>=c){0<r&&r<=w&&(y+=parseInt(a.dataset.rowHeight));break}g.appendChild(l);
m++;l=document.createElement("div");l.classList.add("candidate-row");p=s;l.dataset.maxUnit=A}l.appendChild(v)}r!=J?a.dataset.truncated=!0:delete a.dataset.truncated;a.dataset.rowCount=m+1;a.dataset.candidateIndicator=parseInt(a.dataset.candidateIndicator)+r;a.dataset.scroll=y;g.appendChild(l);c=m<t&&r==J?!0:!1;if(d&&r!=J){if(d=g.childNodes[0])v=document.createElement("div"),v.style="pointer-events:none;",d.appendChild(v);h.style.display="block"}h=g.childNodes.length;for(d=0;d<h;d++)if(r!=J||d!=h-
1){v=0;b=g.childNodes[d];e=b.getElementsByTagName("span");l=0;for(E=e.length-1;l<E;l++)v+=parseInt(e[l].dataset.unit);if(e=e[e.length-1])l=parseInt(b.dataset.maxUnit),E=k.clientWidth,c||l==B||(E=parseInt(b.dataset.maxUnit)*C),e.style.width=E-v*C-q+"px"}if(r==J)for(h=g.lastChild,d=0,k=h.childNodes.length;d<k;d++)v=h.childNodes[d],v.classList.add("candidate-row-last"),d==k-1&&p!=B&&v.classList.add("candidate-row-last-child-last");document.body.removeChild(f);document.body.removeChild(n);f=a.getElementsByClassName("candidate-row-ellipsis");
(f=0<f.length?f[0]:null)?f.parentNode.removeChild(f):(f=document.createElement("div"),f.classList.add("candidate-row-ellipsis"),f.textContent="\u2026");a.dataset.truncated&&g.appendChild(f);return g},$=function(a){var c,b=document.getElementById("keyboard"),d=document.getElementById("keyboard-candidate-panel");c=document.getElementById("keyboard-symbol-candidate-panel");var e="2";-1!==KeyboardEventHandler.getOrientation().indexOf("landscape")&&(e="1");b.setAttribute("number-lines",e);c&&(c.setAttribute("number-lines",
e),c.innerHTML="",Q(!1));-1!==KeyboardEventHandler.getOrientation().indexOf("portrait")?(c=window.innerWidth/32,document.documentElement.style.fontSize=c+"px",b.classList.remove("landscape"),b.classList.add("portrait"),d&&(d.classList.remove("landscape"),d.classList.add("portrait"))):(c=window.innerWidth/64,document.documentElement.style.fontSize=c+"px",b.classList.remove("portrait"),b.classList.add("landscape"),d&&(d.classList.remove("portrait"),d.classList.add("landscape")));X=[];if(a){[].forEach.call(b.querySelectorAll(".visual-wrapper[style]"),
function(a){a.style.width=""});G=a.width||10;c=b.clientWidth;d=Math.floor(c/G);c-=d*G;for(var k,h,e=document.querySelectorAll(".keyboard-row"),g=0;k=e[g];g+=1){var l=parseInt(k.dataset.layoutWidth,10);h=k.childNodes;for(var f=0,n;n=h[f];f+=1){k=a.keys[g][f].ratio||1;var p=Math.floor(d*k);if(0===f||f===h.length-1)p+=Math.floor(c/2);n.style.width=p+"px";p=n.querySelector(".visual-wrapper");l===G||0!==f&&f!==h.length-1||(p.style.width=p.offsetWidth+"px",n.style.width=Math.floor(d*(k+(G-l)/2))+"px",n.classList.add("float-key-"+
(0===f?"first":"last")))}for(f=0;n=h[f];f+=1)p=n.querySelector(".visual-wrapper"),X.push({code:n.dataset.keycode|0,x:p.offsetLeft,y:p.offsetTop,width:p.clientWidth,height:p.clientHeight})}B=-1!==KeyboardEventHandler.getOrientation().indexOf("portrait")?MAX_UNIT_NUM_PORTRAIT:MAX_UNIT_NUM_LANDSCAPE;C=Math.floor(b.clientWidth/B);[].forEach.call(b.querySelectorAll(".candidate-row"),function(a,b){for(var c=a.children,d=0,e=0,f=c.length;e<f;e++){var g=(strWidthLength(c[e].textContent)>>1)+1,h=g*C-2;h>window.innerWidth?
h=window.innerWidth-2:e==f-1&&(h=(B-d)*C-2);c[e].style.width=h+"px";d+=g}});document.getElementsByClassName("keyboard-container");var d=document.getElementsByClassName("keyboard-row"),q=Math.floor(b.clientHeight/a.keys.length);[].forEach.call(d,function(a,b){a.style.height=q+"px"});L()}},L=function(){for(var a=0,c=D.length;a<c;a++)D[a].scroll=!1},da=function(){var a=document.createElement("div");a.id="keyboard-candidate-panel";I&&a.classList.add(I);return a},ea=function(){var a=document.createElement("div");
a.id="keyboard-symbol-candidate-panel";I&&a.classList.add(I);-1!==KeyboardEventHandler.getOrientation().indexOf("portrait")?a.classList.add("portrait"):a.classList.add("landscape");return a},fa=function(){var a=document.createElement("span");a.id="keyboard-candidate-panel-toggle-button";a.dataset.keycode=IME_SPECIAL_KEY.TOGGLE_CANDIDATE_PANEL;var c=document.createElement("div");c.id="keyboard-candidate-panel-toggle-panel";c.dataset.keycode=IME_SPECIAL_KEY.TOGGLE_CANDIDATE_PANEL;c.appendChild(a);return c},
Y=function(a,c,b,d,e,k){var h;e&&(h=document.createElement("div"),h.className="alt-note",h.textContent=e);var g=document.createElement("button");g.className="keyboard-key "+c;g.setAttribute("style","width: "+b+";");k&&k.forEach(function(a){g.setAttribute(a.key,a.value)});d.forEach(function(a){g.dataset[a.key]=a.value});g.dataset.keycode!=KeyboardEvent.DOM_VK_RETURN&&g.dataset.keycode!=KeyboardEvent.DOM_VK_BACK_SPACE&&g.setAttribute("role","key");c=document.createElement("span");c.className="visual-wrapper";
b=document.createElement("span");b.innerHTML=a;b.dataset.label=a;g.dataset.keycode==KeyboardEvent.DOM_VK_RETURN?g.setAttribute("id","key-id-return"):g.dataset.keycode==KeyboardEvent.DOM_VK_SPACE?g.setAttribute("id","key-id-transform"):0>g.dataset.keycode&&(g.dataset.keycode==IME_SPECIAL_KEY.MARK?g.setAttribute("id","key-id-mark"):g.dataset.keycode==IME_SPECIAL_KEY.SWITCH_KEYBOARD?g.setAttribute("id","key-id-switch"):g.dataset.keycode==IME_SPECIAL_KEY.TRANSFORM?g.setAttribute("id","key-id-transform"):
g.dataset.keycode==IME_SPECIAL_KEY.EN_LAYOUT?K(a,b,0):g.dataset.keycode==IME_SPECIAL_KEY.NUM_LAYOUT?K(a,b,1):g.dataset.keycode==IME_SPECIAL_KEY.BASIC_LAYOUT?K(a,b,2):g.dataset.keycode==IME_SPECIAL_KEY.H2Z?(g.setAttribute("id","key-id-h2z"),K(a,b,0)):g.dataset.keycode==IME_SPECIAL_KEY.Z2H&&(g.setAttribute("id","key-id-z2h"),K(a,b,1)));d=document.createElement("span");d.innerHTML=a;d.className="highlightNode";e&&(a=document.createElement("span"),a.innerHTML="",a.className="opacityPanel",d.appendChild(a));
c.appendChild(d);c.appendChild(b);h&&c.appendChild(h);g.appendChild(c);return g},K=function(a,c,b){if(!(1>=a.length)){c.innerHTML="";for(var d=0,e=a.length;d<e;d++)if(d==b){var k=document.createElement("span");k.innerHTML=a.charAt(d);k.className="keyLayout-active";c.appendChild(k)}else c.appendChild(document.createTextNode(a.charAt(d)))}};return{init:function(a,c){S=a;V=c;this.ime=document.getElementById("keyboard");navigator.mozL10n.language.code=navigator.language;document.documentElement.lang=
navigator.mozL10n.language.code;document.documentElement.dir=navigator.mozL10n.language.direction;t=navigator.mozL10n.get;D=[]},setInputMethodName:function(a){var c=document.getElementById("keyboard-candidate-panel");c&&(I&&c.classList.remove(I),c.classList.add(a));I=a},draw:function(a,c){this.ime.innerHTML="";this.ime.classList.remove("candidate-panel");this.ime.classList.remove("full-candidate-panel");var b=document.createDocumentFragment(),d=document.createElement("div");d.classList.add("keyboard-container");
ca(d,a,c);b.appendChild(d);d=document.createElement("span");d.setAttribute("id","keyboard-accent-char-menu-out");var e=document.createElement("span");e.setAttribute("id","keyboard-accent-char-menu");var k=document.createElement("span");k.setAttribute("id","keyboard-key-highlight");var h=document.createElement("div");h.setAttribute("id","keyboard-candidate-menu-out");var g=document.createElement("span");g.setAttribute("id","keyboard-candidate-menu");g.setAttribute("name","keyboard-candidate-menu");
d.appendChild(e);h.appendChild(g);b.appendChild(d);b.appendChild(k);b.appendChild(h);this.ime.appendChild(b);this._menu=document.getElementById("keyboard-accent-char-menu");this.ime.insertBefore(ea(),this.ime.firstChild);c.showCandidatePanel&&(this.ime.insertBefore(fa(),this.ime.firstChild),this.ime.insertBefore(da(),this.ime.firstChild),Z([]));$(a)},ime:void 0,hideIME:function(){this.ime.classList.add("hide");this.ime.dataset.hidden="true"},showIME:function(){this.ime.classList.remove("hide");delete this.ime.dataset.hidden},
highlightKey:function(a,c,b,d){d?a.classList.add("highlighted"):a.classList.add("unHighlighted");"mini"===a.dataset.fontSize&&a.classList.add("fontSize-mini");d&&c&&(a.querySelector(".visual-wrapper span").innerHTML=c);d&&b&&(a=a.querySelector(".highlightNode"))&&(b?a.classList.add("flickOnFont"):a.classList.remove("flickOnFont"))},unHighlightKey:function(a,c){a.classList.remove("highlighted");a.classList.remove("unHighlighted");if("undefined"!==typeof c){var b=a.querySelector(".visual-wrapper span");
b&&(b.innerHTML=c)}a.classList.contains("fontSize-mini")&&a.classList.remove("fontSize-mini");(b=a.querySelector(".highlightNode"))&&b.classList.remove("flickOnFont")},showAlternativesCharMenu:function(a,c,b){var d=document.createDocumentFragment(),e=window.innerWidth/2<=a.offsetLeft;e&&this._menu.classList.add("kbr-menu-left");var k=document.createElement("span");k.style.visibility="hidden";document.body.appendChild(k);var h=a.offsetHeight,g=0;c.forEach(function(b,c){var d=1,d=a.offsetWidth;a.dataset.localeConvert?
(k.classList.add("keyboard-candidate-width-check"),k.textContent=t(b),d=.5*Math.floor(k.offsetWidth/(a.offsetWidth/2))+.5):(k.textContent=b,d=Math.floor(k.offsetWidth/a.offsetWidth)+.5);d*=a.offsetWidth;d=Math.max(d,a.offsetWidth);g<d&&(g=d)});var l=0,f=document.createElement("div");f.classList.add("candidate-row");var n=4;-1!==KeyboardEventHandler.getOrientation().indexOf("landscape")&&(n=5);c.forEach(function(b,c){var e="";if(1==b.length)e=[{key:"keycode",value:b.charCodeAt(0)},{key:"altChar",value:!0}];
else{var h=!1,e=a.dataset.keycode;a.dataset.changeLayoutType===b&&(h=!0);a.dataset.localeConvert&&(b=t(b));e=[{key:"compositekey",value:b},{key:"keycode",value:e},{key:"altChar",value:!0}];h||e.push({key:"defaultRow",value:!0})}f.appendChild(Y(b,a.dataset.className||"",g+"px",e));l++;if(l>=n||a.dataset.changeLayoutType)d.appendChild(f),f=document.createElement("div"),f.classList.add("candidate-row"),l=0});document.body.removeChild(k);0!==l&&d.appendChild(f);this._menu.innerHTML="";this._menu.appendChild(d);
b||this._menu.classList.add("popup-off");a.dataset.menuClassName&&this._menu.classList.add(a.dataset.menuClassName);x=document.createElement("div");x.style.display="inline-block";x.style.width=a.style.width;x.innerHTML=a.innerHTML;x.className=a.className;x.classList.add("kbr-menu-on");W=a;a.parentNode.replaceChild(x,a);c=x.querySelectorAll(".visual-wrapper > span");c[0].appendChild(this._menu);1<c.length&&c[1].classList.add("key-label");this._menu.style.display="block";c=2;b||(c=a.dataset.changeLayoutType?
h-1:h+18);this._menu.style.bottom=c+"px";var h=getWindowLeft(this._menu),p=h+this._menu.offsetWidth;b=getWindowTop(this._menu);!e&&p>window.innerWidth?(console.log("overflowing right"),e=window.innerWidth-p,console.log(e),this._menu.style.left=e+"px"):e&&0>h&&(console.log("overflowing left"),e=h,console.log(e),this._menu.style.right=e+"px");25>b&&(e=parseInt(b)-25,this._menu.style.bottom=c+e+"px");a.dataset.changeLayoutType||(e=x.querySelectorAll(".visual-wrapper > span > span.opacityPanel"),e[0].style.top=
b+"px",e[0].style.heigth=c-b+"px")},hideAlternativesCharMenu:function(){this._menu.style.display="none";this._menu.className="";this._menu.innerHTML="";x&&x.parentNode.replaceChild(W,x);this._menu.style.left="";this._menu.style.right="";this._menu.style.bottom=""},setUpperCaseLock:function(a){var c=document.querySelector('button[data-keycode="'+KeyboardEvent.DOM_VK_CAPS_LOCK+'"]'),b=document.querySelector('button[data-keycode="'+IME_SPECIAL_KEY.CAPSLOCK+'"]');c?"locked"===a?(c.classList.remove("kbr-key-active"),
c.classList.add("kbr-key-hold")):(a?c.classList.add("kbr-key-active"):c.classList.remove("kbr-key-active"),c.classList.remove("kbr-key-hold")):b&&(a?b.classList.add("kbr-key-active"):b.classList.remove("kbr-key-active"))},resizeUI:$,showCandidates:Z,getWidth:function(){return this.ime?this.ime.clientWidth:0},showMoreCandidates:function(a,c){a||(a=-1);if(c){var b=document.getElementById("keyboard-candidate-panel");b.appendChild(F(b,a,c,!1,CANDIDATE_TYPE.PREDICT))}},toggleCandidatePanel:T,isFullCandidataPanelShown:function(){return IMERender.ime.classList.contains("full-candidate-panel")},
getNumberOfCandidatesPerRow:function(){return B},showSymbolCandidatePanel:function(a,c,b){var d=document.getElementById("keyboard-symbol-candidate-panel"),e=document.getElementById("keyboard").offsetHeight;Q(!0);if(d.hasChildNodes())P(IME_SYMBOL_TAB_NAMES.SYMBOL,a[IME_SYMBOL_TAB_NAMES.SYMBOL].history,!0),L();else{var k=document.createDocumentFragment();D=[];var e=Math.floor(e/4),h=document.createElement("div");h.id="keyboard-symbol-candidate-tabs";h.setAttribute("role","tablist");h.style.height=e+
"px";var g=document.createElement("div");g.style.height=e+"px";g.classList.add("first-item");g.setAttribute("role","other");g.innerHTML="\u2328";g.dataset.keycode=IME_SPECIAL_KEY.HIDE_SYMBOL_LIST;var l=document.createElement("div");l.style.height=e+"px";l.classList.add("last-item");l.innerHTML="\u232b";l.dataset.keycode=KeyEvent.DOM_VK_BACK_SPACE;l.setAttribute("role","other");h.appendChild(g);var f=document.createElement("span");f.classList.add("keyboard-symbolistab-width-check");f.style.visibility=
"hidden";var n=document.createElement("span");n.classList.add("keyboard-symbol-temp-width-check");document.body.appendChild(f);document.body.appendChild(n);for(var g=0,p=IME_SYMBOL_TAB_ORDER.length;g<p;g++){var q=IME_SYMBOL_TAB_ORDER[g],m=q+"_data",w=document.createElement("div");w.style.height=e+"px";w.dataset.selection=!0;w.setAttribute("name","keyboard-symbol-tab-"+q);w.dataset.categoryTab="keyboard-symbol-tab-"+q;if(isUnicode(t(m)))w.textContent=parseLabel(parseInt(t(m).substring(2),16)),f.textContent=
parseLabel(parseInt(t(m).substring(2),16)),w.classList.add("categoryTabContentUnicode");else{w.textContent=t(m);f.textContent=t(m);for(var m=21,y=f.offsetWidth,z=n.offsetWidth;z<y&&0<m;)m--,f.style.fontSize=m+"px",y=f.offsetWidth;w.style.fontSize=m+"px"}w.classList.add("swipe-slide");b.inputType===INPUT_TYPE.PASSWORD&&q!==IME_SYMBOL_TAB_NAMES.SYMBOL?(w.classList.add("tab-disabled"),q=document.createElement("div"),q=w.cloneNode(!0),q.textContent="",w.appendChild(q),h.dataset.soundDisabled=!0):b.osversion&&
b.osversion.substr(0,3)<=OS_MAJOR_VERSION.ONE_THREE&&q===IME_SYMBOL_TAB_NAMES.EMOJI&&(w.classList.add("tab-disabled"),document.createElement("div"),q=w.cloneNode(!0),q.textContent="",w.appendChild(q),h.dataset.soundDisabled=!0);w.setAttribute("role","tab");h.appendChild(w)}h.setAttribute("data-items",IME_SYMBOL_TAB_ORDER.length+2);h.appendChild(l);k.appendChild(h);document.body.removeChild(n);document.body.removeChild(f);q=document.getElementById("keyboard").offsetHeight;b=2*e+2;h=Math.floor(q)-b-
1;f=l=0;for(n=IME_SYMBOL_TAB_ORDER.length;f<n;f++){p=0;q=IME_SYMBOL_TAB_ORDER[f];w=document.createElement("div");w.setAttribute("id","keyboard-symbol-tab-"+q);y=document.createElement("ul");y.classList.add("swipe-slide");y.setAttribute("role","categorylist");y.style.bottom=e+1+"px";y.style.height=e+"px";for(var z=c[q],r=z.categoryOrder,x=0,s=0,A=r.length;s<A;s++){var u=r[s];D.push({boxID:q+"_"+u,scroll:!1});var m=document.createElement("li"),B=document.createElement("span");m.setAttribute("name",
q+"_"+u);m.style.height=e+"px";m.dataset.selection=!0;m.dataset.category=q+"_"+u;B.dataset.selection=!0;B.dataset.category=q+"_"+u;"image"===z[u].type?(m.style.backgroundImage="url(/style/icons/"+t(z[u].name)+")",m.classList.add("categoryTabContentImage")):isUnicode(t(z[u].name))?(B.innerHTML=parseLabel(parseInt(t(z[u].name).substring(2),16)),m.classList.add("categoryTabContentUnicode")):B.innerHTML=t(z[u].name);m.setAttribute("data-items",z[u].name.length);var C="1";-1!=t(z[u].name).indexOf("<br />")&&
(C="2");m.setAttribute("data-item-line",C);m.appendChild(B);y.appendChild(m);x++}y.setAttribute("data-items",x);w.appendChild(y);y=a[q];for(g in y)m=document.createElement("div"),m.id=q+"_"+g,m.classList.add("keyboard-symbol-candidate-box"),m.style.height=h+"px",m.style.bottom=b+"px",0===l?m.classList.add("categoryItemsShow"):m.classList.add("categoryItemsHide"),m.dataset.candidateIndicator=0,z=null,0==l&&2>p||0==p?(z=M(),z=F(m,z,y[g],!1,CANDIDATE_TYPE.SYMBOL)):z=F(m,-1,"",!1,CANDIDATE_TYPE.SYMBOL),
m.scrollTop=0,R(m,m.id,y[g]),m.appendChild(z),w.appendChild(m),k.appendChild(w),p++;l++}d.appendChild(k);c="2";-1!==KeyboardEventHandler.getOrientation().indexOf("landscape")&&(c="1");d.setAttribute("number-lines",c)}d.classList.add("show");d.classList.remove("hide");N("",0<a[IME_SYMBOL_TAB_NAMES.SYMBOL].history.length)},hideSymbolCandidatePanel:function(){var a=document.getElementById("keyboard-symbol-candidate-panel");a&&(Q(!1),a.classList.add("hide"),a.classList.remove("show"),L());if(a=document.getElementById("keyboard-candidate-panel-toggle-panel"))a.style.display=
"none";T(!1)},showCandidateMenu:function(a,c){var b=document.getElementById("keyboard-candidate-menu-out"),d=document.getElementById("keyboard-candidate-menu");if(a){if(!d.empty)for(;d.firstChild;)d.removeChild(d.firstChild);b.classList.add("show");b.classList.remove("hide");var b=c.dataset,e=document.createElement("div");e.id="keyboard-candidate-menu-text";e.setAttribute("name","keyboard-candidate-menu");e.textContent=c.textContent;var k=document.createElement("span"),h=document.createElement("div"),
g=document.createElement("div");document.createElement("br");h.innerHTML=t("candidate_menu_select");h.id="keyboard-candidate-menu-select";h.setAttribute("name","keyboard-candidate-menu");g.innerHTML=t("candidate_menu_cancel");g.dataset.selection=!0;g.dataset.frmpnl=!0;g.id="keyboard-candidate-menu-cancel";g.setAttribute("name","keyboard-candidate-menu");h.dataset.selection=!0;h.dataset.data=b.data;h.dataset.word=c.textContent;h.dataset.index=b.index;h.dataset.convlen=b.convlen;h.dataset.frmpnl=!0;
k.appendChild(g);k.appendChild(h);debug("::: dset.learnflg :::"+typeof b.learnflg);"string"===typeof b.learnflg&&"1"==b.learnflg&&(h=document.createElement("div"),h.innerHTML=t("candidate_menu_del_learn"),h.id="keyboard-candidate-menu-learn",h.setAttribute("name","keyboard-candidate-menu"),h.dataset.selection=!0,h.dataset.index=b.index,h.dataset.frmpnl=!0,k.appendChild(h));d.appendChild(e);d.appendChild(k)}else debug("::: candidateMenu hide :::"),b.classList.remove("show"),b.classList.add("hide")},
isSymbolCandidataPanelShown:function(){var a=document.getElementById("keyboard-symbol-candidate-panel");return a&&a.classList.contains("show")},resetCategoryHistory:P,candidateRowPortrait:"2",keyConvertInputMode:function(a,c){function b(b,c,d,g,l,f){function n(a){return isUnicode(a)?ba.convertUnicode6(a.slice(2)):a}a?(g&&l&&(b.dataset.keycode=g),b.dataset.label=n(c)):(g&&l&&(b.dataset.keycode=l),b.dataset.label=n(d));b=b.firstChild;g=0;for(l=b.childNodes.length;g<l;g++){var p=b.childNodes[g];a?(p.innerHTML=
n(c),f&&p.classList.add(f)):(p.innerHTML=n(d),f&&p.classList.remove(f))}}var d=document.getElementById("key-id-return");d&&b(d,t("return_key_replace"),t("return_key_default"));d=document.getElementById("key-id-transform");!d||IME_LAYOUTS.JP!=c.layout&&IME_LAYOUTS.ROMA!=c.layout||c.inputMode===INPUT_MODE.PHONETIC||c.inputType===INPUT_TYPE.PASSWORD||b(d,t("transform_key_replace"),t("transform_key_default"),IME_SPECIAL_KEY.TRANSFORM,IME_SPECIAL_KEY.SPACE);(d=document.getElementById("key-id-mark"))&&
IME_LAYOUTS.JP==c.layout&&b(d,t("mark_key_replace"),t("mark_key_default"),IME_SPECIAL_KEY.H2K,IME_SPECIAL_KEY.MARK,"lines")},categoryJumpTabs:O,categoryJump:N,showMoreCandidatesSymbol:function(a,c,b){for(var d=0,e=IME_SYMBOL_TAB_ORDER.length;d<e;d++){var k=IME_SYMBOL_TAB_ORDER[d],h=a[k],g=0,l;for(l in h){if(k+"_"+l==c){var f=document.getElementById(c);if(!f.hasChildNodes()||!f.childNodes[0].tagName){var n={};-1!=f.id.indexOf(IME_SYMBOL_TAB_NAMES.EMOJI)&&(n[IME_SYMBOL_TAB_NAMES.EMOJI]=!0);n=M(n);f.dataset.candidateIndicator=
0;f.appendChild(F(f,n,h[l],!1,CANDIDATE_TYPE.SYMBOL));f.scrollTop=0}R(f,c,h[l]);if(b){b();return}}g++}}b&&b()},showMoreCandidatesTabSymbol:function(a,c,b,d){for(var e=0,k=IME_SYMBOL_TAB_ORDER.length;e<k;e++){var h=0,g=IME_SYMBOL_TAB_ORDER[e];if("keyboard-symbol-tab-"+g==c){var l=a[g],f;for(f in l)if("history"!==f||b)if(1>h){var n=document.getElementById(g+"_"+f);if(n.hasChildNodes()&&n.childNodes[0].tagName)b&&P(g,l[f],!0);else{var p={};-1!=n.id.indexOf(IME_SYMBOL_TAB_NAMES.EMOJI)&&(p[IME_SYMBOL_TAB_NAMES.EMOJI]=
!0);p=M(p);n.appendChild(F(n,p,l[f],!1,CANDIDATE_TYPE.SYMBOL))}h++;n.scrollTop=0;R(n,n.id,l[f])}else if(d){d();return}}}d&&d()},highlightCandidate:U,changeCandidateFocus:function(a){a=U(a).parentNode;var c=document.getElementById("keyboard-candidate-panel"),b=c.offsetHeight,d=parseInt(c.dataset.rowHeight),e=0;a.offsetTop+d>b&&(b=2,-1!==KeyboardEventHandler.getOrientation().indexOf("landscape")&&(b=1),e=a.offsetTop-parseInt(c.dataset.rowHeight)*(b-1));c.scrollLeft=0;c.scrollTop=e;c.dataset.scroll=
e}}}();
var KeyboardEventHandler=function(){function g(c){var a=null;switch(c){case "selectionchange":a=b;break;case "inputcontextchange":a=window.navigator.mozInputMethod;break;case "mozorientationchange":a=window.screen;break;case "resize":case "hashchange":case "mozvisibilitychange":a=window;break;default:a=p}return a}function h(c){var a=c.detail;switch(c.type){case "sendKey":e(a.keyCode);break;case "setComposition":c=a.text;var d=a.cursor,a=a.clauses;c=c||"";b?(d="undefined"!==typeof d?d:c.length,a?b.setComposition(c,
d,a):b.setComposition(c,d)):console.warn("no inputContext for replaceSurroudingText");break;case "endComposition":b?b.endComposition(a.text):console.warn("no inputContext for replaceSurroudingText");break;case "setSelectionRange":b?b.setSelectionRange(a.start,a.length):console.warn("no inputContext for replaceSurroudingText");break;case "moveCursorPrev":e(KeyEvent.DOM_VK_LEFT);break;case "moveCursorNext":e(KeyEvent.DOM_VK_RIGHT);break;case "switchToNextIME":navigator.mozInputMethod.mgmt.next();break;
case "showIMEList":navigator.mozInputMethod.mgmt.showAll();break;case "hideIME":navigator.mozInputMethod.mgmt.hide();break;case "addObserver":navigator.mozSettings.addObserver(a.key,a.callback);break;case "getSettings":q(a.settings,a.callback)}}function e(c){if(b)switch(c){case KeyEvent.DOM_VK_BACK_SPACE:case KeyEvent.DOM_VK_RETURN:case KeyEvent.DOM_VK_LEFT:case KeyEvent.DOM_VK_RIGHT:b.sendKey(c,0,0);break;default:b.sendKey(0,c,0)}else console.warn("no inputContext for sendKey")}function q(c,a){function b(a){try{var d=
g.get(a)}catch(f){console.warn("Exception querying setting",a,":",f,"\nUsing default value");e(a,c[a]);return}d.onsuccess=function(){var b=d.result[a];void 0===b&&(b=c[a]);e(a,b)};d.onerror=function(b){console.warn("Error querying setting",a,":",b.error);e(a,c[a])}}function e(c,b){k[c]=b;m++;m===n&&a(k)}var k={};try{var g=navigator.mozSettings.createLock()}catch(h){console.warn("Exception in mozSettings.createLock():",h,"\nUsing default values");for(var f in c)k[f]=c[f];a(k)}f=Object.keys(c);for(var n=
f.length,m=0,l=0;l<n;l++)b(f[l])}var b=null,p=document.createElement("div");return{registEvent:function(c,a){var b=g(c);b&&a&&b.addEventListener(c,a)},removeEvent:function(b,a){var d=g(b);d&&a&&d.removeEventListener(b,a)},start:function(){b=navigator.mozInputMethod.inputcontext},handleEvent:h,dispatch:function(b,a){h({type:b,detail:a})},textBeforeCursor:function(){return b?b.textBeforeCursor:""},textAfterCursor:function(){return b?b.textAfterCursor:""},getText:function(){return b.getText()},getInputContext:function(){return b},
getOrientation:function(){return window.innerWidth<=window.innerHeight?"portrait":"landscape"}}}();KeyboardEventHandler.start();
var InputMethods={},defaultInputMethod={click:function(a){KeyboardEventHandler.dispatch("sendKey",{keyCode:a})},displaysCandidates:function(){return!1}},inputContext=null,processId=null,keyboardName=null,inputMethod=defaultInputMethod,currentLayout=null,isWaitingForSecondTap=!1,isShowingAlternativesMenu=!1,isShowingKeyboardLayoutMenu=!1,isShowingSwitchLayoutMenu=!1,isUpperCase=!1,isUpperCaseLocked=!1,currentKey=null,startKey=null,touchEventsPresent=!1,touchedKeys={},touchCount=0,menuLockedArea=null,
layoutMenuLockedArea=null,isKeyboardRendered=!1,currentCandidates=[],candidatePanelScrollTimer=null,candidateMenu=!1,CANDIDATE_PANEL_SWITCH_TIMEOUT=100,ACCENT_CHAR_MENU_TIMEOUT=700,REPEAT_RATE=75,REPEAT_TIMEOUT=700,FOCUS_CHANGE_DELAY=100,CAPS_LOCK_TIMEOUT=450,HIDE_KEYBOARD_TIMEOUT=500,SAVE_DICTIONARY_TIMEOUT=450,BORDER_MOVE_HANDLE=5,BORDER_SCROLLED_HANDLE=3,deleteTimeout=0,deleteInterval=0,menuTimeout=0,redrawTimeout=0,hideKeyboardTimeout=0,transformTimeout=0,transformInterval=0,cursorMoveTimeout=
0,cursorMoveInterval=0,SPECIAL_CODES=[KeyEvent.DOM_VK_BACK_SPACE,KeyEvent.DOM_VK_CAPS_LOCK,KeyEvent.DOM_VK_RETURN,KeyEvent.DOM_VK_ALT,KeyEvent.DOM_VK_SPACE],currentKeyboardName,isSoundEnabled,osVersion,invalidPress,activeSymbolListTab,activeSymbolListCategory,CLICK_SOUND="./resources/sounds/key.ogg",SPECIAL_SOUND="./resources/sounds/special.ogg",clicker,specialClicker,dimensionsObserver,eventHandlers={touchstart:onTouchStart,mousedown:onMouseDown,mouseup:onMouseUp,mousemove:onMouseMove},touchStartCoordinate,
toShowKeyboardFTU=!1,SWIPE_VELOCICTY_THRESHOLD=.4,settingsQuery={"audio.volume.notification":7,"deviceinfo.os":1.3},statusManager;settingManager.loadKeyboardSetting(function(){statusManager=new StatusManager;loadDeviceSetting();initKeyboard();convWrapper.jpConvertEngineInit(CONV_DIC_LOAD_FLG.OFF)});
function loadDeviceSetting(){KeyboardEventHandler.dispatch("getSettings",{settings:settingsQuery,callback:function(a){isSoundEnabled=!!a["audio.volume.notification"];handleKeyboardSound();osVersion=a["deviceinfo.os"]}})}
function initImeLayoutType(){var a=statusManager.getInputType(),b=statusManager.getInputMode();if(updateCurrentInputStatus()){var c=statusManager.getInputType(),d=statusManager.getInputMode(),e=-1!==KeyboardEventHandler.getOrientation().indexOf("portrait"),f=statusManager.getImeType(),h=statusManager.getLayoutType(),g=f,k=h;if(c!==a)switch(c){case INPUT_TYPE.URL:case INPUT_TYPE.EMAIL:case INPUT_TYPE.PASSWORD:g=IME_TYPE.EN;statusManager.needInputMode()&&(statusManager.isInputModeDigit()?g=IME_TYPE.DIGIT:
statusManager.isInputModeNumeric()&&(g=IME_TYPE.NUMBER));break;case INPUT_TYPE.TEL:g=IME_TYPE.TEL;break;case INPUT_TYPE.NUMBER:g=statusManager.isInputModeDigit()?IME_TYPE.DIGIT:IME_TYPE.NUMBER;break;default:g=IME_TYPE.JP,statusManager.needInputMode()&&(statusManager.isInputModeDigit()?g=IME_TYPE.DIGIT:statusManager.isInputModeNumeric()&&(g=IME_TYPE.NUMBER))}else if(statusManager.needInputMode()&&d!==b)if(statusManager.isInputModeDigit())g=IME_TYPE.DIGIT;else if(statusManager.isInputModeNumeric())g=
IME_TYPE.NUMBER;else if(b===INPUT_MODE.DIGIT||b===INPUT_MODE.NUMERIC)switch(c){case INPUT_TYPE.PASSWORD:g=IME_TYPE.EN;break;case INPUT_TYPE.NUMBER:g=IME_TYPE.NUMBER;break;default:g=IME_TYPE.JP}switch(g){default:case IME_TYPE.JP:k=e?settingManager.getSetting(SETTING.LAYOUT_BASIC.PORTRAIT):settingManager.getSetting(SETTING.LAYOUT_BASIC.LANDSCAPE);break;case IME_TYPE.EN:k=e?settingManager.getSetting(SETTING.LAYOUT_EN.PORTRAIT):settingManager.getSetting(SETTING.LAYOUT_EN.LANDSCAPE);break;case IME_TYPE.NUM:k=
e?settingManager.getSetting(SETTING.LAYOUT_NUM.PORTRAIT):settingManager.getSetting(SETTING.LAYOUT_NUM.LANDSCAPE)}if(f!=g||h!=k)statusManager.setImeType(g),statusManager.setLayoutType(k)}}var downKeyCode="",flickX=0,flickY=0,touchMoveX=0,touchMoveY=0,downKeyTxt="",flickKey=null,flickNeutralArea={},flickIgnoreAreaAroundTap={},processShowSymbolPanel=!1;
function initKeyboard(){IMERender.init(getUpperCaseValue,isSpecialKeyObj);for(var a in eventHandlers)IMERender.ime.addEventListener(a,eventHandlers[a]);KeyboardEventHandler.dispatch("addObserver",{settings:settingsQuery,callback:function(a){isSoundEnabled=!!a.settingValue;handleKeyboardSound()}});dimensionsObserver=new MutationObserver(function(){updateTargetWindowHeight()});dimensionsObserver.observe(IMERender.ime,{childList:!0,attributes:!0,attributeFilter:["class","style","data-hidden"]});KeyboardEventHandler.registEvent("hashchange",
function(){initImeLayoutType();var a=statusManager.getImeLayout();setKeyboardName(a,function(){showKeyboard()})});KeyboardEventHandler.registEvent("mozorientationchange",function(){clearStatus()});KeyboardEventHandler.registEvent("resize",function(){onResize()});KeyboardEventHandler.registEvent("mozvisibilitychange",function(){document.mozHidden?(statusManager.isInputModeUserDic()||convWrapper.saveDictionary(CONV_DIC_TYPE.LEARNING),setUpperCase(!1,!1),initParams(),inputMethod.clearInputBuf&&inputMethod.clearInputBuf(),
chButtonText(),IMERender.showCandidateMenu(!1),IMERender.hideSymbolCandidatePanel()):(KeyboardEventHandler.start(),inputContext=KeyboardEventHandler.getInputContext(),convWrapper.jpConvertEngineInit(CONV_DIC_LOAD_FLG.OFF),inputMethod&&inputMethod.addSelectionChangeEvent&&inputMethod.addSelectionChangeEvent())});KeyboardEventHandler.registEvent("inputcontextchange",function(){KeyboardEventHandler.start();inputContext=KeyboardEventHandler.getInputContext();!document.mozHidden&&inputContext?(convWrapper.clearParam(),
setUpperCase(!1,!1),initParams(),IMERender.init(getUpperCaseValue,isSpecialKeyObj),settingManager.loadKeyboardSetting(function(){settingManager.getSetting(SETTING.CLICK_SOUND)&&loadDeviceSetting();initImeLayoutType();var a=statusManager.getImeLayout();a!==keyboardName?setKeyboardName(a,function(){showKeyboard(a)}):showKeyboard(a)})):hideKeyboard()});""!==window.location.hash?(initImeLayoutType(),a=statusManager.getImeLayout(),setKeyboardName(a,function(){KeyboardEventHandler.start();inputContext=
KeyboardEventHandler.getInputContext();!document.mozHidden&&inputContext&&showKeyboard()})):console.error("This page should never be loaded without an URL hash.")}function handleKeyboardSound(){settingManager.getSetting(SETTING.CLICK_SOUND)&&isSoundEnabled?(clicker=new Audio(CLICK_SOUND),specialClicker=new Audio(SPECIAL_SOUND)):specialClicker=clicker=null}function deactivateInputMethod(){inputMethod.deactivate&&(inputMethod.deactivate(),debug("::: deactivateInputMethod :::\n"))}
function setKeyboardName(a,b){var c;a||(a=statusManager.getImeLayout());(function(a,b){function f(a){keyboardName=a;c=Keyboards[a];b(c)}if(a in Keyboards)f(a);else{var h="js/layouts/"+a+".js",g=document.createElement("script");g.src=h;g.onload=function(){f(a)};g.onerror=function(){console.error("Cannot load keyboard layout",h)};document.head.appendChild(g)}})(a,function(c){function e(a){a!==inputMethod&&inputMethod&&inputMethod.deactivate&&inputMethod.deactivate();inputMethod=a;inputMethod.empty&&
inputMethod.empty();b&&b()}c.imEngine?loadIMEngine(a,function(){e(InputMethods[c.imEngine])}):e(defaultInputMethod)})}function isSpecialKeyObj(a){a=a.keyCode||a.keycode;return a!==KeyEvent.DOM_VK_SPACE&&a&&-1!==SPECIAL_CODES.indexOf(a)||0>=a}function mapInputType(a){switch(a){case INPUT_TYPE.URL:case INPUT_TYPE.TEL:case INPUT_TYPE.EMAIL:case INPUT_TYPE.TEXT:case INPUT_TYPE.PASSWORD:return a;default:return INPUT_TYPE.TEXT;case INPUT_TYPE.NUMBER:case INPUT_TYPE.RANGE:return INPUT_TYPE.NUMBER}}
function renderKeyboard(a,b){currentLayout=Keyboards[a];IMERender.setInputMethodName(Keyboards[a].imEngine||"default");IMERender.draw(currentLayout,{uppercase:isUpperCaseLocked||isUpperCase,inputType:statusManager.getInputType(),showCandidatePanel:needsCandidatePanel(),inputFlick:settingManager.getSetting(SETTING.INPUT_FLICK),imeType:statusManager.getImeType()});IMERender.setUpperCaseLock(isUpperCaseLocked?"locked":isUpperCase);inputMethod.empty&&inputMethod.empty();IMERender.showCandidates([]);isKeyboardRendered=
!0;b&&b()}function setUpperCase(a,b){b="undefined"==typeof b?isUpperCaseLocked:b;if(isUpperCase!=a||isUpperCaseLocked!=b)isUpperCaseLocked=b,isUpperCase=a,isKeyboardRendered&&(IMERender.draw(currentLayout,{uppercase:isUpperCaseLocked||isUpperCase,inputType:statusManager.getInputType(),showCandidatePanel:needsCandidatePanel()}),IMERender.setUpperCaseLock(isUpperCaseLocked?"locked":isUpperCase),IMERender.showCandidates(currentCandidates))}
function resetUpperCase(){isUpperCase&&!isUpperCaseLocked&&setUpperCase(!1)}function updateTargetWindowHeight(){var a=IMERender.ime.scrollHeight,b=IMERender.getWidth();window.resizeTo(b,a)}function sendClickKey(a){inputMethod.click(a)}function getUpperCaseValue(a){var b=-1<SPECIAL_CODES.indexOf(a.keyCode);return 0>a.keyCode||b||a.compositeKey?a.value:(currentLayout.upperCase||{})[a.value]||a.value.toUpperCase()}
function setLongPressTimeout(a,b,c){1<touchCount||(menuTimeout=window.setTimeout(function(){if(!(isShowingAlternativesMenu||1<touchCount)){var c=statusManager.getImeType();if(c===IME_TYPE.NUMBER||c===IME_TYPE.DIGIT||c===IME_TYPE.TEL){if(c=currentLayout.keys[a.dataset.row][a.dataset.column].value,c=currentLayout.alt&&currentLayout.alt[c]||null)a.dataset.ignoreEndPress=!0,c=c.charCodeAt(0),KeyboardEventHandler.dispatch("sendKey",{keyCode:c})}else parseInt(a.dataset.keycode)===IME_SPECIAL_KEY.SPACE?
(clearTimeoutAll(),KeyboardEventHandler.dispatch("hideIME")):showAlternatives(a,b)}},ACCENT_CHAR_MENU_TIMEOUT))}
function showAlternatives(a,b){var c,d,e,f,h=a.dataset;if(!h.selection||candidateMenu||IMERender.isSymbolCandidataPanelShown()){var g=a?a.dataset.row:-1;c=a?a.dataset.column:-1;if(!(0>g||0>c||void 0===g||void 0===c))if(e=currentLayout.keys[g][c],h.keycode!=IME_SPECIAL_KEY.BACK&&e.keyCode===IME_SPECIAL_KEY.SWITCH_KEYBOARD)KeyboardEventHandler.dispatch("showIMEList");else{g=!1;inputMethod.isLayoutSwitchKey&&inputMethod.isLayoutSwitchKey(e.keyCode)&&LAYOUT_SWITCH&&(g=!0);d=currentLayout.alt||{};c=e.value;
c=d[c]||"";if(isUpperCase||isUpperCaseLocked)e=getUpperCaseValue(e),d[e]?c=d[e]:f=!0;if(-1!=c.indexOf(" ")){if(c=c.split(" "),2===c.length&&""===c[1]&&c.pop(),f)for(f=0,d=c.length;f<d;f++)c[f]=isUpperCaseLocked?c[f].toLocaleUpperCase():c[f][0].toLocaleUpperCase()+c[f].substring(1)}else f&&(c=c.toLocaleUpperCase()),c=c.split("");g&&(showChangeLayoutAlternatives(a,c),isShowingSwitchLayoutMenu=!0);c.length&&(f=getWindowTop(a),isShowingAlternativesMenu||IMERender.showAlternativesCharMenu(a,c,settingManager.getSetting(SETTING.INPUT_KEYPOPUP)),
isShowingAlternativesMenu=!0,g?changeHighlightLayoutMenu(a,h.keycode):(startKey.removeEventListener("touchmove",onTouchMove),startKey.removeEventListener("touchend",onTouchEnd),startKey.removeEventListener("touchcancel",onTouchEnd),IMERender.unHighlightKey(a)),menuLockedArea={top:getWindowTop(IMERender._menu),bottom:f,left:getWindowLeft(IMERender._menu),right:getWindowLeft(IMERender._menu)+IMERender._menu.scrollWidth},menuLockedArea.width=menuLockedArea.right-menuLockedArea.left,menuLockedArea.ratio=
menuLockedArea.width/IMERender._menu.children.length)}}else h=Math.abs(touchMoveX-b.pageX),g=Math.abs(touchMoveY-b.pageY),h>BORDER_MOVE_HANDLE||g>BORDER_MOVE_HANDLE||(IMERender.showCandidateMenu(!0,a),candidateMenu=!0,a.removeEventListener("touchmove",onTouchMove),a.removeEventListener("touchend",onTouchEnd),a.removeEventListener("touchcancel",onTouchEnd),IMERender.unHighlightKey(a))}
function showChangeLayoutAlternatives(a,b){b.push("keyboardTypeNumeric");b.push("keyboardTypeFull");a.dataset.localeConvert=!0;statusManager.isQwerty()?a.dataset.changeLayoutType="keyboardTypeNumeric":a.dataset.changeLayoutType="keyboardTypeFull";a.dataset.menuClassName="change-layout-menu";a.dataset.className="change-layout-menu"}
function changeHighlightLayoutMenu(a,b){if(isShowingAlternativesMenu&&inputMethod.isLayoutSwitchKey){var c=document.getElementsByClassName("change-layout-menu");if(0<c.length){startKey.dataset.keycode||(startKey=a);for(var d=!1,e=0,f=c.length;e<f;e++)a.dataset.compositekey&&a.dataset.compositekey===c[e].dataset.compositekey?(IMERender.highlightKey(c[e],"","",settingManager.getSetting(SETTING.INPUT_KEYPOPUP)),d=!0):IMERender.unHighlightKey(c[e]);if(!d)for(e=0,f=c.length;e<f;e++)c[e].dataset.defaultRow&&
IMERender.highlightKey(c[e],"","",settingManager.getSetting(SETTING.INPUT_KEYPOPUP))}}}function hideAlternatives(){isShowingAlternativesMenu&&(IMERender.hideAlternativesCharMenu(),isShowingAlternativesMenu=!1)}function isNormalKey(a){return parseInt(a.dataset.keycode)||a.dataset.selection||a.dataset.compositekey}
function onTouchStart(a){IMERender.isFullCandidataPanelShown()||IMERender.isSymbolCandidataPanelShown()||a.preventDefault();touchEventsPresent=!0;touchCount=a.touches.length;1<touchCount||handleTouches(a,function(b,c){var d=b.target;d.addEventListener("touchmove",onTouchMove);d.addEventListener("touchend",onTouchEnd);d.addEventListener("touchcancel",onTouchEnd);touchedKeys[c]={target:d,x:b.pageX,y:b.pageY};startPress(d,b,c);touchStartCoordinate={touchId:c,pageX:b.pageX,pageY:b.pageY,timeStamp:a.timeStamp}})}
function onTouchMove(a){IMERender.isFullCandidataPanelShown()||IMERender.isSymbolCandidataPanelShown()||a.preventDefault();handleTouches(a,function(a,c){if(touchedKeys[c]){var d=Math.abs(touchedKeys[c].x-a.pageX),e=Math.abs(touchedKeys[c].y-a.pageY);d<BORDER_MOVE_HANDLE&&e<BORDER_MOVE_HANDLE||(touchedKeys[c].x=a.pageX,touchedKeys[c].y=a.pageY,d=document.elementFromPoint(a.pageX,a.pageY),movePress(d,a,c))}})}
function onTouchEnd(a){IMERender.isFullCandidataPanelShown()||IMERender.isSymbolCandidataPanelShown()||a.preventDefault();touchCount=a.touches.length;handleTouches(a,function(a,c){if(touchedKeys[c]){var d=a.target;d.removeEventListener("touchmove",onTouchMove);d.removeEventListener("touchend",onTouchEnd);d.removeEventListener("touchcancel",onTouchEnd);d=isCandidateScrolled(a);endPress(touchedKeys[c].target,a,c,d);delete touchedKeys[c];flickKey=startKey=null}})}
function handleTouches(a,b){for(var c=0,d=a.changedTouches.length;c<d;c++){var e=a.changedTouches[c];b(e,e.identifier)}}function onMouseDown(a){a.preventDefault();touchEventsPresent||(IMERender.ime.setCapture(!1),currentKey=a.target,startPress(currentKey,a,null))}
function startPress(a,b,c){function d(a){return window.setTimeout(function(){sendClickKey(h);a&&a()},REPEAT_TIMEOUT)}function e(){return setInterval(function(){sendClickKey(h)},REPEAT_RATE)}startKey=a;invalidPress=!1;touchMoveY=b.clientY;touchMoveX=b.clientX;if(isNormalKey(a)||-1!=keyboardName.indexOf("jp-kanji")){var f=!1;processShowSymbolPanel?f=!0:candidateMenu&&getBelong2Parts(a,b)!=FUNC_PARTS.CANDIDATE.CANDIDATE_MENU?(IMERender.showCandidateMenu(!1),candidateMenu=!1,f=!0):a.parentNode!==IMERender._menu&&
isShowingAlternativesMenu&&!inMenuLockedArea(menuLockedArea,b)?(hideAlternatives(),f=!0):a.parentNode.classList.contains("candidate-row")&&statusManager.getCandidateUpdating()&&(f=!0);if(f)a.removeEventListener("touchmove",onTouchMove),a.removeEventListener("touchend",onTouchEnd),a.removeEventListener("touchcancel",onTouchEnd);else{var h=parseInt(a.dataset.keycode),f=parseInt(a.dataset.flick);if(!a.dataset.soundDisabled){var g=isSpecialKeyObj(a.dataset);triggerFeedback(g)}inputMethod.chkInputFlick&&
inputMethod.chkInputFlick(f)?(flickX=b.clientX,flickY=b.clientY,downKeyCode=f,downKeyTxt=a.querySelector(".visual-wrapper span").textContent,getFlickArea(b.target),f=getFlickChar(b,f),IMERender.highlightKey(a,f.flickChar,f.flickFont,settingManager.getSetting(SETTING.INPUT_KEYPOPUP))):IMERender.highlightKey(a,"","",settingManager.getSetting(SETTING.INPUT_KEYPOPUP));setLongPressTimeout(a,b,c);switch(h){case KeyEvent.DOM_VK_BACK_SPACE:sendClickKey(h);deleteTimeout=d(function(){deleteInterval=e()});break;
case IME_SPECIAL_KEY.TRANSFORM:sendClickKey(h);transformTimeout=d(function(){transformInterval=e()});break;case IME_SPECIAL_KEY.NEXT:case IME_SPECIAL_KEY.PREVIOUS:sendClickKey(h),cursorMoveTimeout=d(function(){cursorMoveInterval=e()})}}}}function inMenuLockedArea(a,b){return a&&b.pageY>=a.top&&b.pageY<=a.bottom&&b.pageX>=a.left&&b.pageX<=a.right}function onMouseMove(a){touchEventsPresent||movePress(a.target,a,null)}
function movePress(a,b,c){var d=touchEventsPresent?touchedKeys[c].target:currentKey;if(!a||!a.disabled){var e=getBelong2Parts(startKey,b),f=getBelong2Parts(d,b),h=getBelong2Parts(a,b);if(a&&startKey&&a!==startKey&&e==FUNC_PARTS.KEYBOARD.REPEAT_KEY||invalidPress)invalidPress=!0,clearTimeoutAll(),IMERender.unHighlightKey(startKey);else if(a&&a.dataset&&a.dataset.selection&&isCandidateScrolled(b))invalidPress=!0,IMERender.unHighlightKey(startKey);else{if(!a||!d||!isNormalKey(a)){clearTimeout(deleteTimeout);
clearInterval(deleteInterval);if(d){var g=parseInt(d.dataset.keycode);KeyEvent.DOM_VK_BACK_SPACE===g&&IMERender.unHighlightKey(d);if(IME_SPECIAL_KEY.TOGGLE_CANDIDATE_PANEL===g){d.removeEventListener("touchmove",onTouchMove);d.removeEventListener("touchend",onTouchEnd);d.removeEventListener("touchcancel",onTouchEnd);IMERender.unHighlightKey(d);return}}d&&settingManager.getSetting(SETTING.INPUT_FLICK)&&(flickX||flickY)&&isNormalKey(d)?a=d:inputMethod.isLayoutSwitchKey&&LAYOUT_SWITCH&&(inputMethod.isLayoutSwitchKey(parseInt(startKey.dataset.keycode))||
isShowingSwitchLayoutMenu)?a&&a.dataset.keycode||h!=FUNC_PARTS.CANDIDATE.CANDIDATE_MENU&&(a=startKey):null!=flickKey?(IMERender.unHighlightKey(d,""),flickKey=null):IMERender.unHighlightKey(d);a&&a.dataset.keycode||h!=FUNC_PARTS.CANDIDATE.CANDIDATE_MENU&&(a=d)}if(e==FUNC_PARTS.KEYBOARD.OTHER_KEY||e==FUNC_PARTS.CANDIDATE.CANDIDATE||e==FUNC_PARTS.KEYBOARD.MINI_KEYBOARD)f!=FUNC_PARTS.KEYBOARD.OTHER_KEY||h!=FUNC_PARTS.CANDIDATE.CANDIDATE&&h!=FUNC_PARTS.CANDIDATE.TOGGLE_BUTTON?f==FUNC_PARTS.CANDIDATE.CANDIDATE&&
h!=FUNC_PARTS.CANDIDATE.CANDIDATE?a=d:f==FUNC_PARTS.KEYBOARD.MINI_KEYBOARD&&h!=FUNC_PARTS.KEYBOARD.MINI_KEYBOARD&&(a=d):a=d;f=parseInt(a.dataset.keycode);if(!flickX&&!flickY&&e==FUNC_PARTS.KEYBOARD.SWITCH_LAYOUT_KEY&&inputMethod.isLayoutSwitchKey(f)&&LAYOUT_SWITCH){if(h=[],showChangeLayoutAlternatives(a,h),isShowingSwitchLayoutMenu=!0,!isShowingAlternativesMenu&&0<h.length){IMERender.showAlternativesCharMenu(a,h,settingManager.getSetting(SETTING.INPUT_KEYPOPUP));isShowingAlternativesMenu=!0;changeHighlightLayoutMenu(a,
f);return}}else if((flickX||flickY)&&settingManager.getSetting(SETTING.INPUT_FLICK)){a=getFlickChar(b,downKeyCode);(b=a.flickChar.replace(/(^\s+)|(\s+$)/g,""))?(null!=flickKey?IMERender.unHighlightKey(d,""):IMERender.unHighlightKey(d),IMERender.highlightKey(d,b,a.flickFont,settingManager.getSetting(SETTING.INPUT_KEYPOPUP)),flickKey=b):null!=flickKey?(IMERender.unHighlightKey(d,""),flickKey=null):IMERender.unHighlightKey(d);return}null!=flickKey?(IMERender.unHighlightKey(d,""),flickKey=null):IMERender.unHighlightKey(d);
isShowingAlternativesMenu&&e==FUNC_PARTS.KEYBOARD.SWITCH_LAYOUT_KEY&&startKey===a&&(isShowingSwitchLayoutMenu=!0);changeHighlightLayoutMenu(a,f);e=chkSameScope(startKey,a);if(e[0]){if(e=a,touchEventsPresent?touchedKeys[c].target=e:currentKey=e,!isShowingAlternativesMenu||a.dataset.altChar){switch(statusManager.getImeLayout()){case IME_LAYOUTS.TEL:case IME_LAYOUTS.DIGIT:case IME_LAYOUTS.NUMBER:if(a&&startKey&&a===startKey&&KeyEvent.DOM_VK_BACK_SPACE===parseInt(startKey.dataset.keycode)){a.dataset.ignoreEndPress=
!0;clearTimeoutAll();d&&IMERender.unHighlightKey(d);return}}(e=isSpecialKeyObj(a.dataset))||statusManager.isQwerty()?IMERender.highlightKey(a,"","",settingManager.getSetting(SETTING.INPUT_KEYPOPUP)):(h="",inputMethod&&inputMethod.chkInputFlick&&inputMethod.chkInputFlick(f)&&(h=inputMethod.chkInputFlick(f)?"OFF":"",statusManager.getImeType()==IME_TYPE.NUM&&(h="")),IMERender.highlightKey(a,a.dataset.label,h,settingManager.getSetting(SETTING.INPUT_KEYPOPUP)));a!==d&&(clearTimeoutAll(),isShowingAlternativesMenu&&
(e?IMERender.highlightKey(a,"","",settingManager.getSetting(SETTING.INPUT_KEYPOPUP)):IMERender.highlightKey(a,a.dataset.label,"",settingManager.getSetting(SETTING.INPUT_KEYPOPUP))),setLongPressTimeout(a,b,c))}}else e[1]||(invalidPress=!0)}}}function onMouseUp(a){touchEventsPresent||(endPress(currentKey,a,null),flickKey=startKey=currentKey=null)}
function endPress(a,b,c,d){clearTimeoutAll();c=isShowingKeyboardLayoutMenu;if(a&&isNormalKey(a))if(invalidPress)chButtonText(statusManager.getInputType()),invalidPress=!1;else if(chkSameScope(startKey,a)[0]){var e=isShowingAlternativesMenu;a.parentNode!==IMERender._menu&&isShowingAlternativesMenu&&hideAlternatives();var f=a.dataset;if(f.selection&&!e){if(!d){if(inputMethod.select)if(f.frmpnl)if(IMERender.showCandidateMenu(!1),candidateMenu=!1,"keyboard-candidate-menu-learn"===a.id)inputMethod.delLearnDic(processId,
f.index);else if("keyboard-candidate-menu-cancel"!=a.id)inputMethod.select(f);else return;else!candidateMenu&&f.data&&(f.word=a.textContent,inputMethod.select(f),IMERender.isSymbolCandidataPanelShown()&&statusManager.setCandidateUpdating(!1));IMERender.isSymbolCandidataPanelShown()||IMERender.toggleCandidatePanel(!1)}if(inputMethod.getCategoryHistory&&(f.category||f.categoryTab)){d=Math.abs(touchMoveX-b.pageX);b=Math.abs(touchMoveY-b.pageY);if(d>BORDER_MOVE_HANDLE||b>BORDER_MOVE_HANDLE){IMERender.unHighlightKey(a);
return}if(f.category){var h=-1!=f.category.indexOf("history");activeSymbolListCategory=f.category;inputMethod.getCategoryHistory(f.category,function(){activeSymbolListCategory===f.category&&inputMethod.candidateSymbolList(null,function(a,b){activeSymbolListCategory===f.category&&IMERender.showMoreCandidatesSymbol(a,f.category,function(){h||IMERender.categoryJumpTabs(f.category)})})})}else{b=f.categoryTab.split("-");var g=b[b.length-1];activeSymbolListTab=g;inputMethod.getNumCategoryHistory(g+"_history",
function(a){var b=a&&0<a;activeSymbolListTab===g&&(b&&IMERender.categoryJump(f.categoryTab,b),inputMethod.candidateSymbolList(g,function(a,c){activeSymbolListTab===g&&IMERender.showMoreCandidatesTabSymbol(a,f.categoryTab,b,function(){b||IMERender.categoryJump(f.categoryTab)})}))})}}IMERender.unHighlightKey(a);chButtonText()}else if(null!=flickKey?(IMERender.unHighlightKey(a,""),flickKey=null):IMERender.unHighlightKey(a),a.dataset.ignoreEndPress)delete a.dataset.ignoreEndPress;else{d=parseInt(a.dataset.keycode);
if(inputMethod.isLayoutSwitchKey&&isShowingSwitchLayoutMenu&&LAYOUT_SWITCH){if(a.dataset.row){isShowingSwitchLayoutMenu=!1;return}if(a.dataset.defaultRow){isShowingSwitchLayoutMenu=!1;return}}if(isShowingSwitchLayoutMenu&&getBelong2Parts(a,b)==FUNC_PARTS.KEYBOARD.SWITCH_LAYOUT_KEY&&LAYOUT_SWITCH&&inputMethod.changeKeyboardLayout){var k=inputMethod.changeKeyboardLayout(d);debug("change layout:"+k);if(k){convWrapper.jpConvertEngineModeInit(CONV_DIC_LOAD_FLG.OFF);isShowingSwitchLayoutMenu=!1;return}}isShowingSwitchLayoutMenu=
!1;if(!e||a.dataset.altChar){switch(d){case KeyEvent.DOM_VK_BACK_SPACE:case IME_SPECIAL_KEY.TRANSFORM:case IME_SPECIAL_KEY.NEXT:case IME_SPECIAL_KEY.PREVIOUS:startKey.dataset.keycode!=d&&sendClickKey(d);chButtonText();return}if(d!=IME_SPECIAL_KEY.TOGGLE_CANDIDATE_PANEL||startKey.dataset.keycode==IME_SPECIAL_KEY.TOGGLE_CANDIDATE_PANEL&&document.elementFromPoint(b.pageX,b.pageY))if(e=getComputedStyle(a),"none"!=e.display&&"hidden"!=e.visibility)switch(d){case IME_SPECIAL_KEY.SWITCH_KEYBOARD:if(a.dataset.keyboard||
!c)deactivateInputMethod(),KeyboardEventHandler.dispatch("switchToNextIME");break;case IME_SPECIAL_KEY.TOGGLE_CANDIDATE_PANEL:a=document.getElementById("keyboard-candidate-panel");IMERender.ime.classList.contains("candidate-panel")?(b=1,IMERender.candidateRowPortrait&&(b=IMERender.candidateRowPortrait),a.dataset.rowCount<=b&&(b=MAX_MORE_CANDIDATE_ROW_NUM-parseInt(b),-1!==KeyboardEventHandler.getOrientation().indexOf("landscape")&&(b=Math.ceil(b*MAX_UNIT_NUM_PORTRAIT/MAX_UNIT_NUM_LANDSCAPE)),d=IMERender.getNumberOfCandidatesPerRow(),
c=parseInt(a.dataset.candidateIndicator),d=currentCandidates.slice(c,c+(b+1)*d+1),IMERender.showMoreCandidates(b,d)),a.dataset.truncated&&(candidatePanelScrollTimer&&(clearTimeout(candidatePanelScrollTimer),candidatePanelScrollTimer=null),a.addEventListener("scroll",candidatePanelOnScroll)),IMERender.toggleCandidatePanel(!0)):IMERender.toggleCandidatePanel(!1);break;case KeyEvent.DOM_VK_CAPS_LOCK:isWaitingForSecondTap?(isWaitingForSecondTap=!1,setUpperCase(!0,!0)):(isWaitingForSecondTap=!0,window.setTimeout(function(){isWaitingForSecondTap=
!1},CAPS_LOCK_TIMEOUT),setUpperCase(!isUpperCase,!1));break;case IME_SPECIAL_KEY.HIDE_SYMBOL_LIST:IMERender.hideSymbolCandidatePanel();break;default:if(a.dataset.compositekey)for(a=a.dataset.compositekey,b=0,d=a.length;b<d;b++)inputMethod.click(a.charCodeAt(b));else flickX||flickY?(b=getFlickChar(b,downKeyCode),c=b.flickChar.replace(/(^\s+)|(\s+$)/g,""),flickY=flickX=0,c&&(c.match(/^[A-Z]+$/)&&(c=c.toLowerCase()),settingManager.getSetting(SETTING.INPUT_FLICK)?(inputMethod.click(c.charCodeAt(0),b.flickFont),
a.querySelector(".visual-wrapper span").textContent=downKeyTxt):inputMethod.click(d,inputMethod.chkInputFlick(parseInt(a.dataset.flick))))):inputMethod.click(d),chButtonText(statusManager.getInputType())}}}}}
function candidatePanelOnScroll(){if(!candidatePanelScrollTimer&&0!=this.scrollTop&&this.clientHeight+this.scrollTop>this.scrollHeight-1.5*this.clientHeight){var a=document.getElementById("keyboard-candidate-panel"),b=parseInt(a.dataset.candidateIndicator);b<currentCandidates.length&&(candidatePanelScrollTimer=setTimeout(function(){var a=MAX_MORE_CANDIDATE_ROW_NUM;-1!==KeyboardEventHandler.getOrientation().indexOf("landscape")&&(a=Math.ceil(a*MAX_UNIT_NUM_PORTRAIT/MAX_UNIT_NUM_LANDSCAPE));var d=IMERender.getNumberOfCandidatesPerRow(),
d=currentCandidates.slice(b,b+(a+1)*d+1);IMERender.showMoreCandidates(a,d);clearTimeout(candidatePanelScrollTimer);candidatePanelScrollTimer=null},0))}}function chButtonText(){var a=statusManager.getInputType();a!=INPUT_TYPE.NUMBER&&a!=INPUT_TYPE.TEL&&(a={layout:statusManager.getImeLayout(),inputType:statusManager.getInputType(),inputMode:statusManager.getInputMode()},0<statusManager.getText(TEXT_LAYER1).length?IMERender.keyConvertInputMode(!0,a):IMERender.keyConvertInputMode(!1,a))}
function showMarkList(){processShowSymbolPanel=!0;inputMethod.candidateSymbolList&&inputMethod.candidateSymbolList(IME_SYMBOL_TAB_NAMES.SYMBOL,function(a,b){var c={inputType:statusManager.getInputType(),osversion:osVersion};IMERender.showSymbolCandidatePanel(a,b,c);processShowSymbolPanel=!1});statusManager.isInputModePhonetic()}
function setHighlightCandidate(a){var b=document.getElementById("keyboard-candidate-panel"),b=parseInt(b.dataset.candidateIndicator);if(a>=b){var c=IMERender.getNumberOfCandidatesPerRow(),b=currentCandidates.slice(b,b+2*c+1);b.selected=a;IMERender.showMoreCandidates(1,b)}IMERender.changeCandidateFocus(a)}
function showKeyboard(){function a(){inputMethod.activate&&inputMethod.activate(b);renderKeyboard(keyboardName,function(){IMERender.showIME()})}clearTimeout(hideKeyboardTimeout);KeyboardEventHandler.start();inputContext=KeyboardEventHandler.getInputContext();isUpperCaseLocked=isUpperCase=!1;if(updateCurrentInputStatus()){var b={type:statusManager.getInputType(),inputmode:statusManager.getInputMode(),selectionStart:inputContext.selectionStart,selectionEnd:inputContext.selectionEnd,value:""};a()}}
function hideKeyboard(){isKeyboardRendered&&(clearTimeout(hideKeyboardTimeout),IMERender.showCandidateMenu(!1),IMERender.showCandidates([]),hideKeyboardTimeout=setTimeout(function(){IMERender.hideIME()},HIDE_KEYBOARD_TIMEOUT),deactivateInputMethod(),isKeyboardRendered=!1)}
function clearStatus(){setUpperCase(!1,!1);statusManager.clearText();statusManager.setKeyMode(KEY_MODE.NORMAL);KeyboardEventHandler.dispatch("setComposition",{text:""});KeyboardEventHandler.dispatch("endComposition",{text:""});inputMethod.clearInputBuf?inputMethod.clearInputBuf():IMERender.showCandidates([]);IMERender.showCandidateMenu(!1);IMERender.hideSymbolCandidatePanel();hideAlternatives();var a={layout:statusManager.getImeLayout(),inputType:statusManager.getInputType(),inputMode:statusManager.getInputMode()};
IMERender.keyConvertInputMode(!1,a);activeSymbolListCategory=activeSymbolListTab=""}
function onResize(){if(!IMERender.ime.dataset.hidden){initParams();clearStatus();var a=statusManager.getImeType(),b;b=-1!==KeyboardEventHandler.getOrientation().indexOf("portrait")?"PORTRAIT":"LANDSCAPE";var c=statusManager.getImeLayout();a==IME_TYPE.JP?statusManager.setLayoutType(settingManager.getSetting(SETTING.LAYOUT_BASIC[b])):a==IME_TYPE.EN?statusManager.setLayoutType(settingManager.getSetting(SETTING.LAYOUT_EN[b])):a==IME_TYPE.NUM&&statusManager.setLayoutType(settingManager.getSetting(SETTING.LAYOUT_NUM[b]));
c===statusManager.getImeLayout()?(IMERender.resizeUI(currentLayout),updateTargetWindowHeight(),IMERender.isSymbolCandidataPanelShown()&&IMERender.hideSymbolCandidatePanel()):renderKeyboard(statusManager.getImeLayout())}}
function loadIMEngine(a,b){var c=Keyboards[a].imEngine;if(InputMethods[c])b&&b();else{var d=document.createElement("script");d.src="./js/imes/"+c+"/"+c+".js";var e={path:"./js/imes/"+c,sendCandidates:function(a,b){currentCandidates==a||IMERender.isSymbolCandidataPanelShown()||(IMERender.showCandidates(a,b),currentCandidates=a);0===a.length&&(IMERender.showCandidateMenu(!1),chButtonText())},setComposition:function(a,b,c){KeyboardEventHandler.dispatch("setComposition",{text:a,cursor:b,clauses:c})},
endComposition:function(a){KeyboardEventHandler.dispatch("endComposition",{text:a})},sendKey:function(a){KeyboardEventHandler.dispatch("sendKey",{keyCode:a})},sendString:function(a){for(var b=0,c=a.length;b<c;b++)KeyboardEventHandler.dispatch("sendKey",{keyCode:a.charCodeAt(b)})},alterKeyboard:function(a){setUpperCase(!1,!1);initParams();isKeyboardRendered=!1;renderKeyboard(a)},setUpperCase:setUpperCase,resetUpperCase:resetUpperCase,getNumberOfCandidatesPerRow:IMERender.getNumberOfCandidatesPerRow.bind(IMERender),
setSelectionRange:function(a,b){KeyboardEventHandler.dispatch("setSelectionRange",{start:a,length:b})},resetCategoryHistory:function(a,b,c,d){IMERender.resetCategoryHistory(a,b,c,d)},categoryJumpTabs:function(a){IMERender.categoryJumpTabs(a)},keyConvertInputMode:function(a){var b={layout:statusManager.getImeLayout(),inputType:statusManager.getInputType(),inputMode:statusManager.getInputMode()};IMERender.keyConvertInputMode(a,b)},moveCursorPrev:function(){KeyboardEventHandler.dispatch("moveCursorPrev")},
moveCursorNext:function(){KeyboardEventHandler.dispatch("moveCursorNext")},showMarkList:showMarkList,textBeforeCursor:function(){return KeyboardEventHandler.textBeforeCursor()},textAfterCursor:function(){return KeyboardEventHandler.textAfterCursor()},setHighlightCandidate:setHighlightCandidate,setUpperCaseLock:function(a){IMERender.setUpperCaseLock(a)},getSymbolListActiveTab:function(){return IMERender.getSymbolListActiveTab()}};d.addEventListener("load",function(){InputMethods[c].init(e,statusManager);
b&&b()});document.body.appendChild(d)}}function triggerFeedback(a){if(settingManager.getSetting(SETTING.VIBRATION))try{navigator.vibrate(50)}catch(b){}settingManager.getSetting(SETTING.CLICK_SOUND)&&isSoundEnabled&&(a?specialClicker:clicker).cloneNode(!1).play()}function getWindowTop(a){var b;for(b=a.offsetTop;a=a.offsetParent;)b+=a.offsetTop;return b}function getWindowLeft(a){var b;for(b=a.offsetLeft;a=a.offsetParent;)b+=a.offsetLeft;return b}
function needsCandidatePanel(){return statusManager.isInputModePhonetic()?!1:!0}
function getFlickChar(a,b){var c={flickChar:b,flickFont:!1},c=a.clientX,d=a.clientY,e="",f=!1;if(flickIgnoreAreaAroundTap.left<=c&&c<=flickIgnoreAreaAroundTap.right&&flickIgnoreAreaAroundTap.top<=d&&d<=flickIgnoreAreaAroundTap.bottom)e=MAP_INPUT_FLICK_KEY[b][0],f=settingManager.getSetting(SETTING.INPUT_FLICK);else if(flickNeutralArea.left<=c&&c<=flickNeutralArea.right&&flickNeutralArea.top<=d&&d<=flickNeutralArea.bottom)e=MAP_INPUT_FLICK_KEY[b][0],f=settingManager.getSetting(SETTING.INPUT_FLICK);
else var e=Math.abs(c-(flickNeutralArea.right+flickNeutralArea.left)/2),h=Math.abs(d-(flickNeutralArea.bottom+flickNeutralArea.top)/2),e=e>(flickNeutralArea.right-flickNeutralArea.left)/(flickNeutralArea.bottom-flickNeutralArea.top)*h?c<flickNeutralArea.right?MAP_INPUT_FLICK_KEY[b][1]:MAP_INPUT_FLICK_KEY[b][3]:d<flickNeutralArea.top?MAP_INPUT_FLICK_KEY[b][2]:MAP_INPUT_FLICK_KEY[b][4];c={flickChar:e,flickFont:f};IME_TYPE.NUM!=statusManager.getImeType()||settingManager.getSetting(SETTING.INPUT_FLICK)||
(c.flickFont=!1);return c}
function getFlickArea(a){var b=a.getBoundingClientRect(),c=a.offsetWidth/FLICK_DIVISION_NUM;a=a.offsetHeight/FLICK_DIVISION_NUM;var d=b.left+c*Math.floor((flickX-b.left)/c),b=b.top+a*Math.floor((flickY-b.top)/a),e=100-settingManager.getSetting(SETTING.SENSITIVITY_FLICK),f=c*e/100,e=a*e/100;flickNeutralArea={left:d-f,top:b-e,right:d+c+f,bottom:b+a+e};flickIgnoreAreaAroundTap={left:flickY-MIN_FLICK_MOVE_DISTANCE,top:flickX-MIN_FLICK_MOVE_DISTANCE,right:flickY+MIN_FLICK_MOVE_DISTANCE,bottom:flickX+MIN_FLICK_MOVE_DISTANCE}}
function updateCurrentInputStatus(){var a=null;KeyboardEventHandler.start();if(a=KeyboardEventHandler.getInputContext())return inputContext=a,statusManager.setInputMode(a.inputMode),statusManager.setInputType(mapInputType(a.inputType)),!0;statusManager.setInputMode("");statusManager.setInputType(mapInputType(INPUT_TYPE.TEXT));return!1}
function clearTimeoutAll(){clearTimeout(deleteTimeout);clearInterval(deleteInterval);clearTimeout(menuTimeout);clearTimeout(transformTimeout);clearInterval(transformInterval);clearTimeout(cursorMoveTimeout);clearInterval(cursorMoveInterval)}
function initParams(){candidateMenu=!1;clearTimeoutAll();for(var a in touchedKeys){var b=touchedKeys[a].target;b.removeEventListener("touchmove",onTouchMove);b.removeEventListener("touchend",onTouchEnd);b.removeEventListener("touchcancel",onTouchEnd);b.dataset.keycode in MAP_INPUT_FLICK_KEY&&!statusManager.isQwerty()?IMERender.unHighlightKey(b,""):IMERender.unHighlightKey(b)}touchedKeys={};hideAlternatives();isShowingSwitchLayoutMenu=isShowingKeyboardLayoutMenu=isShowingAlternativesMenu=isWaitingForSecondTap=
!1;startKey=currentKey=null;touchCount=0;layoutMenuLockedArea=menuLockedArea=null;currentCandidates=[];candidatePanelScrollTimer=null;candidateMenu=!1;touchStartCoordinate={};downKeyCode="";touchMoveY=touchMoveX=flickY=flickX=0;downKeyTxt="";flickKey=null;activeSymbolListCategory=activeSymbolListTab=""}
function getBelong2Parts(a,b){var c="",d="";if(!a)return c;a.dataset.keycode&&(d=a.dataset.keycode);if(inputMethod.isRepeatKey&&inputMethod.isRepeatKey(parseInt(d)))c=FUNC_PARTS.KEYBOARD.REPEAT_KEY;else if(inputMethod.isLayoutSwitchKey&&inputMethod.isLayoutSwitchKey(parseInt(d)))c=FUNC_PARTS.KEYBOARD.SWITCH_LAYOUT_KEY;else if(a.parentNode===IMERender._menu&&inMenuLockedArea(menuLockedArea,b))c=FUNC_PARTS.KEYBOARD.MINI_KEYBOARD;else if(IME_SPECIAL_KEY.TOGGLE_CANDIDATE_PANEL==d)c=FUNC_PARTS.CANDIDATE.TOGGLE_BUTTON;
else if("keyboard-candidate-menu"==a.getAttribute("name"))c=FUNC_PARTS.CANDIDATE.CANDIDATE_MENU;else{var d=a.parentNode,e=d.parentNode;e&&"keyboard-candidate-panel"==e.id?c=FUNC_PARTS.CANDIDATE.CANDIDATE:d&&"keyboard-candidate-panel"==d.id?c=FUNC_PARTS.CANDIDATE.CANDIDATE:"keyboard-candidate-panel"==a.id?c=FUNC_PARTS.CANDIDATE.CANDIDATE:e&&"keyboard-accent-char-menu"==e.id?c=FUNC_PARTS.KEYBOARD.MINI_KEYBOARD:a&&"keyboard-accent-char-menu"==a.id?c=FUNC_PARTS.KEYBOARD.MINI_KEYBOARD:a.classList.contains("keyboard-key")&&
(c=FUNC_PARTS.KEYBOARD.OTHER_KEY)}return c}
function chkSameScope(a,b){return getBelong2Parts(a)==FUNC_PARTS.KEYBOARD.REPEAT_KEY?getBelong2Parts(b)==FUNC_PARTS.KEYBOARD.REPEAT_KEY?[!0,!1]:[!1,!1]:getBelong2Parts(a)==FUNC_PARTS.KEYBOARD.SWITCH_LAYOUT_KEY?[!0,!0]:getBelong2Parts(a)==FUNC_PARTS.KEYBOARD.OTHER_KEY?getBelong2Parts(b)==FUNC_PARTS.KEYBOARD.OTHER_KEY||getBelong2Parts(b)==FUNC_PARTS.KEYBOARD.REPEAT_KEY||getBelong2Parts(b)==FUNC_PARTS.KEYBOARD.SWITCH_LAYOUT_KEY?[!0,!0]:[!1,!0]:getBelong2Parts(a)==FUNC_PARTS.KEYBOARD.MINI_KEYBOARD?getBelong2Parts(b)==
FUNC_PARTS.KEYBOARD.MINI_KEYBOARD?[!0,!0]:[!1,!0]:getBelong2Parts(a)==FUNC_PARTS.CANDIDATE.CANDIDATE?getBelong2Parts(b)==FUNC_PARTS.CANDIDATE.CANDIDATE?[!0,!0]:[!1,!0]:getBelong2Parts(a)==FUNC_PARTS.CANDIDATE.TOGGLE_BUTTON?getBelong2Parts(b)==FUNC_PARTS.CANDIDATE.TOGGLE_BUTTON?[!0,!1]:[!1,!1]:getBelong2Parts(a)==FUNC_PARTS.CANDIDATE.CANDIDATE_MENU&&getBelong2Parts(b)!=FUNC_PARTS.CANDIDATE.CANDIDATE_MENU?[!1,!0]:[!0,!0]}
function isCandidateScrolled(a){var b=a.pageX-touchStartCoordinate.pageX;a=a.pageY-touchStartCoordinate.pageY;return(IMERender.isFullCandidataPanelShown()||IMERender.isSymbolCandidataPanelShown())&&(Math.abs(b)>BORDER_SCROLLED_HANDLE||Math.abs(a)>BORDER_SCROLLED_HANDLE)};
